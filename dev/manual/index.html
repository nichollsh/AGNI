<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Software manual · AGNI</title><meta name="title" content="Software manual · AGNI"/><meta property="og:title" content="Software manual · AGNI"/><meta property="twitter:title" content="Software manual · AGNI"/><meta name="description" content="Documentation for AGNI."/><meta property="og:description" content="Documentation for AGNI."/><meta property="twitter:description" content="Documentation for AGNI."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/><link href="../assets/logo.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="AGNI logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">AGNI</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../model/">Model description</a></li><li><a class="tocitem" href="../setup/">Getting started</a></li><li><a class="tocitem" href="../usage/">Using the model</a></li><li><a class="tocitem" href="../examples/">Example outputs</a></li><li><a class="tocitem" href="../troubleshooting/">Troubleshooting</a></li><li class="is-active"><a class="tocitem" href>Software manual</a><ul class="internal"><li><a class="tocitem" href="#Contributing"><span>Contributing</span></a></li><li><a class="tocitem" href="#Code-reference-(API)"><span>Code reference (API)</span></a></li></ul></li><li><a class="tocitem" href="../ecosystem/">Related codes</a></li><li><a class="tocitem" href="../thanks/">Acknowledgements</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Software manual</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Software manual</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nichollsh/AGNI" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/nichollsh/AGNI/blob/main/docs/src/manual.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Software-manual"><a class="docs-heading-anchor" href="#Software-manual">Software manual</a><a id="Software-manual-1"></a><a class="docs-heading-anchor-permalink" href="#Software-manual" title="Permalink"></a></h1><h2 id="Contributing"><a class="docs-heading-anchor" href="#Contributing">Contributing</a><a id="Contributing-1"></a><a class="docs-heading-anchor-permalink" href="#Contributing" title="Permalink"></a></h2><p>If you are interested in contributing to the model, please see the <a href="../contributing/">contributing</a> page</p><h2 id="Code-reference-(API)"><a class="docs-heading-anchor" href="#Code-reference-(API)">Code reference (API)</a><a id="Code-reference-(API)-1"></a><a class="docs-heading-anchor-permalink" href="#Code-reference-(API)" title="Permalink"></a></h2><h3 id="Atmosphere-initialisation-and-variables"><a class="docs-heading-anchor" href="#Atmosphere-initialisation-and-variables">Atmosphere initialisation and variables</a><a id="Atmosphere-initialisation-and-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Atmosphere-initialisation-and-variables" title="Permalink"></a></h3><p>Functions from <code>atmosphere.jl</code>.</p><article><details class="docstring" open="true"><summary id="AGNI.atmosphere"><a class="docstring-binding" href="#AGNI.atmosphere"><code>AGNI.atmosphere</code></a> — <span class="docstring-category">Module</span></summary><section><div><p><strong>Main atmosphere module for storing model data</strong></p><p>This module primarily contains the <code>Atmos_t</code> struct which does most of the heavy lifting in AGNI. There are also functions for setting up and configuring the struct.</p><p>Also includes hydrostatic integrator and ways to estimate observable quantities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L9-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.allocate!-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.atmosphere.allocate!-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.atmosphere.allocate!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Allocate atmosphere arrays, prepare spectral files, and final steps.</strong></p><p>Will not modify spectral file if <code>stellar_spectrum</code> is an empty string. Will treat star as blackbody with photospheric effective temperature of <code>stellar_Teff</code> if the parameter <code>stellar_spectrum</code> has value of <code>&quot;blackbody&quot;</code>.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>             the atmosphere struct instance to be used.</li><li><code>stellar_spectrum::String</code>   path to stellar spectrum csv file</li><li><code>stellar_Teff::Float64</code>      star effective temperature if blackbody</li><li><code>check_safe_gas::Bool</code>       require that there be at least one &#39;safe&#39; gas in the mix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L1579-L1591">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.calc_layer_props!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.calc_layer_props!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.calc_layer_props!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate properties within each layer of the atmosphere (e.g. density, mmw).</strong></p><p>Function will return false if hydrostatic calculcation fails. This is usually when the atmosphere becomes unbound.</p><p>Arguments:     - <code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</p><p>Returns:     - <code>ok::Bool</code>                function result is ok</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L1249-L1260">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.calc_observed_rho!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.calc_observed_rho!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.calc_observed_rho!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate observed radius and bulk density.</strong></p><p>This is done at the layer probed in transmission, which is set to a fixed pressure.</p><p>Arguments:     - <code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</p><p>Returns:     - <code>transspec_rho::Float64</code>  the bulk density observed in transmission</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L1172-L1182">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.calc_profile_cpkc!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.calc_profile_cpkc!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.calc_profile_cpkc!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate specific heat capacity and thermal conductivity for all layers.</strong></p><p>Specific heat per unit mass: J K-1 kg-1. Thermal conductivity: W m-1 K-1.</p><p>Arguments:     - <code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L1439-L1447">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.calc_profile_density!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.calc_profile_density!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.calc_profile_density!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate the mass-density for all layers.</strong></p><p>Requires temperature, pressure, mmw to be already have been set.</p><p>Arguments:     - <code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L1480-L1487">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.calc_profile_mmw!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.calc_profile_mmw!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.calc_profile_mmw!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate mean molecular weight for all layers.</strong></p><p>MMW stored as kg/mol.</p><p>Arguments:     - <code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L1423-L1430">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.calc_profile_radius!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.calc_profile_radius!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.calc_profile_radius!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate radius and gravity for all layers.</strong></p><p>Performs hydrostatic integration from the ground upwards. Requires density, temperature, pressure to have already been set.</p><p>Does not account for ocean thickness.</p><p>Arguments:     - <code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</p><p>Returns:     - <code>ok::Bool</code>                function result is ok</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L1285-L1298">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.calc_single_cpkc!-Tuple{AGNI.atmosphere.Atmos_t, Int64}"><a class="docstring-binding" href="#AGNI.atmosphere.calc_single_cpkc!-Tuple{AGNI.atmosphere.Atmos_t, Int64}"><code>AGNI.atmosphere.calc_single_cpkc!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate specific heat capacity and thermal conductivity of a single layer.</strong></p><p>Specific heat per unit mass: J K-1 kg-1. Thermal conductivity: W m-1 K-1.</p><p>Arguments:     - <code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.     - <code>idx::Int</code>            index of the layer</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L1456-L1465">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.calc_single_density!-Tuple{AGNI.atmosphere.Atmos_t, Int64}"><a class="docstring-binding" href="#AGNI.atmosphere.calc_single_density!-Tuple{AGNI.atmosphere.Atmos_t, Int64}"><code>AGNI.atmosphere.calc_single_density!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate the mass-density of a single layer.</strong></p><p>Requires temperature, pressure, mmw to be already have been set.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</li><li><code>idx::Int</code>            index of the layer</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L1496-L1504">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.estimate_Ra!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.estimate_Ra!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.estimate_Ra!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Estimate a diagnostic Rayleigh number in each layer.</strong></p><p>Assuming that the Rayleigh number scales like <code>Ra ~ (wλ/κ)^(1/β)</code> Where <code>κ</code> is the thermal diffusivity and <code>β</code> is the convective beta parameter.</p><p>This quantity must be taken lightly.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L2343-L2353">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.estimate_convective_zone-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.estimate_convective_zone-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.estimate_convective_zone</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Get pressure at top and bottom of convective zone</strong></p><p>Arguments:     - <code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</p><p>Returns:     - <code>p_top::Float64</code>          pressure [Pa] at top of convective zone     - <code>p_bot::Float64</code>          pressure [Pa] at bottom of convective zone</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L1213-L1222">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.estimate_photosphere!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.estimate_photosphere!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.estimate_photosphere!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Estimate photosphere.</strong></p><p>Estimates the location of the photosphere by finding the median of the contribution function in each band (0.2 um to 150 um), and then finding the pressure level at which these median values are maximised.</p><p>Arguments:     - <code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</p><p>Returns:     - <code>p_ref::Float64</code>          pressure level of photosphere [Pa]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L1119-L1131">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.estimate_timescale_conv!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.estimate_timescale_conv!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.estimate_timescale_conv!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Estimate a diagnostic convective timescale in each layer.</strong></p><p>This quantity must be taken lightly.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L2390-L2397">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.estimate_timescale_rad!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.estimate_timescale_rad!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.estimate_timescale_rad!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Estimate a diagnostic radiative timescale in each layer.</strong></p><p>This quantity must be taken lightly.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L2371-L2378">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.generate_pgrid!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.generate_pgrid!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.generate_pgrid!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Generate pressure grid.</strong></p><p>Almost equally log-spaced between p<em>boa and p</em>boa. The near-boundary layers are smaller than they would be on an equally log-spaced grid, to avoid numerics.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>              the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L1519-L1527">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.get_interleaved_ptr-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.get_interleaved_ptr-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.get_interleaved_ptr</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Get interleaved cell-centre and cell-edge PTR grid.</strong></p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</li></ul><p>Returns:</p><ul><li><code>arr_P::Array</code>        pressure array [Pa]</li><li><code>arr_T::Array</code>        temperature array [K]</li><li><code>arr_R::Array</code>        radius array [m]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L2300-L2310">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.integrate_hydrograv-NTuple{5, Float64}"><a class="docstring-binding" href="#AGNI.atmosphere.integrate_hydrograv-NTuple{5, Float64}"><code>AGNI.atmosphere.integrate_hydrograv</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Integrate hydrostatic and gravity equations across a pressure interval.</strong></p><p>Uses the classic fourth-order Runge-Kutta method.</p><p>Arguments:     - <code>r0::Float64</code>     radius   at start of interval [m]     - <code>g0::Float64</code>     gravity  at start of interval [m s-2]     - <code>p0::Float64</code>     pressure at start of interval [Pa]     - <code>p1::Float64</code>     pressure at end   of interval [Pa]     - <code>rho::Float64</code>    density throughout interval, constant [kg m-3]</p><p>Returns:     - <code>r1::Float64</code>     radius at end of interval [m]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L1367-L1381">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.make_transparent!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.make_transparent!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.make_transparent!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Set atmosphere properties such that it is effectively transparent.</strong></p><p>This will modify the surface pressure and disable gas opacity in SOCRATES. These changes cannot be reversed directly. To undo them, it is best to create and allocate a new atmosphere struct.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L2232-L2241">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.set_tmpl_from_tmp!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.atmosphere.set_tmpl_from_tmp!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.set_tmpl_from_tmp!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Set cell-edge temperatures from cell-centre values.</strong></p><p>Uses interpolation within the bulk of the column and extrapolation for the topmost edge.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>            the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L2277-L2285">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.atmosphere.setup!-Tuple{AGNI.atmosphere.Atmos_t, String, String, String, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Int64, Float64, Float64, Any, String}"><a class="docstring-binding" href="#AGNI.atmosphere.setup!-Tuple{AGNI.atmosphere.Atmos_t, String, String, String, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Int64, Float64, Float64, Any, String}"><code>AGNI.atmosphere.setup!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Set parameters of the atmosphere.</strong></p><p>This is used to set up the struct immediately after creation. It must be     done before <code>allocate!()</code> is called, and before any RT calculcations     are performed.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>                  the atmosphere struct instance to be used.</li><li><code>ROOT_DIR::String</code>                AGNI root directory.</li><li><code>OUT_DIR::String</code>                 Output directory.</li><li><code>spfile::String</code>                  path to spectral file (&#39;grey&#39; =&gt; use grey gas)</li><li><code>instellation::Float64</code>           bolometric solar flux at the top of the atmosphere [W m-2]</li><li><code>s0_fact::Float64</code>                scale factor to account for planetary rotation (i.e. S<em>0^*/S</em>0 in Cronin+14)</li><li><code>albedo_b::Float64</code>               bond albedo scale factor applied to instellation in order to imitate shortwave reflection</li><li><code>zenith_degrees::Float64</code>         angle of radiation from the star, relative to the zenith [degrees].</li><li><code>tmp_surf::Float64</code>               effective surface temperature to provide upward longwave flux at the bottom of the atmosphere [K].</li><li><code>gravity::Float64</code>                gravitational acceleration at the surface [m s-2].</li><li><code>radius::Float64</code>                 planet radius at the surface [m].</li><li><code>nlev_centre::Int</code>                number of model levels.</li><li><code>p_surf::Float64</code>                 total surface pressure [bar].</li><li><code>p_top::Float64</code>                  total top of atmosphere pressure [bar].</li><li><code>mf_dict::Dict</code>                   dictionary of VMRs in the format (key,value)=(gas,mf).</li><li><code>mf_path::String</code>                 path to file containing VMRs at each level.</li></ul><p>Optional arguments:</p><ul><li><code>IO_DIR::String</code>                  directory used for fast file operations.</li><li><code>condensates</code>                     list of condensates (gas names).</li><li><code>metallicities::Dict</code>             dictionary of elemental metallicities (mass ratio rel to hydrogen)</li><li><code>surface_material::String</code>        surface material (default is &quot;greybody&quot;, but can point to file instead).</li><li><code>albedo_s::Float64</code>               grey surface albedo used when <code>surface_material=&quot;greybody&quot;</code>.</li><li><code>tmp_floor::Float64</code>              temperature floor [K].</li><li><code>surf_roughness::Float64</code>         surface roughness length scale [m]</li><li><code>surf_windspeed::Float64</code>         surface wind speed [m s-1].</li><li><code>Kzz_floor::Float64</code>              min eddy diffusion coefficient, cgs units [cm2 s-1]</li><li><code>mlt_asymptotic::Bool</code>            mixing length scales asymptotically, but ~0 near ground</li><li><code>mlt_criterion::Char</code>             MLT stability criterion. Options: (s)chwarzschild, (l)edoux.</li><li><code>tmp_magma::Float64</code>              mantle temperature [K] for sol_type==2.</li><li><code>skin_d::Float64</code>                 skin thickness [m].</li><li><code>skin_k::Float64</code>                 skin thermal conductivity [W m-1 K-1].</li><li><code>overlap_method::String</code>          gaseous overlap scheme (ro: rand overlap, ee: equiv extinct, rorr: ro+resort+rebin).</li><li><code>target_olr::Float64</code>             target OLR [W m-2] for sol_type==4.</li><li><code>flux_int::Float64</code>               planet&#39;s internal flux for sol_type==3.</li><li><code>all_channels::Bool</code>              use all channels available for RT?</li><li><code>flag_rayleigh::Bool</code>             include rayleigh scattering?</li><li><code>flag_gcontinuum::Bool</code>           include generalised continuum absorption?</li><li><code>flag_continuum::Bool</code>            include continuum absorption?</li><li><code>flag_aerosol::Bool</code>              include aersols?</li><li><code>flag_cloud::Bool</code>                include clouds?</li><li><code>phs_timescale::Float64</code>          phase change timescale [s]</li><li><code>evap_efficiency::Float64</code>        re-evaporatione efficiency compared to saturating amount</li><li><code>real_gas::Bool</code>                  use real gas EOS where possible</li><li><code>thermo_functions::Bool</code>          use temperature-dependent thermodynamic properties</li><li><code>use_all_gases::Bool</code>             store information on all supported gases, incl those not provided in cfg</li><li><code>check_integrity::Bool</code>           confirm integrity of thermo files using their checksum</li><li><code>κ_grey_lw::Float64</code>              gas opacity when using grey-gas RT scheme, longwave</li><li><code>κ_grey_sw::Float64</code>              gas opacity when using grey-gas RT scheme, shortwave</li><li><code>fastchem_work::String</code>           working directory for fastchem</li><li><code>fastchem_floor::Float64</code>         temperature floor on profile provided to fastchem</li><li><code>fastchem_maxiter_chem::Float64</code>  maximum chemical iterations allowed by fastchem</li><li><code>fastchem_maxiter_solv:Float64</code>   maximum solver iterations allowed by fastchem</li><li><code>fastchem_xtol_chem::Float64</code>     solution tolerance required of fastchem (chemical)</li><li><code>fastchem_xtol_elem::Float64</code>     solution tolerance required of fastchem (elemental)</li><li><code>rfm_parfile::String</code>             path to HITRAN-formatted .par file provided to RFM</li></ul><p>Returns:     Nothing</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/atmosphere.jl#L367-L434">source</a></section></details></article><h3 id="Energy-flux-calculations"><a class="docs-heading-anchor" href="#Energy-flux-calculations">Energy flux calculations</a><a id="Energy-flux-calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-flux-calculations" title="Permalink"></a></h3><p>Functions from <code>energy.jl</code>.</p><article><details class="docstring" open="true"><summary id="AGNI.energy._radtrans_greygas!-Tuple{Any}"><a class="docstring-binding" href="#AGNI.energy._radtrans_greygas!-Tuple{Any}"><code>AGNI.energy._radtrans_greygas!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Solve RT using double grey-gas formulation</strong></p><p>Simple two-stream double grey RT solver which integrates fluxes from the TOA and BOA.</p><p>Uses two opacity values to represent the LW and SW components of the flux field.</p><p>Loosely following this tutorial, which is based on Pierrehumbert (2010). https://brian-rose.github.io/ClimateLaboratoryBook/courseware/radiative-transfer/</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>                  the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L309-L321">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.energy._radtrans_socrates!-Tuple{AGNI.atmosphere.Atmos_t, Bool}"><a class="docstring-binding" href="#AGNI.energy._radtrans_socrates!-Tuple{AGNI.atmosphere.Atmos_t, Bool}"><code>AGNI.energy._radtrans_socrates!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Solve radiative transfer using SOCRATES</strong></p><p>Imports SOCRATES wrapper from the atmosphere module, rather than loading it twice.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</li><li><code>lw::Bool</code>                True: longwave calculation. False: shortwave calculation.</li></ul><p>Optional arguments:</p><ul><li><code>calc_cf::Bool</code>           also calculate contribution function?</li><li><code>gauss_ir::Bool</code>          using gaussian angular integration in IR, otherwise uses two-stream approximation</li><li><code>rescale_pf::Bool</code>        perform rescaling on phase function</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L35-L48">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.energy.calc_fluxes!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.energy.calc_fluxes!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.calc_fluxes!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate energy flux at each level.</strong></p><p>Calculates flux components (radtrans, convection, etc.) and sums them to get total flux. Also updates thermodynamic properties (heat capacity, density, etc.) at each layer.</p><p>Assumes that chemistry functions have already been called, if wanted. Does not call fastchem here.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>                  the atmosphere struct instance to be used.</li></ul><p>Optional arguments:</p><ul><li><code>radiative::Bool</code>                 include radiation fluxes</li><li><code>latent_heat::Bool</code>               include condensation flux</li><li><code>convective::Bool</code>                include MLT convection flux</li><li><code>sens_heat::Bool</code>                 include TKE sensible heat flux</li><li><code>conductive::Bool</code>                include conductive heat flux</li><li><code>advective::Bool</code>                 include advective heat flux</li><li><code>convect_sf::Float64</code>             scale factor applied to convection fluxes</li><li><code>latent_sf::Float64</code>              scale factor applied to phase change fluxes</li><li><code>calc_cf::Bool</code>                   calculate LW contribution function?</li></ul><p>Returns:</p><ul><li><code>ok::Bool</code>                        calculation performed ok?</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L821-L846">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.energy.calc_hrates!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.energy.calc_hrates!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.calc_hrates!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate heating rates at cell-centres from the total flux.</strong></p><p>Requires the total flux to have already been set (atmos.flux_tot). Heating rates are calculated in units of kelvin per day.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>                  the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L908-L916">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.energy.conduct!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.energy.conduct!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.conduct!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate conductive heat fluxes using Fourier&#39;s law</strong></p><p>Updates array of <code>atmos.flux_cdct</code> at each layer of the atmosphere.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>          the atmosphere struct instance to be used</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L458-L465">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.energy.convection!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.energy.convection!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.convection!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate dry convective fluxes using mixing length theory.</strong></p><p>Convective energy transport fluxes are calculated at every level edge, just like the radiative fluxes. This is not compatible with moist convection. By using MLT to parameterise convection, we can also calculate Kzz directly.</p><p>Uses the mixing length formulation outlined by Joyce &amp; Tayar (2023), which was also implemented in Lee et al. (2024), and also partially outlined in the review by Robinson &amp; Marley (2014). https://arxiv.org/abs/2303.09596 https://doi.org/10.1093/mnras/stae537 https://ui.adsabs.harvard.edu/abs/1962JGR....67.3095B/abstract</p><p>The adiabatic lapse rate is formulated as:     <code>∇_ad = dln(T)/dln(P) = (P/T)*(dT/dP) = (P/T)*(1/[ρ c_p])</code> for an ideal gas, this becomes:     <code>∇_ad = R / (μ c_p)</code></p><p>The mixing length is set to asymptotically approach H (for z&gt;&gt;H) or z (for z&lt;H) as per Blackadar (1962). Alternatively, it can be set equal to H. https://doi.org/10.1029/JZ067i008p03095</p><p>The scale height is formulated as:     <code>Hp = P / (ρ g)</code> Where ρ is obtained from the equation of state.</p><p>To account for convective stability due to compositional gradients, we can use the Ledoux criterion rather than the Schwarzschild criterion. This is described nicely in Gabriel et al. (2014), as well as Salaris &amp; Cassisi (2017). http://dx.doi.org/10.1051/0004-6361/201423442 https://doi.org/10.1098/rsos.170192</p><p>In the ideal gas regime, the Ledoux criterion can be simply written as:     <code>∇_ld = ∇_ad + dln(μ)/dln(P)</code> Using Equation (10) of Gabriel+14. Taking β=Pg/P=1 means the gas pressure equals the total pressure, neglecting pressure contributions from ions and electrons.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</li></ul><p>Optional arguments:</p><ul><li><code>pmin::Float64</code>           pressure [bar] below which convection is disabled</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L483-L526">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.energy.eval_exchange_coeff-Tuple{Float64, Float64}"><a class="docstring-binding" href="#AGNI.energy.eval_exchange_coeff-Tuple{Float64, Float64}"><code>AGNI.energy.eval_exchange_coeff</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate turbulent kinetic energy (TKE) exchange coefficient</strong>.</p><p>Based on Monin–Obukhov similarity theory, from roughness length scale. See eq 9 in Nicholson &amp; Benn (2009). Added small epsilon-factor to avoid function blowing-up around regime where height ≈ roughness.</p><p>Arguments:</p><ul><li><code>height::Float64</code>     Height above surface [m]</li><li><code>roughness::Float64</code>  Roughness length scale [m]</li></ul><p>Returns:</p><ul><li><code>C_d::Float64</code>        TKE exchange coefficient [dimensionless]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L416-L429">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.energy.fill_Kzz!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.energy.fill_Kzz!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.fill_Kzz!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Fill Kzz values for the entire profile.</strong></p><p>This function is called after the convection scheme has been run.</p><p>The Kzz value in the convective region (and below) are set equal to the maximum value in the convective region, as calculated by MLT. The value increases with power-law scaling with pressure in the stratosphere.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L634-L645">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.energy.latent!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.energy.latent!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.latent!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Analytical diffusion scheme for condensation and evaporation energy.</strong></p><p>Updates fluxes. Requires <code>chemistry.rainout_and_evaporate</code> to be called first.</p><p>Integrates from bottom of model upwards. Based on the amount of phase change at each level, a phase change flux is calculated by assuming a fixed condensation timescale.</p><p>If evaporation is enabled, then integrates from top downwards to determine flux from re-evaporation of droplets. Any droplets which reach the ground go towards forming an ocean.</p><p>Should ideally perform a microphysical treatment; e.g. by following this paper: https://agupubs.onlinelibrary.wiley.com/doi/epdf/10.1029/2020JE006653</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L691-L708">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.energy.make_finite!-Tuple{Any, Any}"><a class="docstring-binding" href="#AGNI.energy.make_finite!-Tuple{Any, Any}"><code>AGNI.energy.make_finite!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Set non-finite values in an array equal to a given fill value</strong>.</p><p>Arguments:</p><ul><li><code>arr</code>      array potentially containing non-finite values</li><li><code>fill</code>     replacement value to fill with</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L24-L30">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.energy.radtrans!-Tuple{AGNI.atmosphere.Atmos_t, Bool}"><a class="docstring-binding" href="#AGNI.energy.radtrans!-Tuple{AGNI.atmosphere.Atmos_t, Bool}"><code>AGNI.energy.radtrans!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate radiative fluxes using the desired scheme.</strong></p><p>Uses the configuration inside the atmos struct. Can either do LW or SW calculation, set by <code>lw</code> function argument.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>                  the atmosphere struct instance to be used.</li><li><code>lw::Bool</code>                        longwave calculation? Else: shortwave</li><li><code>calc_cf::Bool=false</code>             also calculate contribution function?</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L360-L370">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.energy.reset_fluxes!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.energy.reset_fluxes!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.reset_fluxes!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Reset energy fluxes to zero.</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L774-L776">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.energy.sensible!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.energy.sensible!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.sensible!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate sensible heat flux from turbulent kinetic energy (TKE)</strong></p><p>Updates the values of <code>atmos.C_d</code> and <code>atmos.flux_sens</code>.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>          the atmosphere struct instance to be used</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L434-L441">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.energy.skin_flux-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.energy.skin_flux-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.skin_flux</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate flux carried by conductive skin.</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/energy.jl#L767-L769">source</a></section></details></article><h3 id="Chemistry-and-phase-change-calculations"><a class="docs-heading-anchor" href="#Chemistry-and-phase-change-calculations">Chemistry and phase-change calculations</a><a id="Chemistry-and-phase-change-calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Chemistry-and-phase-change-calculations" title="Permalink"></a></h3><p>Functions from <code>chemistry.jl</code>.</p><article><details class="docstring" open="true"><summary id="AGNI.chemistry"><a class="docstring-binding" href="#AGNI.chemistry"><code>AGNI.chemistry</code></a> — <span class="docstring-category">Module</span></summary><section><div><p>This module handles chemistry, condensation, and evaporation.</p><p>Note the important distinctions between the variables which store atmospheric composition.</p><ul><li><code>gas_ovmr</code> stores VMRs inputted by the user, which are usually constant in height.</li><li><code>gas_vmr</code> stores the runtime gas volume mixing ratios, after all calculations are performed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/chemistry.jl#L9-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.chemistry._chem_gas!-Tuple{AGNI.atmosphere.Atmos_t, Bool}"><a class="docstring-binding" href="#AGNI.chemistry._chem_gas!-Tuple{AGNI.atmosphere.Atmos_t, Bool}"><code>AGNI.chemistry._chem_gas!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate gas-phase composition at dry thermochemical equilibrium.</strong></p><p>Uses FastChem to calculate the gas composition at each level of the atmosphere. Volatiles are converted to bulk elemental abundances, which are then provided to FastChem alongside the temperature/pressure profile. FastChem is currently called as an executable, which is not optimal.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>                  the atmosphere struct instance to be used.</li><li><code>write_cfg::Bool</code>                 write config and elements</li></ul><p>Returns:</p><ul><li><code>state::Int</code>                      fastchem state (0: success, 1: critical<em>fail, 2: elem</em>fail, 3: conv<em>fail, 4: both</em>fail)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/chemistry.jl#L406-L420">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.chemistry._sat_aloft!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.chemistry._sat_aloft!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.chemistry._sat_aloft!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Handle sub/super-saturation aloft; required for latent heat flux calcaulation</strong></p><p>Adjust gas VMRs according to saturation and cold-trap requirements.</p><p>Volatiles which are allowed to condense are rained-out at condensing levels until the gas is exactly saturated, not supersaturated. If evaporation is enabled here, it will lead to enhanced mixing ratios at deeper levels as rain is converted back into gas from a liquid state.</p><p>Any rain that reaches the surface without being evaporated leads to ocean formation. Disabling evaporation will lead to unclosed energy budget when calculation of latent heat fluxes is performed.</p><p>This function can be called <em>after</em> the fastchem calculation.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/chemistry.jl#L206-L224">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.chemistry._sat_surf!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.chemistry._sat_surf!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.chemistry._sat_surf!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Handle sub/super-saturation at the surface, forming oceans.</strong></p><p>NOTE: this function does not reset to <code>atmos</code> to its original state before operating.</p><p>If a condensable is supersaturated at the surface, its partial surface pressure is reduced to exactly saturation. The condensed mass is added to the ocean reservoir. If a condensable is subsaturated at the surface, its partial pressure is increased to exactly saturation, subject to the amount of ocean available. Reduces or increases the total surface pressure accordingly.</p><p>Accounts for mmw ratio when converting from partial pressures to masses:     m<em>i = (p</em>i/g) * (mu<em>i / mu</em>tot) where m<em>i has units [kg/m^2] and mu</em>tot is the total mixture MMW.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</li></ul><p>Returns:</p><ul><li><code>any_changed::Bool</code>       did any component condense or evaporate?</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/chemistry.jl#L107-L127">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.chemistry.calc_composition!-Tuple{AGNI.atmosphere.Atmos_t, Bool, Bool, Bool}"><a class="docstring-binding" href="#AGNI.chemistry.calc_composition!-Tuple{AGNI.atmosphere.Atmos_t, Bool, Bool, Bool}"><code>AGNI.chemistry.calc_composition!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Run condensation and chemistry schemes as required.</strong></p><p>This function is designed as a wrapper for appropriately handling these three schemes together in the correct order, so that variables are appropriately updated. Steps:</p><ol><li>call <code>_sat_surf!</code> to handle saturation at the surface, and adjust the pressure grid</li><li>call <code>_chem_gas!</code> to handle gas-phase chemistry in the column</li><li>call <code>_sat_aloft!</code> to handle saturation aloft, above the surface.</li></ol><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>       the atmosphere struct instance to be used.</li><li><code>do_surf::Bool</code>        do saturation cond/evap at surface</li><li><code>do_chem::Bool</code>        do thermochemistry in the column</li><li><code>do_aloft::Bool</code>       do saturation cond/evap aloft</li></ul><p>Returns:</p><ul><li><code>state::Int</code>           fastchem state (0: success, 1: critical<em>fail, 2: elem</em>fail, 3: conv<em>fail, 4: both</em>fail)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/chemistry.jl#L726-L744">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.chemistry.normalise_vmrs!-Tuple{AGNI.atmosphere.Atmos_t, Int64}"><a class="docstring-binding" href="#AGNI.chemistry.normalise_vmrs!-Tuple{AGNI.atmosphere.Atmos_t, Int64}"><code>AGNI.chemistry.normalise_vmrs!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Normalise gas VMRs, keeping condensates unchanged</strong></p><p>Only acts on a single model level.</p><p>Parameters:</p><ul><li><code>atmos::atmosphere.Atmos_t</code>       atmosphere structure</li><li><code>i::Int</code>                          level index to normalise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/chemistry.jl#L32-L40">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.chemistry.restore_composition!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.chemistry.restore_composition!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.chemistry.restore_composition!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Reset mixing ratios, pressures, and oceans to their original values</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/chemistry.jl#L84-L86">source</a></section></details></article><h3 id="Numerical-solvers"><a class="docs-heading-anchor" href="#Numerical-solvers">Numerical solvers</a><a id="Numerical-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-solvers" title="Permalink"></a></h3><p>Functions from <code>solver.jl</code>.</p><article><details class="docstring" open="true"><summary id="AGNI.solver.gs_search-Tuple{Function, Float64, Float64, Float64, Float64, Int64}"><a class="docstring-binding" href="#AGNI.solver.gs_search-Tuple{Function, Float64, Float64, Float64, Float64, Int64}"><code>AGNI.solver.gs_search</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Golden section search algorithm</strong></p><p>Minimises a function <code>f</code> between the bounds <code>a</code> and <code>b</code>. The function <code>f</code> must return a positive scalar.</p><p>Arguments:</p><ul><li><code>f</code>           Function to be minimised</li><li><code>a</code>           Initial bracket, lower value</li><li><code>b</code>           Initial bracket, upper valuie</li><li><code>dxtol</code>       Convergence: exit when bracket is smaller than this size</li><li><code>atol</code>        Convergence: absolute tolerance on minimum</li><li><code>max_steps</code>   Maximum number of iterations</li><li><code>warnings</code>    Print warning if search does not converge before <code>max_steps</code>` are taken.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/solver.jl#L24-L38">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.solver.solve_energy!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.solver.solve_energy!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.solver.solve_energy!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Obtain radiative-convective equilibrium using a matrix method.</strong></p><p>Solves the non-linear system of equations defined by the flux field divergence, minimising flux loss across a cell by iterating the temperature profile.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>                  the atmosphere struct instance to be used.</li></ul><p>Optional physics arguments:</p><ul><li><code>sol_type::Int</code>                   solution type, 1: tmp<em>surf | 2: skin | 3: flux</em>int | 4: tgt_olr</li><li><code>chem::Bool</code>                      include eqm thermochemistry when solving for RCE?</li><li><code>convect::Bool</code>                   include convection</li><li><code>sens_heat::Bool</code>                 include sensible heating at the surface</li><li><code>conduct::Bool</code>                   include conductive heat transport within the atmosphere</li><li><code>latent::Bool</code>                    include latent heat exchange (condensation/evaporation)</li><li><code>advect::Bool</code>                    include advective heat exchange (dynamics)</li><li><code>rainout::Bool</code>                   allow rainout (phase change impacts mixing ratios, not just energy fluxes)</li><li><code>oceans::Bool</code>                    check surface saturation (ocean formation)</li></ul><p>Optional solver arguments:</p><ul><li><code>dx_min::Float64</code>                 minimum step size [K]</li><li><code>dx_max::Float64</code>                 maximum step size [K]</li><li><code>tmp_pad::Float64</code>                padding around hard limits on temperature floor &amp; ceiling values</li><li><code>max_steps::Int</code>                  maximum number of solver steps</li><li><code>max_runtime::Float64</code>            maximum runtime in wall-clock seconds</li><li><code>fdc::Bool</code>                       finite difference: central difference? otherwise use forward difference</li><li><code>fdo::Int</code>                        finite difference: scheme order (2nd or 4th)</li><li><code>method::Int</code>                     numerical method (1: Newton-Raphson, 2: Gauss-Newton, 3: Levenberg-Marquardt)</li><li><code>easy_start::Bool</code>                improve convergence reliability; introduce convection and latent heat gradually</li><li><code>grey_start::Bool</code>                improve convergence reliability; obtain double-grey solution first</li><li><code>ls_method::Int</code>                  linesearch algorithm (0: None, 1: golden, 2: backtracking)</li><li><code>detect_plateau::Bool</code>            assist solver when it is stuck in a region of small dF/dT</li><li><code>perturb_all::Bool</code>               always recalculate entire Jacobian matrix? Otherwise updates columns only as required</li><li><code>modplot::Int</code>                    iteration frequency at which to make plots</li><li><code>save_frames::Bool</code>               save plotting frames</li><li><code>modprint::Int</code>                   iteration frequency at which to print info</li><li><code>plot_jacobian::Bool</code>             plot jacobian too?</li><li><code>radiative_Kzz::Bool</code>             estimate Kzz in radiative zones? Otherwise left at Kzz=0 in these regions.</li><li><code>conv_atol::Float64</code>              convergence: absolute tolerance on per-level flux deviation [W m-2]</li><li><code>conv_rtol::Float64</code>              convergence: relative tolerance on per-level flux deviation [dimensionless]</li></ul><p>Returns:     Nothing</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/solver.jl#L132-L177">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.solver.solve_prescribed!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.solver.solve_prescribed!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.solver.solve_prescribed!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Solve for global (not local) balance with a prescribed atmosphere structure.</strong></p><p>Comparable to solve_transparent, but with an opaque prescribed atmospheric structure.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>         the atmosphere struct instance to be used.</li><li><code>sol_type::Int</code>          solution types, same as solve_energy</li><li><code>atm_type::Int</code>         atmosphere prescription (1: isothermal, 2: adiabat, 3: adiabat+stratosphere)</li><li><code>conv_atol::Float64</code>     convergence: absolute tolerance on global flux [W m-2]</li><li><code>conv_rtol::Float64</code>     convergence: relative tolerance on global flux [dimensionless]</li><li><code>max_steps::Int</code>         maximum number of solver steps</li><li><code>tmp_upper::Float64</code>     upper-bound on Tsurf for golden-section search [K]</li></ul><p>Returns:</p><ul><li><code>Bool</code> indicating success</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/solver.jl#L1012-L1028">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.solver.solve_transparent!-Tuple{AGNI.atmosphere.Atmos_t}"><a class="docstring-binding" href="#AGNI.solver.solve_transparent!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.solver.solve_transparent!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Solve for energy balance with a transparent atmosphere.</strong></p><p>This will use an isothermal temperature profile, and only modify T_surf.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>         the atmosphere struct instance to be used.</li><li><code>sol_type::Int</code>          solution types, same as solve_energy</li><li><code>conv_atol::Float64</code>     convergence: absolute tolerance on global flux [W m-2]</li><li><code>conv_rtol::Float64</code>     convergence: relative tolerance on global flux [dimensionless]</li><li><code>max_steps::Int</code>         maximum number of solver steps</li><li><code>tmp_upper::Float64</code>     upper-bound on Tsurf for golden-section search [K]</li></ul><p>Returns:</p><ul><li><code>Bool</code> indicating success</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/solver.jl#L1160-L1175">source</a></section></details></article><h3 id="Plotting-functions-and-utilities"><a class="docs-heading-anchor" href="#Plotting-functions-and-utilities">Plotting functions and utilities</a><a id="Plotting-functions-and-utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-functions-and-utilities" title="Permalink"></a></h3><p>Functions from <code>plotting.jl</code>.</p><article><details class="docstring" open="true"><summary id="AGNI.plotting.animate-Tuple{String, String}"><a class="docstring-binding" href="#AGNI.plotting.animate-Tuple{String, String}"><code>AGNI.plotting.animate</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Convert still-frame images into an animation</strong></p><p>Uses FFMPEG provided by Julia library.</p><p>Arguments:</p><ul><li><code>output_dir::String</code>          folder in which to save the animation</li><li><code>frames_dir::String</code>          folder containing the frames</li></ul><p>Optional arguments:</p><ul><li><code>output_fmt::String</code>          output file format: mp4, mov, ...</li><li><code>frames_fmt::String</code>          input frame format: png, jpg, ...</li><li><code>duration::Float64</code>           animation duration [seconds]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/plotting.jl#L707-L720">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.plotting.combined-Tuple{Any, Any, Any, Any, String, String}"><a class="docstring-binding" href="#AGNI.plotting.combined-Tuple{Any, Any, Any, Any, String, String}"><code>AGNI.plotting.combined</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Combined plot used for tracking behaviour of the solver</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/plotting.jl#L688-L690">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.plotting.jacobian-Tuple{Matrix{Float64}, String}"><a class="docstring-binding" href="#AGNI.plotting.jacobian-Tuple{Matrix{Float64}, String}"><code>AGNI.plotting.jacobian</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Plot jacobian matrix</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/plotting.jl#L742-L744">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.plotting.plot_albedo-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.plotting.plot_albedo-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_albedo</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Plot spectral albedo (ratio of SW<em>UP to SW</em>DN)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/plotting.jl#L654-L656">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.plotting.plot_cloud-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.plotting.plot_cloud-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_cloud</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Plot the cloud mass mixing ratio and area fraction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/plotting.jl#L168-L170">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.plotting.plot_contfunc1-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.plotting.plot_contfunc1-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_contfunc1</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Plot contribution function at different bands.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/plotting.jl#L496-L498">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.plotting.plot_contfunc2-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.plotting.plot_contfunc2-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_contfunc2</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Plot normalised contribution function (per band)</p><p>The data displayed in this plot are fine, but the x-axis ticks are labelled incorrectly by the plotting library. I don&#39;t know why this is.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/plotting.jl#L578-L583">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.plotting.plot_emission-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.plotting.plot_emission-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_emission</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Plot emission spectrum at the TOA</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/plotting.jl#L432-L434">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.plotting.plot_fluxes-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.plotting.plot_fluxes-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_fluxes</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Plot the fluxes at each pressure level</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/plotting.jl#L303-L305">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.plotting.plot_pt-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.plotting.plot_pt-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_pt</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Plot the temperature-pressure profile.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/plotting.jl#L64-L66">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.plotting.plot_radius-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.plotting.plot_radius-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_radius</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Plot the radius vs pressure profile.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/plotting.jl#L130-L132">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.plotting.plot_vmr-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.plotting.plot_vmr-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_vmr</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Plot the VMRs of the atmosphere at each cell-centre location.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/plotting.jl#L207-L209">source</a></section></details></article><h3 id="Physical-properties-and-constants"><a class="docs-heading-anchor" href="#Physical-properties-and-constants">Physical properties and constants</a><a id="Physical-properties-and-constants-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-properties-and-constants" title="Permalink"></a></h3><p>Functions from <code>phys.jl</code>.</p><article><details class="docstring" open="true"><summary id="AGNI.phys._get_mmw-Tuple{String}"><a class="docstring-binding" href="#AGNI.phys._get_mmw-Tuple{String}"><code>AGNI.phys._get_mmw</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Calculate species mean molecular weight [kg mol-1] from formula or use known value</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L428-L430">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys._pretty_color-Tuple{String}"><a class="docstring-binding" href="#AGNI.phys._pretty_color-Tuple{String}"><code>AGNI.phys._pretty_color</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Generate a colour hex code from a molecular formula</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L466-L468">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys._pretty_name-Tuple{String}"><a class="docstring-binding" href="#AGNI.phys._pretty_name-Tuple{String}"><code>AGNI.phys._pretty_name</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Convert formula to pretty unicode string</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L450-L452">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys._rho_ideal-Tuple{Float64, Float64, Float64}"><a class="docstring-binding" href="#AGNI.phys._rho_ideal-Tuple{Float64, Float64, Float64}"><code>AGNI.phys._rho_ideal</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Evaluate the density of a single gas using the ideal gas EOS.</strong></p><p>Arguments:</p><ul><li><code>tmp::Float64</code>        temperature [K]</li><li><code>prs::Float64</code>        pressure [Pa]</li><li><code>mmw::Float64</code>        mean molecular weight [kg mol-1]</li></ul><p>Returns:</p><ul><li><code>rho::Float64</code>        mass density [kg m-3]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L744-L754">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.calc_Teq-Tuple{Float64, Float64}"><a class="docstring-binding" href="#AGNI.phys.calc_Teq-Tuple{Float64, Float64}"><code>AGNI.phys.calc_Teq</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate planetary equilibrium temperature.</strong></p><p>https://en.wikipedia.org/wiki/Planetary<em>equilibrium</em>temperature?useskin=vector</p><p>Arguments:</p><ul><li><code>S::Float64</code>       Bolometric instellation [W m-2]</li><li><code>α::Float64</code>       Bond albedo</li></ul><p>Returns:</p><ul><li><code>Teq::Float64</code>     Planetary equilibrium temperature [K]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L843-L854">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.calc_Tskin-Tuple{Float64, Float64}"><a class="docstring-binding" href="#AGNI.phys.calc_Tskin-Tuple{Float64, Float64}"><code>AGNI.phys.calc_Tskin</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate planetary <em>skin</em> temperature.</strong></p><p>https://en.wikipedia.org/wiki/Skin<em>temperature</em>(atmosphere)?useskin=vector</p><p>Arguments:</p><ul><li><code>S::Float64</code>       Bolometric instellation [W m-2]</li><li><code>α::Float64</code>       Bond albedo</li></ul><p>Returns:</p><ul><li><code>Tskin::Float64</code>   Planetary skin temperature [K]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L859-L870">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.calc_rho_gas-Tuple{Float64, Float64, AGNI.phys.Gas_t}"><a class="docstring-binding" href="#AGNI.phys.calc_rho_gas-Tuple{Float64, Float64, AGNI.phys.Gas_t}"><code>AGNI.phys.calc_rho_gas</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate the density of a gas using the most appropriate equation of state.</strong></p><p>Arguments:</p><ul><li><code>tmp::Float64</code>        temperature [K]</li><li><code>prs::Float64</code>        pressure [Pa]</li><li><code>gas::Gas_t</code>          the gas struct to be used</li></ul><p>Returns:</p><ul><li><code>rho::Float64</code>        mass density [kg m-3]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L723-L733">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.calc_rho_mix-Tuple{Vector{AGNI.phys.Gas_t}, Vector{Float64}, Float64, Float64, Float64}"><a class="docstring-binding" href="#AGNI.phys.calc_rho_mix-Tuple{Vector{AGNI.phys.Gas_t}, Vector{Float64}, Float64, Float64, Float64}"><code>AGNI.phys.calc_rho_mix</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate the density of a mixture of gases using Amagat&#39;s law.</strong></p><p>Arguments:</p><ul><li><code>gas::Array{Gas_t,1}</code>     array of gases</li><li><code>vmr::Array{Float64,1}</code>   array of volume mixing ratios</li><li><code>tmp::Float64</code>            temperature [K]</li><li><code>prs::Float64</code>            pressure [Pa]</li></ul><p>Returns:</p><ul><li><code>rho::Float64</code>            mass density [kg m-3]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L684-L695">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.calc_therm_diffus-Tuple{Float64, Float64, Float64}"><a class="docstring-binding" href="#AGNI.phys.calc_therm_diffus-Tuple{Float64, Float64, Float64}"><code>AGNI.phys.calc_therm_diffus</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate thermal diffusivity.</strong></p><p>https://en.wikipedia.org/wiki/Thermal_diffusivity?useskin=vector</p><p>Arguments:</p><ul><li><code>k::Float64</code>       Thermal conductivity [W m-1 K-1]</li><li><code>ρ::Float64</code>       Density [kg m-3]</li><li><code>cp::Float64</code>      Specific heat capacity [J K-1 kg-1]</li></ul><p>Returns:</p><ul><li><code>α::Float64</code>       Thermal diffusivity [m2 s-1]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L826-L838">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.count_atoms-Tuple{String}"><a class="docstring-binding" href="#AGNI.phys.count_atoms-Tuple{String}"><code>AGNI.phys.count_atoms</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Get number of atoms from formula, returning a dictionary</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L340-L342">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.evaluate_planck-Tuple{Float64, Float64}"><a class="docstring-binding" href="#AGNI.phys.evaluate_planck-Tuple{Float64, Float64}"><code>AGNI.phys.evaluate_planck</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Evaluate the Planck function at a given wavelength and temperature.</strong></p><p>Integrated over a hemisphere.</p><p>Arguments:</p><ul><li><code>wave::Float64</code>       Wavelength [nm]</li><li><code>tmp::Float64</code>        Temperature [K]</li></ul><p>Returns:</p><ul><li><code>flx::Float64</code>        Spectral flux density [W m-2 nm-1]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L759-L770">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.get_Cp-Tuple{AGNI.phys.Gas_t, Float64}"><a class="docstring-binding" href="#AGNI.phys.get_Cp-Tuple{AGNI.phys.Gas_t, Float64}"><code>AGNI.phys.get_Cp</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Get gas heat capacity for a given temperature.</strong></p><p>Evaluates at 0 Celcius if <code>gas.tmp_dep=false</code>.</p><p>Arguments:</p><ul><li><code>gas::Gas_t</code>              the gas struct to be used</li><li><code>t::Float64</code>              temperature [K]</li></ul><p>Returns:</p><ul><li><code>cp::Float64</code>             heat capacity of gas [J K-1 kg-1]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L623-L634">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.get_Kc-Tuple{AGNI.phys.Gas_t, Float64}"><a class="docstring-binding" href="#AGNI.phys.get_Kc-Tuple{AGNI.phys.Gas_t, Float64}"><code>AGNI.phys.get_Kc</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Get gas thermal conductivity at a given temperature.</strong></p><p>This assumes that the gas is within the ideal regime.</p><p>Arguments:</p><ul><li><code>gas::Gas_t</code>              the gas struct to be used</li><li><code>t::Float64</code>              temperature [K]</li></ul><p>Returns:</p><ul><li><code>kc::Float64</code>             thermal conductivity [W m-1 K-1]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L657-L668">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.get_Lv-Tuple{AGNI.phys.Gas_t, Float64}"><a class="docstring-binding" href="#AGNI.phys.get_Lv-Tuple{AGNI.phys.Gas_t, Float64}"><code>AGNI.phys.get_Lv</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Get gas enthalpy (latent heat) of phase change.</strong></p><p>If the temperature is above the critical point, then a zero value is returned. Evaluates at 0 Celcius if <code>gas.tmp_dep=false</code>.</p><p>Arguments:</p><ul><li><code>gas::Gas_t</code>              the gas struct to be used</li><li><code>t::Float64</code>              temperature [K]</li></ul><p>Returns:</p><ul><li><code>h::Float64</code>              enthalpy of phase change [J kg-1]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L589-L601">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.get_Psat-Tuple{AGNI.phys.Gas_t, Float64}"><a class="docstring-binding" href="#AGNI.phys.get_Psat-Tuple{AGNI.phys.Gas_t, Float64}"><code>AGNI.phys.get_Psat</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Get gas saturation pressure for a given temperature.</strong></p><p>If the temperature is above the critical point, then a large value is returned.</p><p>Arguments:</p><ul><li><code>gas::Gas_t</code>              the gas struct to be used</li><li><code>t::Float64</code>              temperature [K]</li></ul><p>Returns:</p><ul><li><code>p::Float64</code>              saturation pressure [Pa]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L500-L512">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.get_Tdew-Tuple{AGNI.phys.Gas_t, Float64}"><a class="docstring-binding" href="#AGNI.phys.get_Tdew-Tuple{AGNI.phys.Gas_t, Float64}"><code>AGNI.phys.get_Tdew</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Get gas dew point temperature for a given partial pressure.</strong></p><p>If the pressure is below the critical point pressure, then T_crit is returned. This function is horrendous, and should be avoided at all costs.</p><p>Arguments:</p><ul><li><code>gas::Gas_t</code>              the gas struct to be used</li><li><code>p::Float64</code>              pressure [Pa]</li></ul><p>Returns:</p><ul><li><code>t::Float64</code>              dew point temperature [K]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L533-L545">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.grav_accel-Tuple{Float64, Float64}"><a class="docstring-binding" href="#AGNI.phys.grav_accel-Tuple{Float64, Float64}"><code>AGNI.phys.grav_accel</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Calculate gravitational acceleration.</strong></p><p>Arguments:</p><ul><li><code>mass::Float64</code>       Enclosed mass [kg]</li><li><code>radius::Float64</code>     Enclosed radius [m]</li></ul><p>Returns:</p><ul><li><code>grav::Float64</code>       Gravitational acceleration [m s-2]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L793-L802">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.is_vapour-Tuple{AGNI.phys.Gas_t, Float64, Float64}"><a class="docstring-binding" href="#AGNI.phys.is_vapour-Tuple{AGNI.phys.Gas_t, Float64, Float64}"><code>AGNI.phys.is_vapour</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Check if pressure-temperature coordinate is within the vapour regime.</strong></p><p>Returns true if p &gt; p<em>sat and t &lt; t</em>crit.</p><p>Arguments:</p><ul><li><code>gas::Gas_t</code>              the gas struct to be used</li><li><code>t::Float64</code>              temperature [K]</li><li><code>p::Float64</code>              temperature [K]</li></ul><p>Returns:</p><ul><li><code>vapour::Bool</code>           is within vapour regime?</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L560-L572">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.liquid_rho-Tuple{String}"><a class="docstring-binding" href="#AGNI.phys.liquid_rho-Tuple{String}"><code>AGNI.phys.liquid_rho</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Evaluate the density of a liquid phase.</strong></p><p>Returns BIGFLOAT density for unsupported phases, to avoid divide-by-zero error</p><p>Arguments:</p><ul><li><code>name::String</code>    Name of liquid</li></ul><p>Returns:</p><ul><li><code>rho::Float64</code>    Density of liquid phase [kg m-3]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L807-L817">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.load_gas-Tuple{String, String, Bool, Bool}"><a class="docstring-binding" href="#AGNI.phys.load_gas-Tuple{String, String, Bool, Bool}"><code>AGNI.phys.load_gas</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Load gas data into a new struct</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L106-L108">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.phys.same_atoms-Tuple{Dict, Dict}"><a class="docstring-binding" href="#AGNI.phys.same_atoms-Tuple{Dict, Dict}"><code>AGNI.phys.same_atoms</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Check if two gas atom dicts are equivalent</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/phys.jl#L398-L400">source</a></section></details></article><h3 id="File-I/O-modules"><a class="docs-heading-anchor" href="#File-I/O-modules">File I/O modules</a><a id="File-I/O-modules-1"></a><a class="docs-heading-anchor-permalink" href="#File-I/O-modules" title="Permalink"></a></h3><p>Functions from <code>save.jl</code> and <code>load.jl</code>.</p><article><details class="docstring" open="true"><summary id="AGNI.save.write_fluxes-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.save.write_fluxes-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.save.write_fluxes</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Write cell-edge energy fluxes to a CSV file</p><p>Arguments</p><ul><li><code>atmos::Atmos_t</code>      Atmosphere object</li><li><code>fname::String</code>       Filename to write to</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/save.jl#L50-L56">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.save.write_ncdf-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.save.write_ncdf-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.save.write_ncdf</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Write verbose atmosphere data to a NetCDF file</p><p>Arguments</p><ul><li><code>atmos::Atmos_t</code>      Atmosphere object</li><li><code>fname::String</code>       Filename to write to</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/save.jl#L80-L86">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.save.write_profile-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.save.write_profile-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.save.write_profile</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Write {Pressure, Temperature, Radius} profile to a CSV file</p><p>Arguments</p><ul><li><code>atmos::Atmos_t</code>      Atmosphere object</li><li><code>fname::String</code>       Filename to write to</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/save.jl#L23-L29">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AGNI.load.load_ncdf!-Tuple{AGNI.atmosphere.Atmos_t, String}"><a class="docstring-binding" href="#AGNI.load.load_ncdf!-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.load.load_ncdf!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p><strong>Load atmosphere data from a NetCDF file.</strong></p><p>This must be called after setup! and allocate! have been called on this atmos struct. Does not overwrite energy fluxes within the atmospherem, or other wavelength-dependent properties. Only composition, temperatures, layer properties, and boundary conditions are updated by this function.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</li><li><code>fname::String</code>       path to the NetCDF file</li></ul><p>Returns:</p><ul><li><code>ok::Bool</code>            loaded ok?</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/0980c16a8e87b2c367ee89a5e317390bc9b2dd06/src/load.jl#L17-L31">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../troubleshooting/">« Troubleshooting</a><a class="docs-footer-nextpage" href="../ecosystem/">Related codes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 4 December 2025 11:16">Thursday 4 December 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
