var documenterSearchIndex = {"docs":
[{"location":"model/#Model-description","page":"Model description","title":"Model description","text":"AGNI models a planetary atmosphere by treating it as a single column (1D) and splitting it up into levels of finite thickness. These levels are defined in pressure-space, and are arranged logarithmically between the surface and the top of the atmosphere. The atmosphere is assumed to be plane-parallel. Quantities such as pressure and temperature are calculated at level-centres and level-edges, while energy fluxes are calculated only at the edges, and thermodynamic properties (e.g. heat capacity) are calculated only at their centres.","category":"section"},{"location":"model/#Height-structure","page":"Model description","title":"Height structure","text":"The atmosphere is assumed to be hydrostatically supported. The density of the gas mixture is calculated using using Amagat's additive volume law to combine the densities of the components. The densities of each gas component are nominally calculated using the Van der Walls equation of state (EOS). AQUA is implemented as the EOS for water. The Chabrier+2019 EOS is implemented as the EOS for hydrogen. AGNI will fallback to the ideal gas EOS for otherwise unsupported gases.\n\nThe height at each pressure level is obtained by integrating from the surface upwards using a fourth order Runge-Kutta method. This includes self-gravitational attraction, and makes AGNI applicable as an atmospheric structure model.","category":"section"},{"location":"model/#Radiative-transfer","page":"Model description","title":"Radiative transfer","text":"Radiative transfer (RT) refers to the transport of radiation energy through a medium subject to the characteristics of the medium. Radiation passing through an atmosphere is absorbed, emitted, scattered, and reflected. In the context of planetary atmospheres, we also have to handle their surfaces, cloud formation, and radiation from the host star.\n\nAGNI nominally simulates RT using SOCRATES, a numerical code written by the UK Met Office which solves the RT equation using a two-stream solution. SOCRATES is accessed using a Julia interface originally written by Stuart Daines. Opacity is handled using the correlated-k approximation, with either random overlap or equivalent extinction used to account for overlapping absorption in mixtures of gases.\n\nThe model uses k-terms fitted to spectral absorption cross-section data from DACE. The MT_CKD model is used to estimate water continuum absorption cross-sections. Other continuua are derived from the HITRAN tables. Rayleigh scattering and water cloud radiative properties are also included. You can find tools for fitting k-terms and processing line absorption data in my redistribution of SOCRATES on GitHub. The flowchart below outlines how these absorption data are converted into a 'spectral file'.\n\n  <img src=\"assets/spectral_flowchart.svg\" width=100% class=\"center\"/>\n\nSurface reflectivity can be modelled as a greybody with an albedo from 0 to 1. Alternatively, the surface can be modelled using empirical reflectance data that varies (spectrally) with wavelength. In the latter case a filepath must be provided via the config. The file can tabulate any one of: spherical reflectance ('r'), hemispherical emissivity ('e'), or single scattering albedo ('w'). These data are compiled on Zenodo here.\n\nAGNI also includes an interface to the Reference Forward Model, which is packaged as a binary blob (the RFM source code is proprietary). This interface provides an extremely easy way to validate and benchmark SOCRATES.","category":"section"},{"location":"model/#Convection","page":"Model description","title":"Convection","text":"Convection is a turbulent process that occurs across more than one spatial dimension, so it must be parameterised within 1D models like AGNI. In fact, it is typically parameterised inside 3D global circulation models, as resolving convection is numerically expensive. AGNI uses mixing length theory (MLT) to parameterise atmospheric convection. This is in contrast to convective adjustment, which forcibly adjusts a convectively unstable region of the atmosphere to the corresponding adiabat while ensuring that enthalpy is conserved.\n\nMLT directly calculates the energy flux associated with convective heat transport, and thus is the preferred parameterisation within the model. It assumes that parcels of gas are diffused over a characteristic mixing length, transporting energy in the process. This requires choosing a scale for this mixing length, but in practice this has very little impact on the results from the model.\n\nWhen evaluating convective energy fluxes, AGNI first calculates the temperature gradient across each layer of the atmosphere. Convection occurs within each layer that has a lapse rate dTdP greater than the critical lapse rate for triggering convection. Equations 2 to 6 of Nicholls+2025 describe the calculation of the convective energy flux under the Schwarzschild criterion. AGNI can also check against the Ledoux criterion for convective stability, which accounts for vertical gradients in the gas MMW. The atmosphere is not explicitly split into convecting and non-convecting regions, thereby allowing disconnected regions of convection.","category":"section"},{"location":"model/#Condensation,-evaporation,-and-oceans","page":"Model description","title":"Condensation, evaporation, and oceans","text":"AGNI incorporates a simple ocean model, which is tied to the atmosphere rainout and evaporation schemes. This is divided into two reservoirs for each condensable component:\n\nAn initial reservoir of surface condensate, provided by the user.\nA total reservoir of surface condensate, based on the calculated chemistry and temperature profile.\n\nThe condensation and chemistry calculations then operate together. At each solver step, the following actions occur:\n\nThe surface temperature and partial pressures are checked against saturation, for each condensable\nSuper-saturated condensables have their partial pressures decreased, and the mass is added to the ocean resevoir\nSub-saturated condensables have their partial pressures increased based on the availablity of surface condensate\nChemistry is then performed to calculated the gas phase speciation; see Equilibrium chemistry below\nRainout is calculated aloft, based on sub/super-saturation at every atmosphere level.\n\nIn the first step, the model is effectively non-hydrostatic because the surface pressure (and whole pressure grid) is adjusted according to surface sub/super-saturation. The sum of condensation at the surface and aloft  go towards modulating the surface ocean content. The ocean layer structure is calculated according to liquid density. Two parameters (ocean basin area, contentinental shelf height) determine the filling fraction of the basins; i.e. whether the planet is a 'desert planet', a 'contentinental planet', or an 'aqua planet'.\n\nDuring the third step, where phase change happens aloft, the mixing ratios of dry species are increased in order to satisfy the total pressure at condensing levels. This is treated as a hydrostatic processes. The total accumulated amount of condensation (for each volatile) is then re-evaporated in the deeper atmosphere where possible. Rain reaching the surface contributes to the ocean.","category":"section"},{"location":"model/#Phase-change-in-the-atmosphere","page":"Model description","title":"Phase change in the atmosphere","text":"Gases release energy \"latent heat\" into their surroundings when condensing into a liquid or solid. This is included in the model through a diffusive condensation scheme, which assumes a fixed condensation timescale. Any rain which is not re-evaporated before reaching the surface is considered to contribute towards forming an ocean (secondary reservoir).\n\nThe latent heating associated with the change in partial pressure of condensable gases in the atmosphere is used to calculate a latent heating rate at each level of the model (positive where condensing, negative where evaporating). The heating rates in each layer are then integrated (from the TOA downwards) to provide a latent heat transport flux at cell-edges, which the assumption being that condensation occurs by updrafts. The integrated condensable heat flux is balanced by evaporation at deeper layers which closes the energy balance.\n\nLatent heats are temperature-dependent, using values derived from Coker (2007) and Wagner & Pruß (2001). Heat capacities are also temperature-dependent, using values derived from the JANAF database. See the ThermoTools repo for scripts. This method is conceptually similar to Derras-Chouk+2025.\n\nAGNI assumes that no work is done during phase changes aloft, p dV approx 0, so enthalpy and latent heat become equivalent.","category":"section"},{"location":"model/#Stellar-flux","page":"Model description","title":"Stellar flux","text":"A key input to the radiation model is the shortwave downward-directed flux from the star at the top of the atmosphere. This is quantified by the bolometric instellation flux, a scale factor, an artificial additional albedo factor, and a zenith angle. All of these may be provided to the model through the configuration file. The model also requires a stellar spectrum scaled to the top of the atmosphere.","category":"section"},{"location":"model/#Equilibrium-chemistry","page":"Model description","title":"Equilibrium chemistry","text":"By default, AGNI assumes that the atmosphere composition is \"well-mixed\". This means that the mixing ratios of the species are constant with height. Condensation of a super-saturated volatile will reduce its mixing ratio such that it becomes exactly saturated.\n\nWith condensation turned off, AGNI can couple to FastChem - a fast numerical model of equilibrium gas-phase chemistry. FastChem takes metallicities (elemental ratios), pressures, and temperatures as input variables. It outputs the partial pressures of a wide range of volatile species, with their mixing ratios set by the equilibrium of their collective thermochemical reactions.\n\nAGNI uses the inputted gas partial pressures (or mixing ratios) to calculate the atmosphere's metallicity. When the configuration variable composition.chemistry=true FastChem will be enabled. At each step of the solver loop, the metallicity and T-P profile will be provided to FastChem in order to calculate the atmospheric composition at each layer. This new composition is applied when calculating energy fluxes, emission spectra, etc.","category":"section"},{"location":"model/#Transparent-atmospheres","page":"Model description","title":"Transparent atmospheres","text":"It is useful to run AGNI with a transparent atmosphere in various scenarios. For example, in the calculation of reflectance or emission spectra of 'bare rock' planets. Or alternatively to determine a planet's surface temperature in the absence of an overlying atmosphere. AGNI incorporates this functionality through the configuration variable composition.transparent=true. This will set the atmosphere surface pressure to be small and disable the gas opacity, continuum opacity, and other absorption processes in SOCRATES.\n\nWhen this is enabled, make sure to use the \"transparent\" solver. The section below does not apply in this case, as there is only one variable (the surface temperature) to solve for - this is done using a Golden-Section search method.","category":"section"},{"location":"model/#Obtaining-a-solution","page":"Model description","title":"Obtaining a solution","text":"","category":"section"},{"location":"model/#Summary","page":"Model description","title":"Summary","text":"AGNI is designed for modelling planetary atmospheres with high surface pressures and temperatures. This means that the radiative timescale differs by several orders of magnitude across the column, which makes obtaining a solution difficult. To obtain a temperature structure solution that conserves energy more precisely than a time-stepping method, AGNI solves for the temperature structure of the atmosphere as an optimisation problem. This finds the state which conserves energy across all levels and satisfies the required configuration from the user.","category":"section"},{"location":"model/#Solution-types","page":"Model description","title":"Solution types","text":"It is necessary to tell AGNI what kind of atmospheric solution to solve for. There are currently a few options available set by the solution_type variable in the configuration file.\n\n(1) Aim to conserve energy fluxes throughout the column. The surface temperature is fixed.\n(2) Aim to conserve energy fluxes throughout the column. The surface temperature is set by energy transport through a solid conductive boundary layer of thickness d such that T_s = T_m - fracFdk, where T_m is the mantle temperature and k is the thermal conductivity.\n(3) Solve for a state such that the flux carried at each level is equal to F_textint = sigma T_textint^4, representing the rate at which a planet is losing energy into space.\n\nSolution type (1) enforces a fixed surface temperature and instellation, allowing all other temperatures and F_textint to be solved-for as dependent variables. This could be used to model a young planet far from 'radiative equilibrium' (or 'global energy balance') where its surface temperature is very large and the outgoing energy flux is non-zero.\n\nSolution type (2) is appropriate for coupling with magma ocean model, where a conductive skin of solidified rock forms at the atmosphere-mantle interface. This skin is a kind of boundary layer that must be parameterised as having a particular thickness and thermal conductivity. It's thought that these layers are important for regulating the energy budget of young rocky planets. This is similar to type (1) except that T_s is allowed to change and T_m is fixed.\n\nSolution type (3) is comparable to the implementation inside other atmosphere climate models: the surface temperature is free to change along with the rest of the atmosphere, and AGNI solves for a state of radiative equilibrium.","category":"section"},{"location":"model/#Construction","page":"Model description","title":"Construction","text":"The atmosphere is constructed of N levels (cell-centres), corresponding to N+1 interfaces (cell-edges). The RT model takes cell-centre temperatures T_i, pressures p_i, geometric heights, and mixing ratios as input variables at each level i, as well as the surface temperature and incoming stellar flux. In return, it provides cell-edges spectral fluxes F_i at all N+1 interfaces for LW & SW components and upward & downward streams. Convective fluxes can be estimated using the MLT scheme, condensation fluxes from the condensation scheme, and sensible heat from a simple turbulent kinetic energy (TKE) approximation (see Pierrehumbert+2010).\n\nThe total upward-directed energy flux F_i describes the total upward-directed energy transport (units of textW m^-2) from cell i into cell i-1 above (or into space for i=1). For energy to be conserved throughout the column, it must be true that F_i = F_t text  forall text  i where F_t is the total amount of energy being transported out of the planet. In global radiative equilibrium, F_t = 0.","category":"section"},{"location":"model/#Definition-of-residuals","page":"Model description","title":"Definition of residuals","text":"We can use this construction to solve for the temperature profile of the atmosphere as an N+1-dimensional optimisation problem. This directly solves for T(p) at radiative-convective equilibrium without having to invoke heating rate calculations, thereby avoiding slow convergence in regions of the atmosphere with long radiative timescales. The residuals vector (length N+1)\n\n\nbmr =\n\nbeginpmatrix\nr_i     \nr_i+1 \n     \nr_N     \nr_N+1\nendpmatrix\n\n=\n\nbeginpmatrix\nF_i+1 - F_i     \nF_i+2 - F_i+1 \n     \nF_N+1 - F_N     \nF_N+1 - F_t\nendpmatrix\n\nis what we aim to minimise as our 'objective function', subject to the solution vector of cell-centre temperatures\n\nbmx =\n\nbeginpmatrix\nT_i     \nT_i+1 \n     \nT_N     \nT_s\nendpmatrix\n\nwhere T_s is the surface temperature. Cell-edge temperatures in the bulk atmosphere are interpolated from cell-centres. The bottom- and top-most cell edge temperatures are extrapolated by estimation of dTd log p. Cell properties (heat capacity, gravity, density, average molecular weight, etc.) are consistently updated at each evaluation of bmr. Condensation/rainout are also handled at each evaluation of bmr in order to avoid supersaturation.\n\nThe model converges when the cost function c(bmx) = sqrtsum_i r_i satisfies the condition\n\nc(bmx)  c_a + c_r cdot undersetimax text  F_i\n\nwhich represents a state where the fluxes are sufficiently conserved. The quantities c_a and c_r are the absolute and relative tolerances provided by the user (parameters conv_atol and conv_rtol in solver.solve_energy!()).","category":"section"},{"location":"model/#Iterative-steps","page":"Model description","title":"Iterative steps","text":"The model solves for bmx iteratively, starting from some initial guess. The initial guess should be any reasonable temperature profile which is not significantly cooler than the expected solution. The flowchart below broadly outlines the solution process.\n\n  <img src=\"assets/model_flowchart.svg\" width=50% class=\"center\"/>\n\nThe Jacobian matrix bmJ represents the directional gradient of the residuals with respect to the solution vector. It is a square matrix with elements set according to\n\nJ_uv = fracpartial r_upartial x_v\n\nAGNI estimates bmJ using finite-differences, requiring N+1 evalulations of bmr in order to fill the matrix. This corresponds to 2(N+1)+1 objective function calculations under a 2nd order central-difference scheme. Each level v with temperature x_v is perturbed by an amount pm varepsilon x_v in order to fill a single column of bmJ. As such, it can be expensive to construct a full Jacobian, especially when it is discarded at the end of each iteration. To reduce the total number of calculations, AGNI retains some of the columns in bmJ between model iterations. This assumes that the second derivative of the residuals is small. A column v is retained only when\n\nmax r_i lt 07 text for  i in v-1 v v+1\n\nand when c(bmx)10 does not satisfy the convergence criteria.\n\nWith a Jacobian constructed, we can calculate an update bmd to the solution vector bmx rightarrow bmx + bmd. This is primarily done via the Newton-Raphson method\n\nbmd = -bmJ^-1 bmr\n\nbut can alternatively be performed via the Gauss-Newton and Levenberg–Marquardt methods.\n\nIt is possible for the model to become stuck in a local minimum, leading to very small values of bmd. This is identified when c(bmx) has seen little change over the last few iterations. When this occurs, the model is 'nudged' by scaling the update via\n\nbmd rightarrow 3 bmd\n\nIn many cases bmd is too large, leading to instabilities. This is due to the non-convexity of the solution space, and the somewhat discontinuous nature of the physics involved (particularly in its temperature derivatives). When bmdd_textmax, the update is crudely scaled via\n\nbmd rightarrow  d_textmax hatbmd\n\nThe update may also be scaled by a linesearch\n\nbmd rightarrow alpha bmd\n\non alpha. This is applied if the full step bmd would increase the cost by an unacceptable amount. If the model is close to convergence then a golden-section search method is used to determine the optimal alpha, otherwise a backtracking method is used.  This means that the model is (mostly) able to avoid oscillating around a solution. All three of these scalings to bmd preserve its direction.","category":"section"},{"location":"model/#Other-features","page":"Model description","title":"Other features","text":"AGNI can calculate emission spectra, provided with T(p) and the volume mixing ratios of the gases. This is performed using the same RT as the RCE calculations, so is limited in resolution by the choice of correlated-k bands. Similarly, the longwave contribution function can also be calculated.","category":"section"},{"location":"model/#Julia-and-Fortran","page":"Model description","title":"Julia and Fortran","text":"AGNI is primarily written in Julia, while SOCRATES itself is written in Fortran. Julia was chosen because it allows the SOCRATES binaries to be included in the precompiled code, which significantly improves performance.","category":"section"},{"location":"usage/#Using-the-model","page":"Using the model","title":"Using the model","text":"Follow the Getting started instructions. Only read on once you have confirmed that the model runs on your machine. Otherwise, see the Troubleshooting guide.","category":"section"},{"location":"usage/#Input-data-files","page":"Using the model","title":"Input data files","text":"The minimal input data required to run the model will have been downloaded automatically from Zenodo. If you require more data, such as additional stellar spectra or opacities, then these can also be easily obtained using the get_data script in the AGNI root directory. To see how to use this script, run it without arguments like so:\n\n./src/get_data.sh\n\nOpacities are contained within \"spectral files\". Use the table within res/spectral_files/reference.pdf to decide which spectral files are best for you.\n\nFor example, if you wanted to get the spectral file \"Honeyside48\" you would run:\n\n./src/get_data.sh anyspec Honeyside 48","category":"section"},{"location":"usage/#Tutorials","page":"Using the model","title":"Tutorials","text":"There are Jupyter notebooks containing tutorials in the tutorials/ directory of the repository.","category":"section"},{"location":"usage/#General-execution","page":"Using the model","title":"General execution","text":"The environment variable RAD_DIR must point to the SOCRATES installation directory. This is required for AGNI to find the SOCRATES libraries. The best way to do this is to add RAD_DIR=path/to/socrates/folder/ to your shell rc file (e.g. ~/.bashrc).\n\nThen to use the model, simply run\n\n./agni.jl [cfg]\n\nwhere [cfg] is the path to the desired configuration file. If [cfg] is not passed, then the default configuration file will be used.\n\nYou should see the following output:\n\n[ INFO  ] Using configuration 'Default'\n[ INFO  ] Setting-up a new atmosphere struct\n[ INFO  ] Loading thermodyamic data\n[ INFO  ] Inserting stellar spectrum and Rayleigh coefficients\n[ INFO  ] Allocating atmosphere with composition:\n[ INFO  ]       1 H2O     1.00e+00 (EOS_AQUA)\n[ INFO  ] Setting T(p): dry, sat\n[ INFO  ] Solving with 'none'\n[ INFO  ]     done\n[ INFO  ] Total RT evalulations: 2\n[ INFO  ] Writing results\n[ INFO  ] Plotting results\n[ INFO  ] Deallocating memory\n[ INFO  ] Model runtime: 16.60 seconds\n\nThe line following \"Allocating atmosphere with composition\" is a table of gases, their volume mixing ratios, and flags. In this case there is only one gas.\n\nPotential flags for each species are:\n\nEOS_[XX] - using the [XX] equation of state (e.g. ideal gas, AQUA)\nNO_OPACITY - no opacity data available, but can contribute to the thermodynamics\nNO_THERMO - no thermodynamic data available, so will be treated as a diatomic ideal gas\nCOND - this gas is allowed to condense","category":"section"},{"location":"usage/#Solver-flags","page":"Using the model","title":"Solver flags","text":"During each step of the iteration, AGNI will flag the solver status to indicate what was done and if any problems arose. These flags are separated by a hyphen (-).\n\nPotential solver flags are:\n\nCs or Cf - chemistry and condensation schemes either (s)ucceeded or (f)ailed\nGg - radiative transfer performed with double-grey scheme\nM or Mr  - convective fluxes are being modulated for stability\nC2 or C4 or F2 or F4- a central or forward finite-difference scheme was used (at 2nd or 4th order)\nLs - a linesearch method was applied\nP - step was forcibly extrapolated because the solver is not making good progress\nU - the atmosphere has become gravitationally unbound","category":"section"},{"location":"usage/#Grids-of-models-parallelised-with-multiple-processes","page":"Using the model","title":"Grids of models parallelised with multiple processes","text":"The code is not explicitly parallelised. However, there is functionality to run a grid of models using by the script located at misc/grid/worker.jl. This script operates a single worker (of potentially many). All parameter configuration should be done by editing the worker.jl file directly.\n\nFor example, to run worker ID=1 and allocate two workers to the whole grid:\n\njulia --project=. misc/grid/worker.jl 1 2\n\nBy allocating multiple workers and running them simultaneously using the manager script, which is located at misc/grid/manager.jl, we can parallelise the simulations. The number of workers is defined by the number of threads with which the manager script is run.\n\nFor example, run this manager script with four threads (and thus have four workers):\n\njulia -t4 misc/grid/manager.jl\n\nThe manager script can also be executed on a HPC cluster by using the Slurm workload manager - assuming it is available on your server. You should then define the number of workers (and the allotted time) inside slurm.sh by setting cpus-per-task=XX.\n\nFor example:\n\nsbatch --export=ALL misc/grid/slurm.sh\n\nOnce finished, combine the results of these workers by using the consolidate.jl script. This will generate consolidated_* files (2 CSV, 1 NetCDF) in the root folder of the grid.\n\nFor example, assuming that the grid root is located at the path out/:\n\njulia misc/grid/consolidate.jl out/","category":"section"},{"location":"usage/#Configuration","page":"Using the model","title":"Configuration","text":"AGNI configuration files are formatted using TOML. There are examples in res/config/. The default configuration file contains comments explaining the purpose of each parameter, although some are explained in greater detail below. Take care to format the variables in the TOML file correctly. There are no 'default values'. Not all parameters are required in all cases, but the model will return an error naming any parameters which are both necessary and absent.\n\nThe configuration files are broken up into four sections (or \"tables\"), each containing a number of parameters. These tables of parameters are described below.","category":"section"},{"location":"usage/#[planet]","page":"Using the model","title":"[planet]","text":"General properties of the planet.\n\nParameter Description\ntmp_surf Temperature of the surface [kelvin].\ninstellation Stellar flux at planet's orbital distance [W m-2].\nalbedo_b A pseudo bond-albedo which downscales the stellar flux by 1-albedo_b.\ns0_fact Stellar flux scale factor which accounts for planetary rotation (c.f. Cronin+13).\nzenith_angle Characteristic zenith angle for incoming stellar radiation [degrees].\nsurface_material Surface material (can be \"greybody\" or path to data file in res/).\nalbedo_s Spectrally-grey surface albedo used when material=greybody. Optional otherwise.\nradius Radius of the planet's surface [m].\ngravity Gravitational acceleration at the surface [m s-2]. Incompatible with mass option.\nmass Total mass of material below the atmosphere [kg]. Incompatible with gravity option.\nskin_d Thickness of the conductive boundary layer [m]. Used when solution_type=2.\nskin_k Conductivity of the conductive boundary layer [W m-1 K-1]. Used when solution_type=2.\ntmp_magma Temperature of the topmost layer of the planet's mantle [K]. Used when solution_type=2.\nflux_int Internal flux [W m-2] to be solved-for when solution_type=3.\nroughness Surface roughness length scale [m]\nwind_speed Effective wind speed for sensible heat transport [m s-1].\nstar_Teff Stellar photospheric temperature [K] used if files.input_star==\"blackbody\".","category":"section"},{"location":"usage/#[files]","page":"Using the model","title":"[files]","text":"Input/output files and other paths.\n\nParameter Description\ninput_sf Path to the desired spectral file in res/spectral_files/. If \"greygas\", uses double-grey RT scheme.\ninput_star Path to stellar spectrum. If blank, spectrum assumed to be inside spectral file. If \"blackbody\" must provide planet.star_Teff.\noutput_dir Path to the output directory.\nrfm_parfile Path to .par linelist file, for running line-by-line calculations with the RFM.","category":"section"},{"location":"usage/#[composition]","page":"Using the model","title":"[composition]","text":"Atmospheric composition and chemistry. There are three main ways to set the composition: partial pressures (p_dict), mixing ratios (vmr_dict or vmr_file), or by metallicities (metallicities).\n\nParameter Description\np_top Total top-of-atmosphere pressure [bar].\np_dict Dictionary of gas partial surface pressures [bar]. Summed to obtain p_surf.\np_surf Total surface pressure [bar]. Incompatible with p_dict.\nvmr_dict Gas volume mixing ratios (=mole fractions) at the surface. Must also set p_surf.\nvmr_file Path to a file containing mixing ratio profiles.  Must also set p_surf.\nmetallicities Dictionary of elemental mass abundance ratios relative to hydrogen. Must also set p_surf.\ncondensates List of volatiles which are allowed to condense. Incompatible with chemistry > 0.\ntransparent Make the atmosphere transparent (see below). Replaces all of the above parameters in this table.","category":"section"},{"location":"usage/#[execution]","page":"Using the model","title":"[execution]","text":"Parameters that tell the model what to do.\n\nParameter Description\nclean_output Clean old files from the output folder at model startup (true/false).\nverbosity Logging verbosity (0: quiet, 1: normal, 2: extra logging)\nmax_steps Maximum number of steps the solver should take before giving up (typically <200).\nmax_runtime Maximum wall-clock runtime [s] before giving up.\nnum_levels Number of model levels. Typically ~50, and ideally less than 100.\nconverge_atol Convergence criterion, absolute amount of energy flux lost [W m-2].\nconverge_rtol Convergence criterion, relative amount of energy flux lost [dimensionless].\ninitial_state Ordered list of requests describing the initial state of the atmosphere (see below).\nsolution_type Solution type (see below).\nsolver Solver to use (see below).\ndx_max Maximum step size [kelvin] allowed to be taken by the solver during each step.\nlinesearch Linesearch method to be used (0: None, 1: Golden section, 2: Backtracking)\neasy_start Initially scale energy fluxes, to help with stability if the model is struggling.\ngrey_start Initially solve with double-grey RT scheme, to help with stability if the model is struggling.\nperturb_all Perturb all rows of jacobian matrix at each solver iteration? True=stable, False=fast.\nrfm_wn_min Line-by-line RFM radiative transfer, minimum wavenumber [cm-1]\nrfm_wn_max Line-by-line RFM radiative transfer, maximum wavenumber [cm-1]","category":"section"},{"location":"usage/#[physics]","page":"Using the model","title":"[physics]","text":"Parameters that describe how the model should treat the physics.\n\nParameter Description\nchemistry Include 1D equilibrium chemistry in the atmosphere (true/false)\ncontinua Include collisional/continuum absorption in radiative transfer (true/false)\nrayleigh Include Rayleigh scattering in radiative transfer (true/false)\ncloud Include cloud scattering and opacity in radiative transfer (true/false)\noverlap_method Method for treating overlapping gas opacities within a given spectral band (see below)\ngrey_lw Grey opacity [m2/kg] of longwave (thermal) radiation. Used when input_sf=\"greygas\"\ngrey_sw Grey opacity [m2/kg] of shortwave (stellar) radiation. Used when input_sf=\"greygas\"\nreal_gas Use real-gas equation(s) of state where possible (true/false)\nthermo_funct Use temperature-dependent thermodynamic properties (true/false)\nsensible_heat Include turbulent sensible heat transport at the surface (true/false)\nadvection Include advective heat transport into each cell (true/false)\nconvection Include vertical heat transport associated with convection (true/false)\nconvection_crit Criterion for convective stability. Options: (s)chwarzschild, (l)edoux\nlatent_heat Include vertical heat transport from condensation and evaporation (true/false)\nrainout Enable condensation and evaporation of condensables aloft. Required for latent_heat=true.\noceans Enable condensation and evaporation of condensables at the surface.","category":"section"},{"location":"usage/#[plots]","page":"Using the model","title":"[plots]","text":"Configure plotting routines all of these should be true or false.\n\nParameter Description\nat_runtime Make some plots at runtime?\ntemperature Plot temperature-pressure profile?\nfluxes Plot energy flux profiles?\ncontribution Plot spectral contribution function?\nemission Plot outgoing emission spectrum?\nalbedo Plot spectral albedo? This is the ratio of upward:downward SW fluxes\nmixing_ratios Plot mixing ratio profiles?\nheight Plot radius-pressure profile?\nanimate Make an animation of the solver obtaining its solution?\ncloud Plot water cloud mass fraction and area fraction profiles?","category":"section"},{"location":"usage/#Details-on-specific-parameters","page":"Using the model","title":"Details on specific parameters","text":"composition.transparent configures the atmosphere to be transparent. This works by setting the pressure to be small, and turning off the gas opacity. With this provided, the rest of the parameters in [configuration] are redundant. With this enabled, make sure to use the appropriate solver in the [execution] table.\nexecution.solution_type tells the model which state to solve for. The allowed values (integers) are...\n1 : zero flux divergence at fixed tmp_surf\n2 : zero flux divergence such that the conductive skin (CBL) conserves energy flux with fixed tmp_magma\n3 : the net flux (up minus down) at each layer is equal to flux_int\nSee the Model description page for an explanation of these solution types.\nexecution.solver tells the model which solver to use. Allowed solvers are...\n[empty string] : no solving takes place, so the model just calculates fluxes using the initial state\nnewton : the Newton-Raphson algorithm is used\ngauss  : the Gauss-Newton algorithm is used\nlevenberg : the Levenberg–Marquardt algorithm is used\ntransparent : solver to be used when composition.transparent=true.\nexecution.initial_state describes the initial temperature profile applied to the atmosphere. This is a list of strings which are applied in the given order, which allows the user to describe a specific state as required. The descriptors are listed below, some of which take a single argument that needs to immediately follow the descriptor in the list order.\ndry              : integrate the dry adiabatic lapse rate from the surface upwards\nstr,       tmp : apply an isothermal stratosphere at temperature tmp\niso,       tmp : set the whole atmosphere to be isothermal at temperature tmp\ncsv,       pth : set the temperature profile using the CSV file at the file path pth\nsat,       gas : apply Clausius-Clapeyron saturation curve for the gas gas\nncdf,      pth : load profile from the NetCDF file located at pth\nloglin,    tmp : log-linear profile between tmp_surf at the bottom and tmp at the top\nana              : use the Guillot (2010) analytical temperature solution\nFor example, setting initial_state = [\"dry\", \"sat\", \"H2O\", \"str\", \"180\"] will set T(p) to follow the dry adiabat from the surface, the water condensation curve above that, and then to be isothermal at 180 K until the top of the model. Provide tmp=\"Teq\" to have AGNI automatically substitute-in the planet's radiative equilibrium temperature here.\nphysics.chemistry enables a calculation of equilibrium thermochemistry in the atmosphere. This is handled externally by FastChem, so you must set the environment variable FC_DIR to point to the FastChem directory. More information on the chemistry is available on the Equilibrium chemistry page.\nphysics.overlap_method tells SOCRATES which algorithm to use to combine gas opacities. The spectral files contain k-tables for pure gases, and combining these coefficients can be done in several ways. See Amundsen+2017 for a nice comparison of overlap methods. Allowed options are...\n\"ee\"   : equivalent extinction (fastest)\n\"rorr\" : random overlap, with resorting and re-binning\n\"ro\"   : random overlap (most accurate, slowest)","category":"section"},{"location":"usage/#Accessing-AGNI-from-Python","page":"Using the model","title":"Accessing AGNI from Python","text":"It is possible to interact with AGNI from Python. This is best done with the juliacall package from PythonCall.jl.\n\nCoupling with Python is done via juliacall within the modular PROTEUS framework, which couples AGNI self-consistently to models of planetary interior evolution and volatile outgassing. You can see this implemented in agni.py within the PROTEUS source code.\n\nA skeleton example is given below:\n\n# Import juliacall\nfrom juliacall import Main as jl\n\n# Import AGNI\njl.seval(\"using Pkg\")\njl.Pkg.activate(AGNI_ROOT_DIR)  # <---- set AGNI_ROOT_DIR to your installation path\njl.seval(\"import AGNI\")\njl.AGNI.setup_logging(\"out.log\", 1)\n\n# Setup atmosphere\natmos = jl.AGNI.atmosphere.Atmos_t()\njl.AGNI.atmosphere.setup_b(atmos, ...)   # <--- complete function arguments as per docstring in `AGNI.atmosphere.setup!()`\n\n# Allocate atmosphere\njl.AGNI.atmosphere.allocate_b(atmos, STAR_SPECTRUM_FILE)   # <-- provide path to spectrum\n\n# Solve T(p)\njl.AGNI.solver.solve_energy_b(atmos)\n\n# Write results to a file\njl.AGNI.save.write_ncdf(atmos, \"out.nc\")","category":"section"},{"location":"usage/#Line-by-line-radiative-transfer","page":"Using the model","title":"Line-by-line radiative transfer","text":"Performed using the Reference Forward Model. You must provide a HITRAN-formatted .par file, setting the path via files.rfm_parfile. This parfile can contain absorption from multiple species, and can be obtained from hitran.org. Alternatively, get the parfiles stored on Zenodo using: ./src/get_data.sh parfiles.\n\nThen, you must also set the variables execution.rfm_wn_min and execution.rfm_wn_max. These two parameters specify the wavenumber [cm-1] range over which to perform the LbL calculations. The wavenumber resolution is set to 1 cm-1.\n\nResults are saved to the NetCDF file, alongside all the usual data, as rfm_wn and rfm_fl arrays.","category":"section"},{"location":"ecosystem/#Related-codes","page":"Related codes","title":"Related codes","text":"AGNI is a standalone piece of software designed to model planetary atmospheres. However, its development has always been in the context of the 'PROTEUS' planetary evolution framework, developed by the FormingWorlds Lab. PROTEUS simulates the coupled evolution of the atmospheres and interiors of rocky planets and exoplanets by connecting various codes together as 'modules'. In this manner, AGNI may be used as the atmosphere-climate module within PROTEUS, allowing and evolutionary solution to planetary evolution with realistic atmosphere modelling. PROTEUS accesses AGNI using the juliacall package from PythonCall.jl. There is more information on this in the 'Accessing-AGNI-from-Python' page of this documentation.\n\nOther components of the wider PROTEUS ecosystem may be found in the table below:\n\nCode Description Website\nPROTEUS Model coupling fwl-proteus.readthedocs.io\nJANUS Convective atmosphere fwl-janus.readthedocs.io\nMORS Stellar evolution fwl-mors.readthedocs.io\nZEPHYRUS Hydrodynamic escape fwl-zephyrus.readthedocs.io\nCALLIOPE Volatile outgassing fwl-calliope.readthedocs.io\nLovePy Mantle tidal heating github.com/nichollsh/lovepy\nVULCAN Chemical kinetics github.com/FormingWorlds/VULCAN\nZalmoxis Interior structure zalmoxis.readthedocs.io\nAragog Interior dynamics github.com/FormingWorlds/aragog\nSPIDER Interior dynamics github.com/djbower/spider","category":"section"},{"location":"contributing/#How-to-contribute-to-AGNI","page":"Contributing","title":"How to contribute to AGNI","text":"","category":"section"},{"location":"contributing/#Bug-reporting","page":"Contributing","title":"Bug reporting","text":"Ensure the bug was not already reported by searching on GitHub under Issues.\nIf you're unable to find an open issue addressing the problem, open a new one. Be sure to include a title and clear description, as much relevant information as possible, and a code sample or an executable test case demonstrating the expected behavior that is not occurring.\nFor more general information on submitting a bug report, visit this page.","category":"section"},{"location":"contributing/#Bug-fixing","page":"Contributing","title":"Bug fixing","text":"Open a new GitHub pull request (PR) with the patch.\nEnsure the PR description clearly describes the problem and solution. Include the relevant issue number if applicable.\nBefore submitting, please ensure your changes are consistent with the existing codebase. These can also be viewed in the development manual.","category":"section"},{"location":"contributing/#New-features","page":"Contributing","title":"New features","text":"Suggest your change on the issues page and start writing code.","category":"section"},{"location":"contributing/#Coding-style","page":"Contributing","title":"Coding style","text":"Indentation uses 4 spaces, no tabs.\nFunction names should be lowercase, with words separated by underscores .\nLines should aim to have a length of no more than 92 characters.\nAll functions should have docstrings, ideally with Arguments and Returns listed.\nMore comments are always better, even if they seem redundant.\nUse type hinting where possible.\nPrint statements should be made through the logger where possible.\nThe core package code should not contain global variables, except in the phys module.","category":"section"},{"location":"contributing/#Queries-and-questions","page":"Contributing","title":"Queries and questions","text":"Ask a question about how to use or contribute to AGNI, please use the discussions page or contact Harrison Nicholls directly.","category":"section"},{"location":"contributing/#Open-source","page":"Contributing","title":"Open source","text":"AGNI is free, libre, and open source software. I encourage your contributions and suggestions.\n\nThanks,   -Harrison","category":"section"},{"location":"manual/#Software-manual","page":"Software manual","title":"Software manual","text":"","category":"section"},{"location":"manual/#Contributing","page":"Software manual","title":"Contributing","text":"If you are interested in contributing to the model, please see the contributing page","category":"section"},{"location":"manual/#Code-reference-(API)","page":"Software manual","title":"Code reference (API)","text":"","category":"section"},{"location":"manual/#Atmosphere-initialisation-and-variables","page":"Software manual","title":"Atmosphere initialisation and variables","text":"Functions from atmosphere.jl.","category":"section"},{"location":"manual/#Energy-flux-calculations","page":"Software manual","title":"Energy flux calculations","text":"Functions from energy.jl.","category":"section"},{"location":"manual/#Chemistry-and-phase-change-calculations","page":"Software manual","title":"Chemistry and phase-change calculations","text":"Functions from chemistry.jl.","category":"section"},{"location":"manual/#Numerical-solvers","page":"Software manual","title":"Numerical solvers","text":"Functions from solver.jl.","category":"section"},{"location":"manual/#Plotting-functions-and-utilities","page":"Software manual","title":"Plotting functions and utilities","text":"Functions from plotting.jl.","category":"section"},{"location":"manual/#Physical-properties-and-constants","page":"Software manual","title":"Physical properties and constants","text":"Functions from phys.jl.","category":"section"},{"location":"manual/#File-I/O-modules","page":"Software manual","title":"File I/O modules","text":"Functions from save.jl and load.jl.","category":"section"},{"location":"manual/#AGNI.atmosphere","page":"Software manual","title":"AGNI.atmosphere","text":"Main atmosphere module for storing model data\n\nThis module primarily contains the Atmos_t struct which does most of the heavy lifting in AGNI. There are also functions for setting up and configuring the struct.\n\nAlso includes hydrostatic integrator and ways to estimate observable quantities.\n\n\n\n\n\n","category":"module"},{"location":"manual/#AGNI.atmosphere.allocate!-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.atmosphere.allocate!","text":"Allocate atmosphere arrays, prepare spectral files, and final steps.\n\nWill not modify spectral file if stellar_spectrum is an empty string. Will treat star as blackbody with photospheric effective temperature of stellar_Teff if the parameter stellar_spectrum has value of \"blackbody\".\n\nArguments:\n\natmos::Atmos_t             the atmosphere struct instance to be used.\nstellar_spectrum::String   path to stellar spectrum csv file\nstellar_Teff::Float64      star effective temperature if blackbody\ncheck_safe_gas::Bool       require that there be at least one 'safe' gas in the mix\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.calc_layer_props!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.calc_layer_props!","text":"Calculate properties within each layer of the atmosphere (e.g. density, mmw).\n\nFunction will return false if hydrostatic calculcation fails. This is usually when the atmosphere becomes unbound.\n\nArguments:     - atmos::Atmos_t          the atmosphere struct instance to be used.\n\nReturns:     - ok::Bool                function result is ok\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.calc_observed_rho!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.calc_observed_rho!","text":"Calculate observed radius and bulk density.\n\nThis is done at the layer probed in transmission, which is set to a fixed pressure.\n\nArguments:     - atmos::Atmos_t          the atmosphere struct instance to be used.\n\nReturns:     - transspec_rho::Float64  the bulk density observed in transmission\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.calc_profile_cpkc!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.calc_profile_cpkc!","text":"Calculate specific heat capacity and thermal conductivity for all layers.\n\nSpecific heat per unit mass: J K-1 kg-1. Thermal conductivity: W m-1 K-1.\n\nArguments:     - atmos::Atmos_t      the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.calc_profile_density!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.calc_profile_density!","text":"Calculate the mass-density for all layers.\n\nRequires temperature, pressure, mmw to be already have been set.\n\nArguments:     - atmos::Atmos_t      the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.calc_profile_mmw!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.calc_profile_mmw!","text":"Calculate mean molecular weight for all layers.\n\nMMW stored as kg/mol.\n\nArguments:     - atmos::Atmos_t      the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.calc_profile_radius!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.calc_profile_radius!","text":"Calculate radii, gravities, and masses for all layers.\n\nPerforms hydrostatic integration from the ground upwards. Requires density, temperature, pressure to have already been set.\n\nDoes not account for surface ocean height.\n\nArguments:\n\natmos::Atmos_t          the atmosphere struct instance to be used.\n\nReturns:\n\nbound::Bool             atmosphere is strongly bound by gravity\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.calc_single_cpkc!-Tuple{AGNI.atmosphere.Atmos_t, Int64}","page":"Software manual","title":"AGNI.atmosphere.calc_single_cpkc!","text":"Calculate specific heat capacity and thermal conductivity of a single layer.\n\nSpecific heat per unit mass: J K-1 kg-1. Thermal conductivity: W m-1 K-1.\n\nArguments:     - atmos::Atmos_t      the atmosphere struct instance to be used.     - idx::Int            index of the layer\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.calc_single_density!-Tuple{AGNI.atmosphere.Atmos_t, Int64}","page":"Software manual","title":"AGNI.atmosphere.calc_single_density!","text":"Calculate the mass-density of a single layer.\n\nRequires temperature, pressure, mmw to be already have been set.\n\nArguments:\n\natmos::Atmos_t      the atmosphere struct instance to be used.\nidx::Int            index of the layer\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.estimate_Ra!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.estimate_Ra!","text":"Estimate a diagnostic Rayleigh number in each layer.\n\nAssuming that the Rayleigh number scales like Ra ~ (wλ/κ)^(1/β) Where κ is the thermal diffusivity and β is the convective beta parameter.\n\nThis quantity must be taken lightly.\n\nArguments:\n\natmos::Atmos_t      the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.estimate_convective_zone-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.estimate_convective_zone","text":"Get pressure at top and bottom of convective zone\n\nArguments:     - atmos::Atmos_t          the atmosphere struct instance to be used.\n\nReturns:     - p_top::Float64          pressure [Pa] at top of convective zone     - p_bot::Float64          pressure [Pa] at bottom of convective zone\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.estimate_photosphere!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.estimate_photosphere!","text":"Estimate photosphere.\n\nEstimates the location of the photosphere by finding the median of the contribution function in each band (0.2 um to 150 um), and then finding the pressure level at which these median values are maximised.\n\nArguments:     - atmos::Atmos_t          the atmosphere struct instance to be used.\n\nReturns:     - p_ref::Float64          pressure level of photosphere [Pa]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.estimate_timescale_conv!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.estimate_timescale_conv!","text":"Estimate a diagnostic convective timescale in each layer.\n\nThis quantity must be taken lightly.\n\nArguments:\n\natmos::Atmos_t      the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.estimate_timescale_rad!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.estimate_timescale_rad!","text":"Estimate a diagnostic radiative timescale in each layer.\n\nThis quantity must be taken lightly.\n\nArguments:\n\natmos::Atmos_t      the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.generate_pgrid!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.generate_pgrid!","text":"Generate pressure grid.\n\nAlmost equally log-spaced between pboa and pboa. The near-boundary layers are smaller than they would be on an equally log-spaced grid, to avoid numerics.\n\nArguments:\n\natmos::Atmos_t              the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.get_interleaved_ptr-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.get_interleaved_ptr","text":"Get interleaved cell-centre and cell-edge PTR grid.\n\nArguments:\n\natmos::Atmos_t      the atmosphere struct instance to be used.\n\nReturns:\n\narr_P::Array        pressure array [Pa]\narr_T::Array        temperature array [K]\narr_R::Array        radius array [m]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.integ_hydrograv-Tuple{Float64, Float64, Float64, Float64, Float64, Float64, Int64}","page":"Software manual","title":"AGNI.atmosphere.integ_hydrograv","text":"Integrate hydrostatic and gravity equations across a pressure interval.\n\nUses the classic fourth-order Runge-Kutta method.\n\nArguments:\n\nr0::Float64     radius   at start of interval [m]\ng0::Float64     gravity  at start of interval [m s-2]\nm0::Float64     mass enc at start of interval [kg]\np0::Float64     pressure at start of interval [Pa]\np1::Float64     pressure at end   of interval [Pa]\nrho::Float64    density throughout interval, constant [kg m-3]\nn::Int          number of steps for integration (n >= 2)\n\nReturns:\n\nrj::Float64     radius   at end of interval [m]\ngj::Float64     gravity  at end of interval [kg]\nmj::Float64     mass enc at end of interval [kg]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.make_transparent!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.make_transparent!","text":"Set atmosphere properties such that it is effectively transparent.\n\nThis will modify the surface pressure and disable gas opacity in SOCRATES. These changes cannot be reversed directly. To undo them, it is best to create and allocate a new atmosphere struct.\n\nArguments:\n\natmos::Atmos_t          the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.set_tmpl_from_tmp!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.atmosphere.set_tmpl_from_tmp!","text":"Set cell-edge temperatures from cell-centre values.\n\nUses interpolation within the bulk of the column and extrapolation for the topmost edge.\n\nArguments:\n\natmos::Atmos_t            the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.atmosphere.setup!-Tuple{AGNI.atmosphere.Atmos_t, String, String, String, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Int64, Float64, Float64, Any, String}","page":"Software manual","title":"AGNI.atmosphere.setup!","text":"Set parameters of the atmosphere.\n\nThis is used to set up the struct immediately after creation. It must be     done before allocate!() is called, and before any RT calculcations     are performed.\n\nArguments:\n\natmos::Atmos_t                  the atmosphere struct instance to be used.\nROOT_DIR::String                AGNI root directory.\nOUT_DIR::String                 Output directory.\nspfile::String                  path to spectral file ('grey' => use grey gas)\ninstellation::Float64           bolometric solar flux at the top of the atmosphere [W m-2]\ns0_fact::Float64                scale factor to account for planetary rotation (i.e. S0^*/S0 in Cronin+14)\nalbedo_b::Float64               bond albedo scale factor applied to instellation in order to imitate shortwave reflection\nzenith_degrees::Float64         angle of radiation from the star, relative to the zenith [degrees].\ntmp_surf::Float64               effective surface temperature to provide upward longwave flux at the bottom of the atmosphere [K].\ngravity::Float64                gravitational acceleration at the surface [m s-2].\nradius::Float64                 planet radius at the surface [m].\nnlev_centre::Int                number of model levels.\np_surf::Float64                 total surface pressure [bar].\np_top::Float64                  total top of atmosphere pressure [bar].\nmf_dict::Dict                   dictionary of VMRs in the format (key,value)=(gas,mf).\nmf_path::String                 path to file containing VMRs at each level.\n\nOptional arguments:\n\nIO_DIR::String                  directory used for fast file operations.\ncondensates                     list of condensates (gas names).\nmetallicities::Dict             dictionary of elemental metallicities (mass ratio rel to hydrogen)\nsurface_material::String        surface material (default is \"greybody\", but can point to file instead).\nalbedo_s::Float64               grey surface albedo used when surface_material=\"greybody\".\ntmp_floor::Float64              temperature floor [K].\nsurf_roughness::Float64         surface roughness length scale [m]\nsurf_windspeed::Float64         surface wind speed [m s-1].\nKzz_floor::Float64              min eddy diffusion coefficient, cgs units [cm2 s-1]\nmlt_asymptotic::Bool            mixing length scales asymptotically, but ~0 near ground\nmlt_criterion::Char             MLT stability criterion. Options: (s)chwarzschild, (l)edoux.\ntmp_magma::Float64              mantle temperature [K] for sol_type==2.\nskin_d::Float64                 skin thickness [m].\nskin_k::Float64                 skin thermal conductivity [W m-1 K-1].\noverlap_method::String          gaseous overlap scheme (ro: rand overlap, ee: equiv extinct, rorr: ro+resort+rebin).\ntarget_olr::Float64             target OLR [W m-2] for sol_type==4.\nflux_int::Float64               planet's internal flux for sol_type==3.\nall_channels::Bool              use all channels available for RT?\nflag_rayleigh::Bool             include rayleigh scattering?\nflag_gcontinuum::Bool           include generalised continuum absorption?\nflag_continuum::Bool            include continuum absorption?\nflag_aerosol::Bool              include aersols?\nflag_cloud::Bool                include clouds?\nphs_timescale::Float64          phase change timescale [s]\nevap_efficiency::Float64        re-evaporatione efficiency compared to saturating amount\nreal_gas::Bool                  use real gas EOS where possible\nthermo_functions::Bool          use temperature-dependent thermodynamic properties\nuse_all_gases::Bool             store information on all supported gases, incl those not provided in cfg\ncheck_integrity::Bool           confirm integrity of thermo files using their checksum\nκ_grey_lw::Float64              gas opacity when using grey-gas RT scheme, longwave\nκ_grey_sw::Float64              gas opacity when using grey-gas RT scheme, shortwave\nfastchem_work::String           working directory for fastchem\nfastchem_floor::Float64         temperature floor on profile provided to fastchem\nfastchem_maxiter_chem::Float64  maximum chemical iterations allowed by fastchem\nfastchem_maxiter_solv:Float64   maximum solver iterations allowed by fastchem\nfastchem_xtol_chem::Float64     solution tolerance required of fastchem (chemical)\nfastchem_xtol_elem::Float64     solution tolerance required of fastchem (elemental)\nrfm_parfile::String             path to HITRAN-formatted .par file provided to RFM\n\nReturns:     Nothing\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy._radtrans_greygas!-Tuple{Any}","page":"Software manual","title":"AGNI.energy._radtrans_greygas!","text":"Solve RT using double grey-gas formulation\n\nSimple two-stream double grey RT solver which integrates fluxes from the TOA and BOA.\n\nUses two opacity values to represent the LW and SW components of the flux field.\n\nLoosely following this tutorial, which is based on Pierrehumbert (2010). https://brian-rose.github.io/ClimateLaboratoryBook/courseware/radiative-transfer/\n\nArguments:\n\natmos::Atmos_t                  the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy._radtrans_socrates!-Tuple{AGNI.atmosphere.Atmos_t, Bool}","page":"Software manual","title":"AGNI.energy._radtrans_socrates!","text":"Solve radiative transfer using SOCRATES\n\nImports SOCRATES wrapper from the atmosphere module, rather than loading it twice.\n\nArguments:\n\natmos::Atmos_t          the atmosphere struct instance to be used.\nlw::Bool                True: longwave calculation. False: shortwave calculation.\n\nOptional arguments:\n\ncalc_cf::Bool           also calculate contribution function?\ngauss_ir::Bool          using gaussian angular integration in IR, otherwise uses two-stream approximation\nrescale_pf::Bool        perform rescaling on phase function\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy.calc_fluxes!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.energy.calc_fluxes!","text":"Calculate energy flux at each level.\n\nCalculates flux components (radtrans, convection, etc.) and sums them to get total flux. Also updates thermodynamic properties (heat capacity, density, etc.) at each layer.\n\nAssumes that chemistry functions have already been called, if wanted. Does not call fastchem here.\n\nArguments:\n\natmos::Atmos_t                  the atmosphere struct instance to be used.\n\nOptional arguments:\n\nradiative::Bool                 include radiation fluxes\nlatent_heat::Bool               include condensation flux\nconvective::Bool                include MLT convection flux\nsens_heat::Bool                 include TKE sensible heat flux\nconductive::Bool                include conductive heat flux\nadvective::Bool                 include advective heat flux\nconvect_sf::Float64             scale factor applied to convection fluxes\nlatent_sf::Float64              scale factor applied to phase change fluxes\ncalc_cf::Bool                   calculate LW contribution function?\n\nReturns:\n\nok::Bool                        calculation performed ok?\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy.calc_hrates!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.energy.calc_hrates!","text":"Calculate heating rates at cell-centres from the total flux.\n\nRequires the total flux to have already been set (atmos.flux_tot). Heating rates are calculated in units of kelvin per day.\n\nArguments:\n\natmos::Atmos_t                  the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy.conduct!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.energy.conduct!","text":"Calculate conductive heat fluxes using Fourier's law\n\nUpdates array of atmos.flux_cdct at each layer of the atmosphere.\n\nArguments:\n\natmos::Atmos_t          the atmosphere struct instance to be used\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy.convection!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.energy.convection!","text":"Calculate dry convective fluxes using mixing length theory.\n\nConvective energy transport fluxes are calculated at every level edge, just like the radiative fluxes. This is not compatible with moist convection. By using MLT to parameterise convection, we can also calculate Kzz directly.\n\nUses the mixing length formulation outlined by Joyce & Tayar (2023), which was also implemented in Lee et al. (2024), and also partially outlined in the review by Robinson & Marley (2014). https://arxiv.org/abs/2303.09596 https://doi.org/10.1093/mnras/stae537 https://ui.adsabs.harvard.edu/abs/1962JGR....67.3095B/abstract\n\nThe adiabatic lapse rate is formulated as:     ∇_ad = dln(T)/dln(P) = (P/T)*(dT/dP) = (P/T)*(1/[ρ c_p]) for an ideal gas, this becomes:     ∇_ad = R / (μ c_p)\n\nThe mixing length is set to asymptotically approach H (for z>>H) or z (for z<H) as per Blackadar (1962). Alternatively, it can be set equal to H. https://doi.org/10.1029/JZ067i008p03095\n\nThe scale height is formulated as:     Hp = P / (ρ g) Where ρ is obtained from the equation of state.\n\nTo account for convective stability due to compositional gradients, we can use the Ledoux criterion rather than the Schwarzschild criterion. This is described nicely in Gabriel et al. (2014), as well as Salaris & Cassisi (2017). http://dx.doi.org/10.1051/0004-6361/201423442 https://doi.org/10.1098/rsos.170192\n\nIn the ideal gas regime, the Ledoux criterion can be simply written as:     ∇_ld = ∇_ad + dln(μ)/dln(P) Using Equation (10) of Gabriel+14. Taking β=Pg/P=1 means the gas pressure equals the total pressure, neglecting pressure contributions from ions and electrons.\n\nArguments:\n\natmos::Atmos_t          the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy.eval_exchange_coeff-Tuple{Float64, Float64}","page":"Software manual","title":"AGNI.energy.eval_exchange_coeff","text":"Calculate turbulent kinetic energy (TKE) exchange coefficient.\n\nBased on Monin–Obukhov similarity theory, from roughness length scale. See eq 9 in Nicholson & Benn (2009). Added small epsilon-factor to avoid function blowing-up around regime where height ≈ roughness.\n\nArguments:\n\nheight::Float64     Height above surface [m]\nroughness::Float64  Roughness length scale [m]\n\nReturns:\n\nC_d::Float64        TKE exchange coefficient [dimensionless]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy.fill_Kzz!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.energy.fill_Kzz!","text":"Fill Kzz values for the entire profile.\n\nThis function is called after the convection scheme has been run.\n\nThe Kzz value in the convective region (and below) are set equal to the maximum value in the convective region, as calculated by MLT. The value increases with power-law scaling with pressure in the stratosphere.\n\nArguments:\n\natmos::Atmos_t          the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy.latent!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.energy.latent!","text":"Analytical diffusion scheme for condensation and evaporation energy.\n\nUpdates fluxes. Requires chemistry.rainout_and_evaporate to be called first.\n\nIntegrates from bottom of model upwards. Based on the amount of phase change at each level, a phase change flux is calculated by assuming a fixed condensation timescale.\n\nIf evaporation is enabled, then integrates from top downwards to determine flux from re-evaporation of droplets. Any droplets which reach the ground go towards forming an ocean.\n\nShould ideally perform a microphysical treatment; e.g. by following this paper: https://agupubs.onlinelibrary.wiley.com/doi/epdf/10.1029/2020JE006653\n\nArguments:\n\natmos::Atmos_t          the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy.make_finite!-Tuple{Any, Any}","page":"Software manual","title":"AGNI.energy.make_finite!","text":"Set non-finite values in an array equal to a given fill value.\n\nArguments:\n\narr      array potentially containing non-finite values\nfill     replacement value to fill with\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy.radtrans!-Tuple{AGNI.atmosphere.Atmos_t, Bool}","page":"Software manual","title":"AGNI.energy.radtrans!","text":"Calculate radiative fluxes using the desired scheme.\n\nUses the configuration inside the atmos struct. Can either do LW or SW calculation, set by lw function argument.\n\nArguments:\n\natmos::Atmos_t                  the atmosphere struct instance to be used.\nlw::Bool                        longwave calculation? Else: shortwave\ncalc_cf::Bool=false             also calculate contribution function?\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy.reset_fluxes!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.energy.reset_fluxes!","text":"Reset energy fluxes to zero.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy.sensible!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.energy.sensible!","text":"Calculate sensible heat flux from turbulent kinetic energy (TKE)\n\nUpdates the values of atmos.C_d and atmos.flux_sens.\n\nArguments:\n\natmos::Atmos_t          the atmosphere struct instance to be used\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.energy.skin_flux-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.energy.skin_flux","text":"Calculate flux carried by conductive skin.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.chemistry","page":"Software manual","title":"AGNI.chemistry","text":"This module handles chemistry, condensation, and evaporation.\n\nNote the important distinctions between the variables which store atmospheric composition.\n\ngas_ovmr stores VMRs inputted by the user, which are usually constant in height.\ngas_vmr stores the runtime gas volume mixing ratios, after all calculations are performed.\n\n\n\n\n\n","category":"module"},{"location":"manual/#AGNI.chemistry._chem_gas!-Tuple{AGNI.atmosphere.Atmos_t, Bool}","page":"Software manual","title":"AGNI.chemistry._chem_gas!","text":"Calculate gas-phase composition at dry thermochemical equilibrium.\n\nUses FastChem to calculate the gas composition at each level of the atmosphere. Volatiles are converted to bulk elemental abundances, which are then provided to FastChem alongside the temperature/pressure profile. FastChem is currently called as an executable, which is not optimal.\n\nArguments:\n\natmos::Atmos_t                  the atmosphere struct instance to be used.\nwrite_cfg::Bool                 write config and elements\n\nReturns:\n\nstate::Int                      fastchem state (0: success, 1: criticalfail, 2: elemfail, 3: convfail, 4: bothfail)\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.chemistry._sat_aloft!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.chemistry._sat_aloft!","text":"Handle sub/super-saturation aloft; required for latent heat flux calcaulation\n\nAdjust gas VMRs according to saturation and cold-trap requirements.\n\nVolatiles which are allowed to condense are rained-out at condensing levels until the gas is exactly saturated, not supersaturated. If evaporation is enabled here, it will lead to enhanced mixing ratios at deeper levels as rain is converted back into gas from a liquid state.\n\nAny rain that reaches the surface without being evaporated leads to ocean formation. Disabling evaporation will lead to unclosed energy budget when calculation of latent heat fluxes is performed.\n\nThis function can be called after the fastchem calculation.\n\nArguments:\n\natmos::Atmos_t          the atmosphere struct instance to be used.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.chemistry._sat_surf!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.chemistry._sat_surf!","text":"Handle sub/super-saturation at the surface, forming oceans.\n\nNOTE: this function does not reset to atmos to its original state before operating.\n\nIf a condensable is supersaturated at the surface, its partial surface pressure is reduced to exactly saturation. The condensed mass is added to the ocean reservoir. If a condensable is subsaturated at the surface, its partial pressure is increased to exactly saturation, subject to the amount of ocean available. Reduces or increases the total surface pressure accordingly.\n\nAccounts for mmw ratio when converting from partial pressures to masses:     mi = (pi/g) * (mui / mutot) where mi has units [kg/m^2] and mutot is the total mixture MMW.\n\nArguments:\n\natmos::Atmos_t          the atmosphere struct instance to be used.\n\nReturns:\n\nany_changed::Bool       did any component condense or evaporate?\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.chemistry.calc_composition!-Tuple{AGNI.atmosphere.Atmos_t, Bool, Bool, Bool}","page":"Software manual","title":"AGNI.chemistry.calc_composition!","text":"Run condensation and chemistry schemes as required.\n\nThis function is designed as a wrapper for appropriately handling these three schemes together in the correct order, so that variables are appropriately updated. Steps:\n\ncall _sat_surf! to handle saturation at the surface, and adjust the pressure grid\ncall _chem_gas! to handle gas-phase chemistry in the column\ncall _sat_aloft! to handle saturation aloft, above the surface.\n\nArguments:\n\natmos::Atmos_t       the atmosphere struct instance to be used.\ndo_surf::Bool        do saturation cond/evap at surface\ndo_chem::Bool        do thermochemistry in the column\ndo_aloft::Bool       do saturation cond/evap aloft\n\nReturns:\n\nstate::Int           fastchem state (0: success, 1: criticalfail, 2: elemfail, 3: convfail, 4: bothfail)\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.chemistry.normalise_vmrs!-Tuple{AGNI.atmosphere.Atmos_t, Int64}","page":"Software manual","title":"AGNI.chemistry.normalise_vmrs!","text":"Normalise gas VMRs, keeping condensates unchanged\n\nOnly acts on a single model level.\n\nParameters:\n\natmos::atmosphere.Atmos_t       atmosphere structure\ni::Int                          level index to normalise\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.chemistry.restore_composition!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.chemistry.restore_composition!","text":"Reset mixing ratios, pressures, and oceans to their original values\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.solver.gs_search-Tuple{Function, Float64, Float64, Float64, Float64, Int64}","page":"Software manual","title":"AGNI.solver.gs_search","text":"Golden section search algorithm\n\nMinimises a function f between the bounds a and b. The function f must return a positive scalar.\n\nArguments:\n\nf           Function to be minimised\na           Initial bracket, lower value\nb           Initial bracket, upper valuie\ndxtol       Convergence: exit when bracket is smaller than this size\natol        Convergence: absolute tolerance on minimum\nmax_steps   Maximum number of iterations\nwarnings    Print warning if search does not converge before max_steps` are taken.\n\nReturns:\n\nsol         Best solution found by search.\nsucc        Did search converge?\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.solver.solve_energy!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.solver.solve_energy!","text":"Obtain radiative-convective equilibrium using a matrix method.\n\nSolves the non-linear system of equations defined by the flux field divergence, minimising flux loss across a cell by iterating the temperature profile.\n\nArguments:\n\natmos::Atmos_t                  the atmosphere struct instance to be used.\n\nOptional physics arguments:\n\nsol_type::Int                   solution type, 1: tmpsurf | 2: skin | 3: fluxint | 4: tgt_olr\nchem::Bool                      include eqm thermochemistry when solving for RCE?\nconvect::Bool                   include convection\nsens_heat::Bool                 include sensible heating at the surface\nconduct::Bool                   include conductive heat transport within the atmosphere\nlatent::Bool                    include latent heat exchange (condensation/evaporation)\nadvect::Bool                    include advective heat exchange (dynamics)\nrainout::Bool                   allow rainout (phase change impacts mixing ratios, not just energy fluxes)\noceans::Bool                    check surface saturation (ocean formation)\n\nOptional solver arguments:\n\ndx_min::Float64                 minimum step size [K]\ndx_max::Float64                 maximum step size [K]\ntmp_pad::Float64                padding around hard limits on temperature floor & ceiling values\nmax_steps::Int                  maximum number of solver steps\nmax_runtime::Float64            maximum runtime in wall-clock seconds\nfdc::Bool                       finite difference: central difference? otherwise use forward difference\nfdo::Int                        finite difference: scheme order (2nd or 4th)\nmethod::Int                     numerical method (1: Newton-Raphson, 2: Gauss-Newton, 3: Levenberg-Marquardt)\neasy_start::Bool                improve convergence reliability; introduce convection and latent heat gradually\ngrey_start::Bool                improve convergence reliability; obtain double-grey solution first\nls_method::Int                  linesearch algorithm (0: None, 1: golden, 2: backtracking)\ndetect_plateau::Bool            assist solver when it is stuck in a region of small dF/dT\nperturb_all::Bool               always recalculate entire Jacobian matrix? Otherwise updates columns only as required\nmodplot::Int                    iteration frequency at which to make plots\nsave_frames::Bool               save plotting frames\nmodprint::Int                   iteration frequency at which to print info\nplot_jacobian::Bool             plot jacobian too?\nradiative_Kzz::Bool             estimate Kzz in radiative zones? Otherwise left at Kzz=0 in these regions.\nconv_atol::Float64              convergence: absolute tolerance on per-level flux deviation [W m-2]\nconv_rtol::Float64              convergence: relative tolerance on per-level flux deviation [dimensionless]\n\nReturns:     Nothing\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.solver.solve_prescribed!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.solver.solve_prescribed!","text":"Solve for global (not local) balance with a prescribed atmosphere structure.\n\nComparable to solve_transparent, but with an opaque prescribed atmospheric structure.\n\nArguments:\n\natmos::Atmos_t         the atmosphere struct instance to be used.\nsol_type::Int          solution types, same as solve_energy\natm_type::Int         atmosphere prescription (1: isothermal, 2: adiabat, 3: adiabat+stratosphere)\nconv_atol::Float64     convergence: absolute tolerance on global flux [W m-2]\nconv_rtol::Float64     convergence: relative tolerance on global flux [dimensionless]\nmax_steps::Int         maximum number of solver steps\ntmp_upper::Float64     upper-bound on Tsurf for golden-section search [K]\n\nReturns:\n\nBool indicating success\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.solver.solve_transparent!-Tuple{AGNI.atmosphere.Atmos_t}","page":"Software manual","title":"AGNI.solver.solve_transparent!","text":"Solve for energy balance with a transparent atmosphere.\n\nThis will use an isothermal temperature profile, and only modify T_surf.\n\nArguments:\n\natmos::Atmos_t         the atmosphere struct instance to be used.\nsol_type::Int          solution types, same as solve_energy\nconv_atol::Float64     convergence: absolute tolerance on global flux [W m-2]\nconv_rtol::Float64     convergence: relative tolerance on global flux [dimensionless]\nmax_steps::Int         maximum number of solver steps\ntmp_upper::Float64     upper-bound on Tsurf for golden-section search [K]\n\nReturns:\n\nBool indicating success\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.plotting.animate-Tuple{String, String}","page":"Software manual","title":"AGNI.plotting.animate","text":"Convert still-frame images into an animation\n\nUses FFMPEG provided by Julia library.\n\nArguments:\n\noutput_dir::String          folder in which to save the animation\nframes_dir::String          folder containing the frames\n\nOptional arguments:\n\noutput_fmt::String          output file format: mp4, mov, ...\nframes_fmt::String          input frame format: png, jpg, ...\nduration::Float64           animation duration [seconds]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.plotting.combined-Tuple{Any, Any, Any, Any, String, String}","page":"Software manual","title":"AGNI.plotting.combined","text":"Combined plot used for tracking behaviour of the solver\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.plotting.jacobian-Tuple{Matrix{Float64}, String}","page":"Software manual","title":"AGNI.plotting.jacobian","text":"Plot jacobian matrix\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.plotting.plot_albedo-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.plotting.plot_albedo","text":"Plot spectral albedo (ratio of SWUP to SWDN)\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.plotting.plot_cloud-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.plotting.plot_cloud","text":"Plot the cloud mass mixing ratio and area fraction.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.plotting.plot_contfunc1-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.plotting.plot_contfunc1","text":"Plot contribution function at different bands.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.plotting.plot_contfunc2-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.plotting.plot_contfunc2","text":"Plot normalised contribution function (per band)\n\nThe data displayed in this plot are fine, but the x-axis ticks are labelled incorrectly by the plotting library. I don't know why this is.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.plotting.plot_emission-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.plotting.plot_emission","text":"Plot emission spectrum at the TOA\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.plotting.plot_fluxes-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.plotting.plot_fluxes","text":"Plot the fluxes at each pressure level\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.plotting.plot_pt-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.plotting.plot_pt","text":"Plot the temperature-pressure profile.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.plotting.plot_radius-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.plotting.plot_radius","text":"Plot the radius vs pressure profile.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.plotting.plot_vmr-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.plotting.plot_vmr","text":"Plot the VMRs of the atmosphere at each cell-centre location.\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys._get_mmw-Tuple{String}","page":"Software manual","title":"AGNI.phys._get_mmw","text":"Calculate species mean molecular weight [kg mol-1] from formula or use known value\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys._pretty_color-Tuple{String}","page":"Software manual","title":"AGNI.phys._pretty_color","text":"Generate a colour hex code from a molecular formula\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys._pretty_name-Tuple{String}","page":"Software manual","title":"AGNI.phys._pretty_name","text":"Convert formula to pretty unicode string\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys._rho_ideal-Tuple{Float64, Float64, Float64}","page":"Software manual","title":"AGNI.phys._rho_ideal","text":"Evaluate the density of a single gas using the ideal gas EOS.\n\nArguments:\n\ntmp::Float64        temperature [K]\nprs::Float64        pressure [Pa]\nmmw::Float64        mean molecular weight [kg mol-1]\n\nReturns:\n\nrho::Float64        mass density [kg m-3]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.calc_Teq-Tuple{Float64, Float64}","page":"Software manual","title":"AGNI.phys.calc_Teq","text":"Calculate planetary equilibrium temperature.\n\nhttps://en.wikipedia.org/wiki/Planetaryequilibriumtemperature?useskin=vector\n\nArguments:\n\nS::Float64       Bolometric instellation [W m-2]\nα::Float64       Bond albedo\n\nReturns:\n\nTeq::Float64     Planetary equilibrium temperature [K]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.calc_Tskin-Tuple{Float64, Float64}","page":"Software manual","title":"AGNI.phys.calc_Tskin","text":"Calculate planetary skin temperature.\n\nhttps://en.wikipedia.org/wiki/Skintemperature(atmosphere)?useskin=vector\n\nArguments:\n\nS::Float64       Bolometric instellation [W m-2]\nα::Float64       Bond albedo\n\nReturns:\n\nTskin::Float64   Planetary skin temperature [K]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.calc_rho_gas-Tuple{Float64, Float64, AGNI.phys.Gas_t}","page":"Software manual","title":"AGNI.phys.calc_rho_gas","text":"Calculate the density of a gas using the most appropriate equation of state.\n\nArguments:\n\ntmp::Float64        temperature [K]\nprs::Float64        pressure [Pa]\ngas::Gas_t          the gas struct to be used\n\nReturns:\n\nrho::Float64        mass density [kg m-3]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.calc_rho_mix-Tuple{Vector{AGNI.phys.Gas_t}, Vector{Float64}, Float64, Float64, Float64}","page":"Software manual","title":"AGNI.phys.calc_rho_mix","text":"Calculate the density of a mixture of gases using Amagat's law.\n\nArguments:\n\ngas::Array{Gas_t,1}     array of gases\nvmr::Array{Float64,1}   array of volume mixing ratios\ntmp::Float64            temperature [K]\nprs::Float64            pressure [Pa]\n\nReturns:\n\nrho::Float64            mass density [kg m-3]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.calc_therm_diffus-Tuple{Float64, Float64, Float64}","page":"Software manual","title":"AGNI.phys.calc_therm_diffus","text":"Calculate thermal diffusivity.\n\nhttps://en.wikipedia.org/wiki/Thermal_diffusivity?useskin=vector\n\nArguments:\n\nk::Float64       Thermal conductivity [W m-1 K-1]\nρ::Float64       Density [kg m-3]\ncp::Float64      Specific heat capacity [J K-1 kg-1]\n\nReturns:\n\nα::Float64       Thermal diffusivity [m2 s-1]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.count_atoms-Tuple{String}","page":"Software manual","title":"AGNI.phys.count_atoms","text":"Get number of atoms from formula, returning a dictionary\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.evaluate_planck-Tuple{Float64, Float64}","page":"Software manual","title":"AGNI.phys.evaluate_planck","text":"Evaluate the Planck function at a given wavelength and temperature.\n\nIntegrated over a hemisphere.\n\nArguments:\n\nwave::Float64       Wavelength [nm]\ntmp::Float64        Temperature [K]\n\nReturns:\n\nflx::Float64        Spectral flux density [W m-2 nm-1]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.get_Cp-Tuple{AGNI.phys.Gas_t, Float64}","page":"Software manual","title":"AGNI.phys.get_Cp","text":"Get gas heat capacity for a given temperature.\n\nEvaluates at 0 Celcius if gas.tmp_dep=false.\n\nArguments:\n\ngas::Gas_t              the gas struct to be used\nt::Float64              temperature [K]\n\nReturns:\n\ncp::Float64             heat capacity of gas [J K-1 kg-1]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.get_Kc-Tuple{AGNI.phys.Gas_t, Float64}","page":"Software manual","title":"AGNI.phys.get_Kc","text":"Get gas thermal conductivity at a given temperature.\n\nThis assumes that the gas is within the ideal regime.\n\nArguments:\n\ngas::Gas_t              the gas struct to be used\nt::Float64              temperature [K]\n\nReturns:\n\nkc::Float64             thermal conductivity [W m-1 K-1]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.get_Lv-Tuple{AGNI.phys.Gas_t, Float64}","page":"Software manual","title":"AGNI.phys.get_Lv","text":"Get gas enthalpy (latent heat) of phase change.\n\nIf the temperature is above the critical point, then a zero value is returned. Evaluates at 0 Celcius if gas.tmp_dep=false.\n\nArguments:\n\ngas::Gas_t              the gas struct to be used\nt::Float64              temperature [K]\n\nReturns:\n\nh::Float64              enthalpy of phase change [J kg-1]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.get_Psat-Tuple{AGNI.phys.Gas_t, Float64}","page":"Software manual","title":"AGNI.phys.get_Psat","text":"Get gas saturation pressure for a given temperature.\n\nIf the temperature is above the critical point, then a large value is returned.\n\nArguments:\n\ngas::Gas_t              the gas struct to be used\nt::Float64              temperature [K]\n\nReturns:\n\np::Float64              saturation pressure [Pa]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.get_Tdew-Tuple{AGNI.phys.Gas_t, Float64}","page":"Software manual","title":"AGNI.phys.get_Tdew","text":"Get gas dew point temperature for a given partial pressure.\n\nIf the pressure is below the critical point pressure, then T_crit is returned. This function is horrendous, and should be avoided at all costs.\n\nArguments:\n\ngas::Gas_t              the gas struct to be used\np::Float64              pressure [Pa]\n\nReturns:\n\nt::Float64              dew point temperature [K]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.grav_accel-Tuple{Float64, Float64}","page":"Software manual","title":"AGNI.phys.grav_accel","text":"Calculate gravitational acceleration.\n\nArguments:\n\nmass::Float64       Enclosed mass [kg]\nradius::Float64     Enclosed radius [m]\n\nReturns:\n\ngrav::Float64       Gravitational acceleration [m s-2]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.is_vapour-Tuple{AGNI.phys.Gas_t, Float64, Float64}","page":"Software manual","title":"AGNI.phys.is_vapour","text":"Check if pressure-temperature coordinate is within the vapour regime.\n\nReturns true if p > psat and t < tcrit.\n\nArguments:\n\ngas::Gas_t              the gas struct to be used\nt::Float64              temperature [K]\np::Float64              temperature [K]\n\nReturns:\n\nvapour::Bool           is within vapour regime?\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.liquid_rho-Tuple{String}","page":"Software manual","title":"AGNI.phys.liquid_rho","text":"Evaluate the density of a liquid phase.\n\nReturns BIGFLOAT density for unsupported phases, to avoid divide-by-zero error\n\nArguments:\n\nname::String    Name of liquid\n\nReturns:\n\nrho::Float64    Density of liquid phase [kg m-3]\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.load_gas-Tuple{String, String, Bool, Bool}","page":"Software manual","title":"AGNI.phys.load_gas","text":"Load gas data into a new struct\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.phys.same_atoms-Tuple{Dict, Dict}","page":"Software manual","title":"AGNI.phys.same_atoms","text":"Check if two gas atom dicts are equivalent\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.save.write_fluxes-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.save.write_fluxes","text":"Write cell-edge energy fluxes to a CSV file\n\nArguments\n\natmos::Atmos_t      Atmosphere object\nfname::String       Filename to write to\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.save.write_ncdf-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.save.write_ncdf","text":"Write verbose atmosphere data to a NetCDF file\n\nArguments\n\natmos::Atmos_t      Atmosphere object\nfname::String       Filename to write to\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.save.write_profile-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.save.write_profile","text":"Write {Pressure, Temperature, Radius} profile to a CSV file\n\nArguments\n\natmos::Atmos_t      Atmosphere object\nfname::String       Filename to write to\n\n\n\n\n\n","category":"method"},{"location":"manual/#AGNI.load.load_ncdf!-Tuple{AGNI.atmosphere.Atmos_t, String}","page":"Software manual","title":"AGNI.load.load_ncdf!","text":"Load atmosphere data from a NetCDF file.\n\nThis must be called after setup! and allocate! have been called on this atmos struct. Does not overwrite energy fluxes within the atmospherem, or other wavelength-dependent properties. Only composition, temperatures, layer properties, and boundary conditions are updated by this function.\n\nArguments:\n\natmos::Atmos_t      the atmosphere struct instance to be used.\nfname::String       path to the NetCDF file\n\nReturns:\n\nok::Bool            loaded ok?\n\n\n\n\n\n","category":"method"},{"location":"troubleshooting/#Troubleshooting","page":"Troubleshooting","title":"Troubleshooting","text":"This page may be useful if you are having problems. However, I would suggest that you also double check that you followed all of the Getting started instructions.","category":"section"},{"location":"troubleshooting/#Julia-version-is-incompatible-/-Errors-about-OpenSSL-library","page":"Troubleshooting","title":"Julia version is incompatible / Errors about OpenSSL library","text":"You must use Julia version 1.11 because there are incompatibilities between the OpenSSL library required by Julia 1.12 and Python.\n\nSwitch Julia versions using the juliaup command. E.g:\n\njuliaup status        # Show the versions you have installed\njuliaup add 1.11      # Install Julia 1.11\njuliaup default 1.11  # Make 1.11 your default version of Julia\njulia --version       # This should say 1.11.something\n\nAfter following these steps, try installing AGNI again. You will now also need to create a new Python environment, so that conda is aware that 1.11 is the desired Julia version","category":"section"},{"location":"troubleshooting/#Wget-is-not-installed","page":"Troubleshooting","title":"Wget is not installed","text":"You need to install wget. This is a tool for tranferring files over a network. Wget is used by AGNI to obtain lookup data files from Zenodo. Most Linux distributions come with wget; otherwise see this page.\n\nTo install wget on MacOS:\n\nbrew install wget","category":"section"},{"location":"troubleshooting/#Unzip-is-not-installed","page":"Troubleshooting","title":"Unzip is not installed","text":"You need to install unzip. This command is used by AGNI to extract some data files once downloaded. Most computers come with this command; otherwise see this page.\n\nTo install unzip on Ubuntu/Debian:\n\nsudo apt-get install unzip","category":"section"},{"location":"troubleshooting/#NetCDF-is-not-installed","page":"Troubleshooting","title":"NetCDF is not installed","text":"You need to install NetCDF on your machine. This is a library designed for reading and writing data files, commonly used in atmospheric sciences. Wikipedia page.\n\nTo install NetCDF on Ubuntu:\n\nsudo apt install libnetcdf-dev netcdf-bin ncview libnetcdff-dev\n\nTo install NetCDF on MacOS:\n\nsudo brew install netcdf netcdf-fortran","category":"section"},{"location":"troubleshooting/#Julia-errors-on-start,-potentially-referencing-the-CURL-library","page":"Troubleshooting","title":"Julia errors on start, potentially referencing the CURL library","text":"It is important that the shell environment variable LD_LIBRARY_PATH is not set when running AGNI. This will cause Julia to use the wrong libraries, which will causes problems. You can unset this variable or reset using either of the following commands\n\nunset LD_LIBRARY_PATH\nexport LD_LIBRARY_PATH=\"\"\n\nIf this does not help, it's possible that you are using a Julia distribution provided by your system package manager. It's important that you only use Julia distributed from the official website.","category":"section"},{"location":"troubleshooting/#Fill-error-when-compiling-SOCRATES","page":"Troubleshooting","title":"Fill error when compiling SOCRATES","text":"For example, an error which looks something like:\n\n...\nCgen_null.c:52:13: error: too many arguments to function 'fill'; expected 0, have 6\n   52 |             fill(&np, p, p1, p2, divisi\n...\n\nThis is caused by using an incompatible C compiler. The compilation has been tested with gcc version 12.2.0\n\nThis can occur when compiling SOCRATES while you have a conda environment activated, if one of the Python packages provides gcc. Try deactivating conda.","category":"section"},{"location":"troubleshooting/#Cannot-find-SOCRATES","page":"Troubleshooting","title":"Cannot find SOCRATES","text":"Check the installation instructions. Have you set the RAD_DIR environment variable? Try running l_run_cdf in the terminal; if this fails, then SOCRATES has not compiled or you haven't added it to your PATH. It is necessary to set the RAD_DIR variable for the environment in which you are running AGNI, so it is best to add it to your shell's rc file permanently.","category":"section"},{"location":"troubleshooting/#Spectral-file-does-not-exist","page":"Troubleshooting","title":"Spectral file does not exist","text":"First, check the path in the configuration file.\n\nDownload additional spectral files using the get_data script. For example, for additional pure-steam spectral files you would run:\n\n./src/get_data.sh steam\n\nWhen you downloaded AGNI it should have obtained a \"basic\" set of data. This will include a reference guide located at res/spectral_files/reference.pdf. Using the table inside this PDF file, you can decide which set of opacities are appropriate for you.\n\nFor example, to download the spectral file Honeyside16 you would then run:\n\n./src/get_data.sh anyspec Honeyside 16\n\nNote the space between the codename and number of bands. Other spectral files can be downloaded from the PROTEUS community on Zenodo.","category":"section"},{"location":"troubleshooting/#Cannot-find-FastChem","page":"Troubleshooting","title":"Cannot find FastChem","text":"You need to install FastChem. This can be done by running the command:\n\n./src/get_fastchem.sh\n\nand then adding FC_DIR to your shell rc file.","category":"section"},{"location":"troubleshooting/#Finally...","page":"Troubleshooting","title":"Finally...","text":"If you are still stuck, or feel that there is a problem with the code, then you can contact me using directions on my website homepage.","category":"section"},{"location":"examples/#Example-outputs","page":"Example outputs","title":"Example outputs","text":"","category":"section"},{"location":"examples/#Pure-steam-runaway-greenhouse-effect","page":"Example outputs","title":"Pure steam runaway greenhouse effect","text":"By assuming the atmosphere temperature profile follows a dry adiabat and the water vapour-condensate coexistance curve defined by the Clausius-Claperyron relation, we see a characteristic relationship between the outgoing longwave radiation (OLR) and the surface temperature (T_s). Initially OLR increases with T_s, but as the condensing layer (which is independent of T_s) overlaps with the photosphere, OLR and T_s decouple. Eventually the atmosphere reaches a dry post-runaway state, and OLR increases rapidly with T_s.\n\n  <img src=\"assets/runaway/curve.png\" width=75% class=\"center\"/>\n\nYou can find a Jupyter notebook which reproduces this result in the tutorials directory of the repository.","category":"section"},{"location":"examples/#Prescribed-convective-case","page":"Example outputs","title":"Prescribed convective case","text":"In this case, a temperature profile is prescribed to follow a dry adiabat from the surface to a moist region, and then a pseudoadiabat to the top of the atmosphere. This is in line with previous works and the OLR curve above.\n\n  <img src=\"assets/nosolve/plot_ptprofile.png\" width=62% class=\"center\"/>\n\nRadiative fluxes are then calculated according to this  temperature profile. Because the profile is prescribed, the fluxes are not balanced locally or globally across the column.\n\n  <img src=\"assets/nosolve/plot_fluxes.png\" width=62% class=\"center\"/>","category":"section"},{"location":"examples/#Radiative-convective-solution","page":"Example outputs","title":"Radiative-convective solution","text":"Instead, we can model an atmosphere such that that energy is globally and locally conserved. Convection is parameterised using mixing length theory in this case, allowing the system to be solved using a Newton-Raphson method. In the convective region at ~0.1 bar, we can see that the radiative fluxes and convective fluxes entirely cancel, because AGNI was asked to solve for a case with zero total flux transport.\n\n  <img src=\"assets/withsolve/plot_ptprofile.png\" width=62% class=\"center\"/>\n  <br />\n  <img src=\"assets/withsolve/plot_fluxes.png\" width=62% class=\"center\"/>\n\nWe can also plot the outgoing emission spectrum and normalised longwave contribution function (CF). The spectrum clearly demonstrates complex water absorption features, and exceeds blackbody emission at shorter wavelengths due to Rayleigh scattering. The CF quantifies how much each pressure level contributes to the outgoing emission spectrum at a given wavelength – this is then plotted versus wavelength and pressure.\n\n  <img src=\"assets/withsolve/plot_emission.png\" width=90% class=\"center\"/>","category":"section"},{"location":"","page":"Home","title":"Home","text":"    <img class=\"display-light-only\" src=\"assets/logo_title_light.svg\" width=32% alt=\"AGNI logo, light mode\"/>\n    <img class=\"display-dark-only\"  src=\"assets/logo_title_dark.svg\"  width=32% alt=\"AGNI logo, dark mode\"/>\n    <p align=\"center\">\n        <b>An open-source model for extreme atmospheres on rocky exoplanets</b>\n    </p>\n\nAGNI's primary purpose is to simulate the atmospheric temperature-, height-, and compositional-structures of atmospheres overlying magma oceans. It does this while ensuring that radiative-convective equilibrium is maintained throughout the atmosphere. SOCRATES is used to perform correlated-k radiative transfer including: shortwave irradiation from the star, surface emission, line absorption, Rayleigh scattering, parameterised clouds, and collisional absorption. Mixing length theory is used to parametrise convection. AGNI also supports real gas equations of state, self-gravitation, and various spectral surface compositions. Accounting for these energy transport processes permits an energy-conserving calculation of atmospheric structure, obtained using numerical optimisation, which also yields realistic cooling rates for young rocky planets with magma oceans.\n\nPronounced as ag-nee. Named after the fire deity of Hinduism.\n\nFollow Getting started for information on installing the code and obtaining results.\n\nContact: see information on my website homepage.\n\nGitHub: https://github.com/nichollsh/AGNI\n\nIf you use AGNI, please cite the following papers:\n\nNicholls et al. (2025a)  - 10.1093/mnras/stae2772\nNicholls et al. (2025b)  - 10.21105/joss.07726\nNicholls et al. (in rev) - 2507.02656\n\nThis software is available under the GPLv3. Copyright © 2023-2026 Harrison Nicholls.","category":"section"},{"location":"setup/#Getting-started","page":"Getting started","title":"Getting started","text":"This page outlines requirements and installation steps for the code. Currently, GNU/Linux and MacOS (including ARM) are supported.","category":"section"},{"location":"setup/#Software-requirements","page":"Getting started","title":"Software requirements","text":"gfortran\nnetcdf\nnetcdf-fortran\nmake\nwget\nunzip\n\nwarning: Warning\nDo not install Julia using your system package manager. Install only from julialang.org as below.","category":"section"},{"location":"setup/#Installation","page":"Getting started","title":"Installation","text":"Follow the steps below in order to setup the code.\n\nInstall Julia's package manager: curl -fsSL https://install.julialang.org | sh\nSwitch to Julia 1.11: juliaup add 1.11 && juliaup default 1.11\nDownload AGNI: git clone https://github.com/nichollsh/AGNI.git\nChange directory: cd AGNI\nSetup SOCRATES by doing either ONE of the following...\nFollow the instructions on the SOCRATES GitHub page\nRun ./src/get_socrates.sh\nFinally, install AGNI: ./src/get_agni.sh\n\nAGNI is now installed as a package into the Julia environment of the AGNI directory. This will also have downloaded some basic input data and run the tests.\n\nwarning: Warning\nThe RAD_DIR environment variable must be set to your SOCRATES path whenever AGNI is being used. This is so that AGNI can locate the SOCRATES libraries.\n\ntip: Tip\nVisit the Troubleshooting page if you encounter any problems. This page can usually resolve your problem.","category":"section"},{"location":"setup/#Testing","page":"Getting started","title":"Testing","text":"If you want to run the tests manually, simply use the script in the test/ folder...\n\njulia test/runtests.jl\n\nThis will print information on whether tests passed or failed.","category":"section"},{"location":"setup/#Updating","page":"Getting started","title":"Updating","text":"It's important that you keep AGNI up to date, especially if you are using as part of the PROTEUS framework. Use this script to automatically pull changes from GitHub and download any required data files.\n\n./src/get_agni.sh","category":"section"},{"location":"setup/#Using-the-code","page":"Getting started","title":"Using the code","text":"See Using the model for information on using the code. See Troubleshooting for troubleshooting advice.","category":"section"},{"location":"setup/#Coupling-with-FastChem","page":"Getting started","title":"Coupling with FastChem","text":"Coupling with FastChem can be enabled using the configuration parameter composition.chemistry. Of course, it is first necessary to set up FastChem, which can be done by running:\n\n./src/get_fastchem.sh\n\nYou must then set the FC_DIR environment variable to the location of the FastChem installation folder. Ideally you should also add this variable to your bashrc file.","category":"section"},{"location":"thanks/#Acknowledgements","page":"Acknowledgements","title":"Acknowledgements","text":"I would like to thank the following people for their input and assistance during the ongoing development of AGNI.\n\nTim Lichtenberg\nRaymond Pierrehumbert\nNamrah Habib\nClaire Marie Guimond\nArjun Savel – JOSS paper reviewer\nRyan Macdonald – JOSS paper reviewer\nBoding Ouyang\nSoumil Kelkar\nStuart Daines\n\nPlease contact Harrison Nicholls for any queries relating to AGNI.","category":"section"}]
}
