<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Description · AGNI</title><meta name="title" content="Description · AGNI"/><meta property="og:title" content="Description · AGNI"/><meta property="twitter:title" content="Description · AGNI"/><meta name="description" content="Documentation for AGNI."/><meta property="og:description" content="Documentation for AGNI."/><meta property="twitter:description" content="Documentation for AGNI."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AGNI</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Description</a><ul class="internal"><li><a class="tocitem" href="#Radiative-transfer"><span>Radiative transfer</span></a></li><li><a class="tocitem" href="#Convection"><span>Convection</span></a></li><li><a class="tocitem" href="#Solar-flux"><span>Solar flux</span></a></li><li><a class="tocitem" href="#Solution-types"><span>Solution types</span></a></li><li><a class="tocitem" href="#Obtaining-a-solution"><span>Obtaining a solution</span></a></li><li><a class="tocitem" href="#Other-features"><span>Other features</span></a></li><li><a class="tocitem" href="#Julia-and-Fortran"><span>Julia and Fortran</span></a></li></ul></li><li><a class="tocitem" href="../setup/">Getting started</a></li><li><a class="tocitem" href="../usage/">Running the model</a></li><li><a class="tocitem" href="../examples/">Example outputs</a></li><li><a class="tocitem" href="../manual/">Manual</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Description</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Description</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nichollsh/AGNI" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/nichollsh/AGNI/blob/main/docs/src/model.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Description"><a class="docs-heading-anchor" href="#Description">Description</a><a id="Description-1"></a><a class="docs-heading-anchor-permalink" href="#Description" title="Permalink"></a></h1><p>AGNI models a planetary atmosphere by treating it as a single column (1D) and splitting it up into levels of finite thickness. These levels are defined in pressure-space, and are arranged logarithmically between the surface and the top of the atmosphere. Quantities such as pressure and temperature are calculated at level-centres and level-edges, while energy fluxes are calculated only at the edges, and thermodynamic properties (e.g. heat capacity) are calculated only at their centres.</p><h2 id="Radiative-transfer"><a class="docs-heading-anchor" href="#Radiative-transfer">Radiative transfer</a><a id="Radiative-transfer-1"></a><a class="docs-heading-anchor-permalink" href="#Radiative-transfer" title="Permalink"></a></h2><p>Radiative transfer (RT) refers to the transport of radiation energy through a medium subject to the characteristics of the medium. Radiation passing through an atmosphere is absorbed, emitted, scattered, and reflected. In the context of planetary atmospheres, we also have to handle their surfaces, cloud formation, and radiation from the host star.</p><p>AGNI models RT using SOCRATES, a numerical code written by the UK Met Office which solves the RT equation using a two-stream solution under a plane-parallel approximation. SOCRATES is accessed using a Julia interface originally written by Stuart Daines. The atmosphere is assumed to be hydrostatically supported and to behave as an ideal gas. Opacity is calculated using the correlated-k approximation, with either random overlap or equivalent extinction used to account for overlapping absorption in mixtures of gases. </p><p>For simulating gaseous absorption, the model fits k-terms to spectral absorption cross-section data from DACE. The MT_CKD model is used to estimate continuum absorption cross-sections. Rayleigh scattering and water cloud radiative effects are also included. You can find tools for fitting k-terms and processing line absorption data in my redistribution of <a href="https://github.com/nichollsh/SOCRATES">SOCRATES</a> on GitHub.</p><h2 id="Convection"><a class="docs-heading-anchor" href="#Convection">Convection</a><a id="Convection-1"></a><a class="docs-heading-anchor-permalink" href="#Convection" title="Permalink"></a></h2><p>Convection is a process that occurs across more than one spatial dimension, so it must be parameterised within 1D models like AGNI. In fact, it&#39;s often parameterised in 3D global circulation models, as resolving convection is numerically difficult. Two convection parameterisations are included within the model: convective adjustment (CA), and mixing length theory (MLT). </p><p>CA forcibly adjusts a convectively unstable region of the atmosphere to the corresponding adiabat, while ensuring that enthalpy is conserved. Only dry adjustment is included in the model. This does not allow the convective energy fluxes to be calculated directly.</p><p>MLT directly calculates the energy flux associated with convective heat transport, and thus is the preferred parameterisation within the model. It assumes that parcels of gas are diffused over a characteristic <em>mixing length</em>, transporting energy in the process.</p><p>Heat capacities are temperature-dependent, calculated using the Shomate Equation with coefficients derived from the NIST website.</p><h2 id="Solar-flux"><a class="docs-heading-anchor" href="#Solar-flux">Solar flux</a><a id="Solar-flux-1"></a><a class="docs-heading-anchor-permalink" href="#Solar-flux" title="Permalink"></a></h2><p>The radiation component requires two boundary conditions the energy. The first is the shortwave downward-directed flux from the star at the top of the atmosphere. This is quantified by the instellation, a scale factor, a grey bond albedo, and the solar zenith angle. All of these may be provided to the model through the configuration file.</p><h2 id="Solution-types"><a class="docs-heading-anchor" href="#Solution-types">Solution types</a><a id="Solution-types-1"></a><a class="docs-heading-anchor-permalink" href="#Solution-types" title="Permalink"></a></h2><p>Depending on the system you wish to model, it is necessary to tell AGNI what kind of solution to solve for. There are currently a few options available set by the <code>solution_type</code> variable.   </p><ul><li>(0) Aim to conserve energy fluxes throughout the column. The surface temperature is set at <span>$T_s$</span> assuming blackbody emission with a fixed surface albedo. The bottom-most temperature value in the column is extrapolated from the rest of the profile.</li><li>(1) Same as 0, but the bottom-most temperature value is fixed equal to <span>$T_s$</span>.</li><li>(2) Aim to conserve energy fluxes throughout the column. The surface temperature is set by energy transport through a solid conductive boundary layer (CBL) such that <span>$T_s = T_m - Fd/k$</span>, where <span>$T_m$</span> is the interior mantle temperature, while <span>$k$</span> and <span>$d$</span> are material properties. </li><li>(3) Solve for a state such that the flux carried at each level is equal to <span>$\sigma T_{\text{eff}}^4$</span>. In this case, <span>$T_{\text{eff}}$</span> represents the rate at which a planet is losing energy into space. </li></ul><h2 id="Obtaining-a-solution"><a class="docs-heading-anchor" href="#Obtaining-a-solution">Obtaining a solution</a><a id="Obtaining-a-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Obtaining-a-solution" title="Permalink"></a></h2><p>AGNI is designed for modelling planetary atmospheres with high surface pressures and temperatures. This means that the radiative timescale differs by several orders of magnitude across the column, which makes obtaining a solution difficult. The model contains a suite of methods for obtaining a solution.</p><h3 id="A)-Solving-a-non-linear-system"><a class="docs-heading-anchor" href="#A)-Solving-a-non-linear-system">A) Solving a non-linear system</a><a id="A)-Solving-a-non-linear-system-1"></a><a class="docs-heading-anchor-permalink" href="#A)-Solving-a-non-linear-system" title="Permalink"></a></h3><p>To obtain a temperature structure solution that conserves energy more precisely than a time-stepping method, it is possible to construct the model as a system of non-linear equations <span>$\vec{r}(\vec{x})$</span>. This algorithm obtains the roots of the nonlinear system formed by the flux divergence <span>$r_i$</span> at each level <span>$i$</span>, with cell-centre temperatures used as the independent variables <span>$x_i$</span>. Finite-difference methods are used to estimate the jacobian matrix in this case. Similar methods have been used in a handful of planetary radiative-convective models (e.g. ATMO), but is more commonly used by the stellar physics community. Currently implemented solvers: Newton-Raphson, Gauss-Newton, and Levenberg-Marquardt. Optionally, the code uses a golden-section linesearch algorithm to determine the optimal step length. </p><h3 id="B)-Time-stepping"><a class="docs-heading-anchor" href="#B)-Time-stepping">B) Time-stepping</a><a id="B)-Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#B)-Time-stepping" title="Permalink"></a></h3><p>AGNI also implements a multistep Adams-Bashforth integrator to integrate the heating rates at each level over time. This is very robust to the initial conditions provided, but is not able to obtain an energy-conserving solution very quickly. Each level to evolves on its own timescale, which provides unphysical intermediate solutions but a physical final state. Time-stepping methods such as these are used in other radiative-convective models (with their own enhancements) such as HELIOS and Exo_k. This method is not the primary solver within AGNI, so it in &quot;maintainence mode&quot; rather than active development.</p><h2 id="Other-features"><a class="docs-heading-anchor" href="#Other-features">Other features</a><a id="Other-features-1"></a><a class="docs-heading-anchor-permalink" href="#Other-features" title="Permalink"></a></h2><p>AGNI can calculate emission spectra, provided with T(p) and the volume mixing ratios of the gases. This is performed using the same RT as the RCE calculations, so is limited in resolution by the choice of correlated-k bands. Similarly, the the contribution function can also be calculated.</p><h2 id="Julia-and-Fortran"><a class="docs-heading-anchor" href="#Julia-and-Fortran">Julia and Fortran</a><a id="Julia-and-Fortran-1"></a><a class="docs-heading-anchor-permalink" href="#Julia-and-Fortran" title="Permalink"></a></h2><p>AGNI is primarily written in Julia, while SOCRATES itself is written in Fortran. Julia was chosen because it allows the SOCRATES binaries to be included in the precompiled code, which significantly improves performance.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../setup/">Getting started »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Thursday 30 May 2024 14:37">Thursday 30 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
