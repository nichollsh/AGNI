<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Development · AGNI</title><meta name="title" content="Development · AGNI"/><meta property="og:title" content="Development · AGNI"/><meta property="twitter:title" content="Development · AGNI"/><meta name="description" content="Documentation for AGNI."/><meta property="og:description" content="Documentation for AGNI."/><meta property="twitter:description" content="Documentation for AGNI."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AGNI</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../model/">Model description</a></li><li><a class="tocitem" href="../setup/">Getting started</a></li><li><a class="tocitem" href="../usage/">Running the model</a></li><li><a class="tocitem" href="../examples/">Example outputs</a></li><li><a class="tocitem" href="../troubleshooting/">Troubleshooting</a></li><li class="is-active"><a class="tocitem" href>Development</a><ul class="internal"><li><a class="tocitem" href="#Contributing"><span>Contributing</span></a></li><li><a class="tocitem" href="#Coding-style"><span>Coding style</span></a></li><li><a class="tocitem" href="#Code-reference"><span>Code reference</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Development</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Development</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nichollsh/AGNI" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/nichollsh/AGNI/blob/main/docs/src/manual/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Development-manual"><a class="docs-heading-anchor" href="#Development-manual">Development manual</a><a id="Development-manual-1"></a><a class="docs-heading-anchor-permalink" href="#Development-manual" title="Permalink"></a></h1><h2 id="Contributing"><a class="docs-heading-anchor" href="#Contributing">Contributing</a><a id="Contributing-1"></a><a class="docs-heading-anchor-permalink" href="#Contributing" title="Permalink"></a></h2><p>If you are interested in contributing to the model, please contact the developers using the information on the main page.</p><h2 id="Coding-style"><a class="docs-heading-anchor" href="#Coding-style">Coding style</a><a id="Coding-style-1"></a><a class="docs-heading-anchor-permalink" href="#Coding-style" title="Permalink"></a></h2><ul><li>Indentation uses 4 spaces, no tabs.</li><li>Function names should be lowercase, with words separated by underscores .</li><li>Lines should aim to have a length of no more than 92 characters.</li><li>All functions should have docstrings, ideally with Arguments and Returns listed.</li><li>More comments are always better, even if they seem redundant.</li><li>Use type hinting where possible.</li><li>Print statements should be made through the logger where possible.</li><li>The core package code should not contain global variables, except in the phys module.</li></ul><h2 id="Code-reference"><a class="docs-heading-anchor" href="#Code-reference">Code reference</a><a id="Code-reference-1"></a><a class="docs-heading-anchor-permalink" href="#Code-reference" title="Permalink"></a></h2><h3 id="Atmosphere-initialisation-and-variables"><a class="docs-heading-anchor" href="#Atmosphere-initialisation-and-variables">Atmosphere initialisation and variables</a><a id="Atmosphere-initialisation-and-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Atmosphere-initialisation-and-variables" title="Permalink"></a></h3><p>Functions from <code>atmosphere.jl</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.allocate!-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.atmosphere.allocate!-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.atmosphere.allocate!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Allocate atmosphere arrays, prepare spectral files, and final steps.</strong></p><p>Will not modify spectral file if <code>stellar_spectrum</code>` is an empty string.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>                 the atmosphere struct instance to be used.</li><li><code>stellar_spectrum::String</code>       path to stellar spectrum csv file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L1138-L1146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.calc_layer_props!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.atmosphere.calc_layer_props!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.calc_layer_props!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Calculate properties within each layer of the atmosphere (e.g. density, mmw).</strong></p><p>Arguments:     - <code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.     - <code>ignore_errors::Bool</code>     do not generate errors from hydrostatic integrator.</p><p>Returns:     - <code>ok::Bool</code>                function result is ok</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L836-L845">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.calc_observed_rho!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.atmosphere.calc_observed_rho!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.calc_observed_rho!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Calculate observed radius and bulk density.</strong></p><p>This is done at the layer probed in transmission, which is set to a fixed pressure.</p><p>Arguments:     - <code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.     - <code>p_ref::Float64</code>          observed pressure level [Pa]</p><p>Returns:     - <code>transspec_rho::Float64</code>  the bulk density observed in transmission</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L797-L808">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.calc_profile_cpkc!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.atmosphere.calc_profile_cpkc!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.calc_profile_cpkc!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Calculate specific heat capacity and thermal conductivity for all layers.</strong></p><p>Specific heat per unit mass: J K-1 kg-1. Thermal conductivity: W m-1 K-1.</p><p>Arguments:     - <code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L1007-L1015">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.calc_profile_density!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.atmosphere.calc_profile_density!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.calc_profile_density!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Calculate the mass-density for all layers.</strong></p><p>Requires temperature, pressure, mmw to be already have been set.</p><p>Arguments:     - <code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L1048-L1055">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.calc_profile_mmw!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.atmosphere.calc_profile_mmw!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.calc_profile_mmw!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Calculate mean molecular weight for all layers.</strong></p><p>MMW stored as kg/mol.</p><p>Arguments:     - <code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L991-L998">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.calc_profile_radius!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.atmosphere.calc_profile_radius!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.calc_profile_radius!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Calculate radius and gravity for all layers.</strong></p><p>Performs hydrostatic integration from the ground upwards. Requires density, temperature, pressure to have already been set.</p><p>Arguments:     - <code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.     - <code>ignore_errors::Bool</code>     do not generate errors from hydrostatic integrator.</p><p>Returns:     - <code>ok::Bool</code>                function result is ok</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L878-L890">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.calc_single_cpkc!-Tuple{AGNI.atmosphere.Atmos_t, Int64}" href="#AGNI.atmosphere.calc_single_cpkc!-Tuple{AGNI.atmosphere.Atmos_t, Int64}"><code>AGNI.atmosphere.calc_single_cpkc!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Calculate specific heat capacity and thermal conductivity of a single layer.</strong></p><p>Specific heat per unit mass: J K-1 kg-1. Thermal conductivity: W m-1 K-1.</p><p>Arguments:     - <code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.     - <code>idx::Int</code>            index of the layer</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L1024-L1033">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.calc_single_density!-Tuple{AGNI.atmosphere.Atmos_t, Int64}" href="#AGNI.atmosphere.calc_single_density!-Tuple{AGNI.atmosphere.Atmos_t, Int64}"><code>AGNI.atmosphere.calc_single_density!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Calculate the mass-density of a single layer.</strong></p><p>Requires temperature, pressure, mmw to be already have been set.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</li><li><code>idx::Int</code>            index of the layer</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L1064-L1072">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.estimate_photosphere!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.atmosphere.estimate_photosphere!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.estimate_photosphere!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Estimate photosphere.</strong></p><p>Estimates the location of the photosphere by finding the median of the contribution function in each band (0.2 um to 150 um), and then finding the pressure level at which these median values are maximised.</p><p>Arguments:     - <code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</p><p>Returns:     - <code>p_ref::Float64</code>          pressure level of photosphere [Pa]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L744-L756">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.generate_pgrid!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.atmosphere.generate_pgrid!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.generate_pgrid!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Generate pressure grid.</strong></p><p>Almost-equally log-spaced between p<em>boa and p</em>boa. The near-surface layers are smaller than they would be on an equally log-spaced grid, to avoid f numerical weirdness at the bottom boundary.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>              the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L1088-L1097">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.integrate_hydrograv-NTuple{5, Float64}" href="#AGNI.atmosphere.integrate_hydrograv-NTuple{5, Float64}"><code>AGNI.atmosphere.integrate_hydrograv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Integrate hydrostatic and gravity equations across a pressure interval.</strong></p><p>Uses the classic fourth-order Runge-Kutta method.</p><p>Arguments:     - <code>r0::Float64</code>     radius   at start of interval [m]     - <code>g0::Float64</code>     gravity  at start of interval [m s-2]     - <code>p0::Float64</code>     pressure at start of interval [Pa]     - <code>p1::Float64</code>     pressure at end   of interval [Pa]     - <code>rho::Float64</code>    density throughout interval, constant [kg m-3]</p><p>Returns:     - <code>r1::Float64</code>     radius at end of interval [m]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L936-L950">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.set_tmpl_from_tmp!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.atmosphere.set_tmpl_from_tmp!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.set_tmpl_from_tmp!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Set cell-edge temperatures from cell-centre values.</strong></p><p>Uses interpolation within the bulk of the column and extrapolation for the topmost edge.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>            the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L1677-L1685">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.setup!-Tuple{AGNI.atmosphere.Atmos_t, String, String, String, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Int64, Float64, Float64, Any, String}" href="#AGNI.atmosphere.setup!-Tuple{AGNI.atmosphere.Atmos_t, String, String, String, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Int64, Float64, Float64, Any, String}"><code>AGNI.atmosphere.setup!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Set parameters of the atmosphere.</strong></p><p>This is used to set up the struct immediately after creation. It must be     done before <code>allocate!()</code> is called, and before any RT calculcations     are performed.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>                  the atmosphere struct instance to be used.</li><li><code>ROOT_DIR::String</code>                AGNI root directory.</li><li><code>OUT_DIR::String</code>                 Output directory.</li><li><code>spfile::String</code>                  path to spectral file.</li><li><code>instellation::Float64</code>           bolometric solar flux at the top of the atmosphere [W m-2]</li><li><code>s0_fact::Float64</code>                scale factor to account for planetary rotation (i.e. S<em>0^*/S</em>0 in Cronin+14)</li><li><code>albedo_b::Float64</code>               bond albedo scale factor applied to instellation in order to imitate shortwave reflection</li><li><code>zenith_degrees::Float64</code>         angle of radiation from the star, relative to the zenith [degrees].</li><li><code>tmp_surf::Float64</code>               effective surface temperature to provide upward longwave flux at the bottom of the atmosphere [K].</li><li><code>gravity::Float64</code>                gravitational acceleration at the surface [m s-2].</li><li><code>radius::Float64</code>                 planet radius at the surface [m].</li><li><code>nlev_centre::Int</code>                number of model levels.</li><li><code>p_surf::Float64</code>                 total surface pressure [bar].</li><li><code>p_top::Float64</code>                  total top of atmosphere pressure [bar].</li><li><code>mf_dict::Dict</code>                   dictionary of VMRs in the format (key,value)=(gas,mf).</li><li><code>mf_path::String</code>                 path to file containing VMRs at each level.</li></ul><p>Optional arguments:</p><ul><li><code>condensates</code>                     list of condensates (gas names).</li><li><code>surface_material::String</code>        surface material (default is &quot;greybody&quot;, but can point to file instead).</li><li><code>albedo_s::Float64</code>               grey surface albedo used when <code>surface_material=&quot;greybody&quot;</code>.</li><li><code>tmp_floor::Float64</code>              temperature floor [K].</li><li><code>C_d::Float64</code>                    turbulent heat exchange coefficient [dimensionless].</li><li><code>U::Float64</code>                      surface wind speed [m s-1].</li><li><code>Kzz_floor::Float64</code>              eddy diffusion coefficient, min value [cm2 s-1]</li><li><code>tmp_magma::Float64</code>              mantle temperature [K] for sol_type==2.</li><li><code>skin_d::Float64</code>                 skin thickness [m].</li><li><code>skin_k::Float64</code>                 skin thermal conductivity [W m-1 K-1].</li><li><code>overlap_method::String</code>          gaseous overlap scheme (ro: rand overlap, ee: equiv extinct, rorr: ro+resort+rebin).</li><li><code>target_olr::Float64</code>             target OLR [W m-2] for sol_type==4.</li><li><code>flux_int::Float64</code>               planet&#39;s internal flux for sol_type==3.</li><li><code>all_channels::Bool</code>              use all channels available for RT?</li><li><code>flag_rayleigh::Bool</code>             include rayleigh scattering?</li><li><code>flag_gcontinuum::Bool</code>           include generalised continuum absorption?</li><li><code>flag_continuum::Bool</code>            include continuum absorption?</li><li><code>flag_aerosol::Bool</code>              include aersols?</li><li><code>flag_cloud::Bool</code>                include clouds?</li><li><code>real_gas::Bool</code>                  use real gas EOS where possible</li><li><code>thermo_functions::Bool</code>          use temperature-dependent thermodynamic properties</li><li><code>use_all_gases::Bool</code>             store information on all supported gases, incl those not provided in cfg</li></ul><p>Returns:     Nothing</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L245-L296">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.atmosphere.water_cloud!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.atmosphere.water_cloud!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.atmosphere.water_cloud!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Manually set water cloud properties at saturated levels.</strong></p><p>Uses the default mass mixing ratio, area fraction, and droplet sizes. This function is redundant if condensation is done via <code>chemsitry.handle_saturation!()</code>.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/atmosphere.jl#L1644-L1652">source</a></section></article><h3 id="Energy-flux-evaluation"><a class="docs-heading-anchor" href="#Energy-flux-evaluation">Energy flux evaluation</a><a id="Energy-flux-evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-flux-evaluation" title="Permalink"></a></h3><p>Functions from <code>energy.jl</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.energy.calc_fluxes!-Tuple{AGNI.atmosphere.Atmos_t, Vararg{Bool, 4}}" href="#AGNI.energy.calc_fluxes!-Tuple{AGNI.atmosphere.Atmos_t, Vararg{Bool, 4}}"><code>AGNI.energy.calc_fluxes!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Calculate energy flux at each level.</strong></p><p>Calculates flux components (radtrans, convection, etc.) and sums them to get total flux. Also updates thermodynamic properties (heat capacity, density, etc.) at each layer.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>                  the atmosphere struct instance to be used.</li><li><code>latent::Bool</code>                    include condensation flux</li><li><code>convect::Bool</code>                   include MLT convection flux</li><li><code>sens_heat::Bool</code>                 include TKE sensible heat transport</li><li><code>conduct::Bool</code>                   include conductive heat transport</li><li><code>convect_sf::Float64</code>             scale factor applied to convection fluxes</li><li><code>latent_sf::Float64</code>              scale factor applied to phase change fluxes</li><li><code>calc_cf::Bool</code>                   calculate LW contribution function?</li><li><code>rainout::Bool</code>                   allow rainout ( do not reset VMRs to dry values )</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/energy.jl#L698-L714">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.energy.calc_hrates!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.energy.calc_hrates!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.calc_hrates!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Calculate heating rates at cell-centres from the total flux.</strong></p><p>Requires the total flux to have already been set (atmos.flux_tot). Heating rates are calculated in units of kelvin per day.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>                  the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/energy.jl#L787-L795">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.energy.condense_diffuse!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.energy.condense_diffuse!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.condense_diffuse!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Analytical diffusion scheme for condensation and evaporation energy.</strong></p><p>Integrates from bottom of model upwards. Based on the amount of phase change at each level, a phase change flux is calculated by assuming a fixed condensation timescale.</p><p>Updates fluxes. Requires <code>chemistry.handle_saturation</code> to be called first in the multi-component case.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/energy.jl#L494-L506">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.energy.convection!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.energy.convection!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.convection!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Calculate dry convective fluxes using mixing length theory.</strong></p><p>Uses the mixing length formulation outlined by Joyce &amp; Tayar (2023), which was also implemented in Lee et al. (2024), and partially outlined in an earlier paper by Robinson &amp; Marley (2014).</p><p>https://arxiv.org/abs/2303.09596 https://doi.org/10.1093/mnras/stae537 https://ui.adsabs.harvard.edu/abs/1962JGR....67.3095B/abstract</p><p>Convective energy transport fluxes are calculated at every level edge, just like the radiative fluxes. This is not compatible with moist convection. By using MLT to parameterise convection, we can also calculate Kzz directly.</p><p>The mixing length is set to asymptotically approach H (for z&gt;&gt;H) or z (for z&lt;H) as per Blackadar (1962). Alternatively, it can be set equal to H.</p><p>The scale height is formulated as:     <code>Hp = P / (ρ g)</code> The adiabatic lapse rate is formulated as:     <code>∇_ad = dln(T)/dln(P) = (P/T)*(dT/dP) = (P/T)*(1/[ρ c_p])</code> for an ideal gas, this becomes:     <code>∇_ad = R / (μ c_p)</code></p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</li><li><code>pmin::Float64</code>           pressure [bar] below which convection is disabled</li><li><code>mltype::Int</code>             mixing length value (1: scale height, 2: asymptotic)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/energy.jl#L309-L339">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.energy.fill_Kzz!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.energy.fill_Kzz!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.fill_Kzz!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Fill Kzz values for the entire profile.</strong></p><p>This function is called after the convection scheme has been run.</p><p>The Kzz value in the convective region (and below) are set equal to the maximum value in the convective region, as calculated by MLT. The value increases with power-law scaling with pressure in the stratosphere.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>          the atmosphere struct instance to be used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/energy.jl#L437-L448">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.energy.radtrans!-Tuple{AGNI.atmosphere.Atmos_t, Bool}" href="#AGNI.energy.radtrans!-Tuple{AGNI.atmosphere.Atmos_t, Bool}"><code>AGNI.energy.radtrans!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Calculate radiative fluxes using SOCRATES.</strong></p><p>Uses the configuration inside the atmos struct. Can either do LW or SW calculation as required. Imports SOCRATES wrapper from the atmosphere module, rather than loading it twice.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>                  the atmosphere struct instance to be used.</li><li><code>lw::Bool</code>                        longwave calculation? Else: shortwave</li><li><code>calc_cf::Bool=false</code>             also calculate contribution function?</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/energy.jl#L23-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.energy.reset_fluxes!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.energy.reset_fluxes!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.reset_fluxes!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Reset energy fluxes to zero.</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/energy.jl#L650-L652">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.energy.restore_composition!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.energy.restore_composition!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.energy.restore_composition!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Reset mixing ratios to their original values</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/energy.jl#L689-L691">source</a></section></article><h3 id="Numerical-solver"><a class="docs-heading-anchor" href="#Numerical-solver">Numerical solver</a><a id="Numerical-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-solver" title="Permalink"></a></h3><p>Functions from <code>solver.jl</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.solver.gs_search-Tuple{Function, Float64, Float64, Float64, Float64, Int64}" href="#AGNI.solver.gs_search-Tuple{Function, Float64, Float64, Float64, Float64, Int64}"><code>AGNI.solver.gs_search</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Golden section search algorithm</strong></p><p>Minimises a function <code>f</code> between the bounds <code>a</code> and <code>b</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/solver.jl#L23-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.solver.solve_energy!-Tuple{AGNI.atmosphere.Atmos_t}" href="#AGNI.solver.solve_energy!-Tuple{AGNI.atmosphere.Atmos_t}"><code>AGNI.solver.solve_energy!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Obtain radiative-convective equilibrium using a matrix method.</strong></p><p>Solves the non-linear system of equations defined by the flux field divergence, minimising flux loss across a cell by iterating the temperature profile.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>                  the atmosphere struct instance to be used.</li><li><code>sol_type::Int</code>                   solution type, 1: tmp<em>surf | 2: skin | 3: flux</em>int | 4: tgt_olr</li><li><code>chem_type::Int</code>                  chemistry type (see wiki)</li><li><code>convect::Bool</code>                   include convection</li><li><code>sens_heat::Bool</code>                 include sensible heating at the surface</li><li><code>conduct::Bool</code>                   include conductive heat transport within the atmosphere</li><li><code>latent::Bool</code>                    include latent heat exchange (condensation/evaporation)</li><li><code>rainout::Bool</code>                   allow rainout (phase change impacts mixing ratios, not just energy fluxes)</li><li><code>dx_max::Float64</code>                 maximum step size [K]</li><li><code>max_steps::Int</code>                  maximum number of solver steps</li><li><code>max_runtime::Float64</code>            maximum runtime in wall-clock seconds</li><li><code>fdw::Float64</code>                    finite difference: relative width (dx/x) of the &quot;difference&quot;</li><li><code>fdc::Bool</code>                       finite difference: ALWAYS use central difference?</li><li><code>fdo::Int</code>                        finite difference: scheme order (2nd or 4th)</li><li><code>method::Int</code>                     numerical method (1: Newton-Raphson, 2: Gauss-Newton, 3: Levenberg-Marquardt)</li><li><code>ls_method::Int</code>                  linesearch algorithm (0: None, 1: golden, 2: backtracking)</li><li><code>easy_start::Bool</code>                improve convergence by introducing convection and phase change gradually</li><li><code>perturb_all::Bool</code>               always recalculate entire Jacobian matrix? Otherwise updates columns only as required</li><li><code>ls_increase::Bool</code>               factor by which the cost can increase from last step before triggering linesearch</li><li><code>detect_plateau::Bool</code>            assist solver when it is stuck in a region of small dF/dT</li><li><code>modplot::Int</code>                    iteration frequency at which to make plots</li><li><code>save_frames::Bool</code>               save plotting frames</li><li><code>modprint::Int</code>                   iteration frequency at which to print info</li><li><code>plot_jacobian::Bool</code>             plot jacobian too?</li><li><code>conv_atol::Float64</code>              convergence: absolute tolerance on per-level flux deviation [W m-2]</li><li><code>conv_rtol::Float64</code>              convergence: relative tolerance on per-level flux deviation [dimensionless]</li></ul><p>Returns:     Nothing</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/solver.jl#L66-L103">source</a></section></article><h3 id="Plotting-functions-and-utilities"><a class="docs-heading-anchor" href="#Plotting-functions-and-utilities">Plotting functions and utilities</a><a id="Plotting-functions-and-utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-functions-and-utilities" title="Permalink"></a></h3><p>Functions from <code>plotting.jl</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.plotting.animate" href="#AGNI.plotting.animate"><code>AGNI.plotting.animate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Animate output frames from solver, using ffmpeg</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/plotting.jl#L653-L655">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.plotting.combined-Tuple{Any, Any, Any, String, String}" href="#AGNI.plotting.combined-Tuple{Any, Any, Any, String, String}"><code>AGNI.plotting.combined</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Combined plot used for tracking behaviour of the solver</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/plotting.jl#L635-L637">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.plotting.jacobian-Tuple{Matrix{Float64}, String}" href="#AGNI.plotting.jacobian-Tuple{Matrix{Float64}, String}"><code>AGNI.plotting.jacobian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Plot jacobian matrix</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/plotting.jl#L674-L676">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.plotting.plot_albedo-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.plotting.plot_albedo-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_albedo</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Plot spectral albedo (ratio of SW<em>UP to SW</em>DN)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/plotting.jl#L601-L603">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.plotting.plot_cloud-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.plotting.plot_cloud-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_cloud</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Plot the cloud mass mixing ratio and area fraction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/plotting.jl#L143-L145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.plotting.plot_contfunc1-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.plotting.plot_contfunc1-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_contfunc1</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Plot contribution function at different bands.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/plotting.jl#L443-L445">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.plotting.plot_contfunc2-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.plotting.plot_contfunc2-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_contfunc2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Plot normalised contribution function (per band)</p><p>The data displayed in this plot are fine, but the x-axis ticks are labelled incorrectly by the plotting library. I don&#39;t know why this is.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/plotting.jl#L525-L530">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.plotting.plot_emission-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.plotting.plot_emission-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_emission</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Plot emission spectrum at the TOA</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/plotting.jl#L379-L381">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.plotting.plot_fluxes-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.plotting.plot_fluxes-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_fluxes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Plot the fluxes at each pressure level</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/plotting.jl#L261-L263">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.plotting.plot_pt-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.plotting.plot_pt-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_pt</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Plot the temperature-pressure profile.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/plotting.jl#L43-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.plotting.plot_radius-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.plotting.plot_radius-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_radius</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Plot the radius vs pressure profile.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/plotting.jl#L107-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.plotting.plot_vmr-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.plotting.plot_vmr-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.plotting.plot_vmr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Plot the VMRs of the atmosphere at each cell-centre location.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/plotting.jl#L185-L187">source</a></section></article><h3 id="File-I/O-modules"><a class="docs-heading-anchor" href="#File-I/O-modules">File I/O modules</a><a id="File-I/O-modules-1"></a><a class="docs-heading-anchor-permalink" href="#File-I/O-modules" title="Permalink"></a></h3><p>Functions from <code>save.jl</code> and <code>load.jl</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.save.write_fluxes-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.save.write_fluxes-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.save.write_fluxes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Write cell-edge energy fluxes to a CSV file</p><p>Arguments</p><ul><li><code>atmos::Atmos_t</code>      Atmosphere object</li><li><code>fname::String</code>       Filename to write to</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/save.jl#L50-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.save.write_ncdf-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.save.write_ncdf-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.save.write_ncdf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Write verbose atmosphere data to a NetCDF file</p><p>Arguments</p><ul><li><code>atmos::Atmos_t</code>      Atmosphere object</li><li><code>fname::String</code>       Filename to write to</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/save.jl#L80-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.save.write_profile-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.save.write_profile-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.save.write_profile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Write {Pressure, Temperature, Radius} profile to a CSV file</p><p>Arguments</p><ul><li><code>atmos::Atmos_t</code>      Atmosphere object</li><li><code>fname::String</code>       Filename to write to</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/save.jl#L23-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AGNI.load.load_ncdf!-Tuple{AGNI.atmosphere.Atmos_t, String}" href="#AGNI.load.load_ncdf!-Tuple{AGNI.atmosphere.Atmos_t, String}"><code>AGNI.load.load_ncdf!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>Load atmosphere data from a NetCDF file.</strong></p><p>This must be called after setup! and allocate! have been called on this atmos struct. Does not overwrite energy fluxes within the atmospherem, or other wavelength-dependent properties. Only composition, temperatures, layer properties, and boundary conditions are updated by this function.</p><p>Arguments:</p><ul><li><code>atmos::Atmos_t</code>      the atmosphere struct instance to be used.</li><li><code>fname::String</code>       path to the NetCDF file</li></ul><p>Returns:</p><ul><li><code>ok::Bool</code>            loaded ok?</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nichollsh/AGNI/blob/606b14e02114185569ca2af493fcc09e8d606453/src/load.jl#L17-L31">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../troubleshooting/">« Troubleshooting</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Wednesday 23 April 2025 19:08">Wednesday 23 April 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
