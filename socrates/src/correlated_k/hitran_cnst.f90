! *****************************COPYRIGHT*******************************
! (C) Crown copyright Met Office. All rights reserved.
! For further details please refer to the file COPYRIGHT.txt
! which you should have received as part of this distribution.
! *****************************COPYRIGHT*******************************
!
!+ Constants for HITRAN molecules and isotopes
!
!- ---------------------------------------------------------------
MODULE hitran_cnst

  USE realtype_rd, ONLY: RealK

  IMPLICIT NONE


  INTEGER, Parameter :: number_molecules = 55
  INTEGER, Parameter :: number_species   = 145
  INTEGER, Parameter :: number_temperatures = 5000 ! 1 - 5000K for qcoeff

  CHARACTER(LEN=6), Parameter, DIMENSION(number_molecules) :: molecule_names = &
    (/"   H2O", "   CO2", "    O3", "   N2O", "    CO", "   CH4", "    O2", & !  1-7
      "    NO", "   SO2", "   NO2", "   NH3", "  HNO3", "    OH", "    HF", & !  8-14
      "   HCl", "   HBr", "    HI", "   ClO", "   OCS", "  H2CO", "  HOCl", & ! 15-21
      "    N2", "   HCN", " CH3Cl", "  H2O2", "  C2H2", "  C2H6", "   PH3", & ! 22-28
      "  COF2", "   SF6", "   H2S", " HCOOH", "   HO2", "     O", "ClONO2", & ! 29-35
      "   NO+", "  HOBr", "  C2H4", " CH3OH", " CH3Br", " CH3CN", "   CF4", & ! 36-42
      "  C4H2", "  HC3N", "    H2", "    CS", "   SO3", "  C2N2", " COCl2", & ! 43-49
      "    SO", "  CH3F", "  GeH4", "   CS2", "  CH3I", "   NF3" /)           ! 50-55


  INTEGER, Parameter, DIMENSION(1:number_molecules) :: number_isotopes = &
    (/ 7, 12,  5,  5,  6,  4,  3, &
       3,  4,  2,  2,  2,  3,  2, &
       4,  4,  2,  2,  6,  3,  2, &
       2,  3,  2,  1,  3,  2,  1, &
       2,  1,  3,  1,  1,  1,  2, &
       1,  2,  2,  1,  2,  1,  1, &
       1,  1,  2,  4,  1,  1,  2, &
       3,  1,  5,  4,  1,  1 /)

  INTEGER, Parameter, DIMENSION(1:number_species) :: global_id = &
    (/   1,   2,   3,   4,   5,   6, 129,                          & !  1: H2O
         7,   8,   9,  10,  11,  12,  13,  14, 121,  15, 120, 122, & !  2: CO2
        16,  17,  18,  19,  20,                                    & !  3: O3
        21,  22,  23,  24,  25,                                    & !  4: N2O
        26,  27,  28,  29,  30,  31,                               & !  5: CO
        32,  33,  34,  35,                                         & !  6: CH4
        36,  37,  38,                                              & !  7: O2
        39,  40,  41,                                              & !  8: NO
        42,  43, 137, 138,                                         & !  9: SO2
        44, 130,                                                   & ! 10: NO2
        45,  46,                                                   & ! 11: NH3
        47, 117,                                                   & ! 12: HNO3
        48,  49,  50,                                              & ! 13: OH
        51, 110,                                                   & ! 14: HF
        52,  53, 107, 108,                                         & ! 15: HCl
        54,  55, 111, 112,                                         & ! 16: HBr
        56, 113,                                                   & ! 17: HI
        57,  58,                                                   & ! 18: ClO
        59,  60,  61,  62,  63, 135,                               & ! 19: OCS
        64,  65,  66,                                              & ! 20: H2CO
        67,  68,                                                   & ! 21: HOCl
        69, 118,                                                   & ! 22: N2
        70,  71,  72,                                              & ! 23: HCN
        73,  74,                                                   & ! 24: CH3Cl
        75,                                                        & ! 25: H2O2
        76,  77, 105,                                              & ! 26: C2H2
        78, 106,                                                   & ! 27: C2H6
        79,                                                        & ! 28: PH3
        80, 119,                                                   & ! 29: COF2
       126,                                                        & ! 30: SF6
        81,  82,  83,                                              & ! 31: H2S
        84,                                                        & ! 32: HCOOH
        85,                                                        & ! 33: HO2
        86,                                                        & ! 34: O
       127, 128,                                                   & ! 35: ClONO2
        87,                                                        & ! 36: NO+
        88,  89,                                                   & ! 37: HOBr
        90,  91,                                                   & ! 38: C2H4
        92,                                                        & ! 39: CH3OH
        93,  94,                                                   & ! 40: CH3Br
        95,                                                        & ! 41: CH3CN
        96,                                                        & ! 42: CF4
       116,                                                        & ! 43: C4H2
       109,                                                        & ! 44: HC3N
       103, 115,                                                   & ! 45: H2
        97,  98,  99, 100,                                         & ! 46: CS
       114,                                                        & ! 47: SO3
       123,                                                        & ! 48: C2N2
       124, 125,                                                   & ! 49: COCl2
       146, 147, 148,                                              & ! 50: SO
       144,                                                        & ! 51: CH3F
       139, 140, 141, 142, 143,                                    & ! 52: GeH4
       131, 132, 133, 134,                                         & ! 53: CS2
       145,                                                        & ! 54: CH3I
       136 /)                                                        ! 55: NF3   

  REAL(RealK), Parameter, DIMENSION(1:number_species) :: iso_abundance = &
    (/ 9.97317E-01, 1.99983E-03, 3.71884E-04, 3.10693E-04, 6.23003E-07, & !  1: H2O
       1.15853E-07, 2.41974E-08, &
       9.84204E-01, 1.10574E-02, 3.94707E-03, 7.33989E-04, 4.43446E-05, & !  2: CO2
       8.24623E-06, 3.95734E-06, 1.47180E-06, 1.36847E-07, 4.44600E-08, &
       1.65354E-08, 1.53745E-09, &
       9.92901E-01, 3.98194E-03, 1.99097E-03, 7.40475E-04, 3.70237E-04, & !  3: O3    
       9.90333E-01, 3.64093E-03, 3.64093E-03, 1.98582E-03, 3.69280E-04, & !  4: N2O   
       9.86544E-01, 1.10836E-02, 1.97822E-03, 3.67867E-04, 2.22250E-05, & !  5: CO
       4.13292E-06, &
       9.88274E-01, 1.11031E-02, 6.15751E-04, 6.91785E-06, &              !  6: CH4   
       9.95262E-01, 3.99141E-03, 7.42235E-04, &                           !  7: O2    
       9.93974E-01, 3.65431E-03, 1.99312E-03, &                           !  8: NO    
       9.45678E-01, 4.19503E-02, 7.46446E-03, 3.79256E-03, &              !  9: SO2   
       9.91616E-01, 3.64564E-03, &                                        ! 10: NO2   
       9.95872E-01, 3.66129E-03, &                                        ! 11: NH3   
       9.89110E-01, 3.63643E-03, &                                        ! 12: HNO3  
       9.97473E-01, 2.00014E-03, 1.55371E-04, &                           ! 13: OH    
       9.99844E-01, 1.55741E-04, &                                        ! 14: HF    
       7.57587E-01, 2.42257E-01, 1.18005E-04, 3.77350E-05, &              ! 15: HCl   
       5.06781E-01, 4.93063E-01, 7.89384E-05, 7.68016E-05, &              ! 16: HBr   
       9.99844E-01, 1.55741E-04, &                                        ! 17: HI    
       7.55908E-01, 2.41720E-01, &                                        ! 18: ClO   
       9.37395E-01, 4.15828E-02, 1.05315E-02, 7.39908E-03, 1.87967E-03, & ! 19: OCS
       4.67176E-04, &
       9.86237E-01, 1.10802E-02, 1.97761E-03, &                           ! 20: H2CO  
       7.55790E-01, 2.41683E-01, &                                        ! 21: HOCl  
       9.92687E-01, 7.29916E-03, &                                        ! 22: N2    
       9.85114E-01, 1.10676E-02, 3.62174E-03, &                           ! 23: HCN   
       7.48937E-01, 2.39491E-01, &                                        ! 24: CH3Cl 
       9.94952E-01, &                                                     ! 25: H2O2  
       9.77599E-01, 2.19663E-02, 3.04550E-04, &                           ! 26: C2H2  
       9.76990E-01, 2.19526E-02, &                                        ! 27: C2H6  
       9.99533E-01, &                                                     ! 28: PH3   
       9.86544E-01, 1.10837E-02, &                                        ! 29: COF2  
       9.50180E-01, &                                                     ! 30: SF6   
       9.49884E-01, 4.21369E-02, 7.49766E-03, &                           ! 31: H2S   
       9.83898E-01, &                                                     ! 32: HCOOH 
       9.95107E-01, &                                                     ! 33: HO2   
       9.97628E-01, &                                                     ! 34: O     
       7.49570E-01, 2.39694E-01, &                                        ! 35: ClONO2
       9.93974E-01, &                                                     ! 36: NO+   
       5.05579E-01, 4.91894E-01, &                                        ! 37: HOBr  
       9.77294E-01, 2.19595E-02, &                                        ! 38: C2H4  
       9.85930E-01, &                                                     ! 39: CH3OH 
       5.00995E-01, 4.87433E-01, &                                        ! 40: CH3Br 
       9.73866E-01, &                                                     ! 41: CH3CN 
       9.88890E-01, &                                                     ! 42: CF4   
       9.55998E-01, &                                                     ! 43: C4H2  
       9.63346E-01, &                                                     ! 44: HC3N  
       9.99688E-01, 3.11432E-04, &                                        ! 45: H2    
       9.39624E-01, 4.16817E-02, 1.05565E-02, 7.41668E-03, &              ! 46: CS    
       9.43434E-01, &                                                     ! 47: SO3   
       9.70752E-01, &                                                     ! 48: C2N2  
       5.66392E-01, 3.62235E-01, &                                        ! 49: COCl2 
       9.47926E-01, 4.20500E-02, 1.90079E-03, &                           ! 50: SO    
       9.88428E-01, &                                                     ! 51: CH3F  
       3.65172E-01, 2.74129E-01, 2.05072E-01, 7.75517E-02, 7.75517E-02, & ! 52: GeH4  
       8.92811E-01, 7.92103E-02, 1.40944E-02, 1.00306E-02, &              ! 53: CS2   
       9.88428E-01, &                                                     ! 54: CH3I  
       9.96337E-01 /)                                                     ! 55: NF3   

  REAL(RealK), Parameter, DIMENSION(1:number_species) :: q296 = &
    (/ 1.7458E+02, 1.7605E+02, 1.0521E+03, 8.6474E+02, 8.7557E+02, & !  1: H2O   
       5.2268E+03, 1.0278E+03, &                                                 
       2.8609E+02, 5.7664E+02, 6.0781E+02, 3.5426E+03, 1.2255E+03, & !  2: CO2   
       7.1413E+03, 3.2342E+02, 3.7666E+03, 1.0972E+04, 6.5224E+02, &             
       7.5950E+03, 2.2120E+04, &                                                 
       3.4750E+03, 7.5846E+03, 3.7030E+03, 4.4044E+04, 2.1742E+04, & !  3: O3    
       4.9849E+03, 3.3616E+03, 3.4580E+03, 5.3135E+03, 3.0966E+04, & !  4: N2O   
       1.0742E+02, 2.2469E+02, 1.1277E+02, 6.6117E+02, 2.3644E+02, & !  5: CO    
       1.3847E+03, &
       5.9053E+02, 1.1811E+03, 4.7947E+03, 9.6010E+03, &             !  6: CH4   
       2.1573E+02, 4.5523E+02, 2.6581E+03, &                         !  7: O2    
       1.1411E+03, 7.8831E+02, 1.1825E+03, &                         !  8: NO    
       6.3391E+03, 6.3678E+03, 2.5607E+04, 1.3681E+04, &             !  9: SO2   
       1.3575E+04, 9.2929E+03, &                                     ! 10: NO2   
       1.7252E+03, 1.1533E+03, &                                     ! 11: NH3   
       2.1393E+05, 1.4313E+05, &                                     ! 12: HNO3  
       8.0348E+01, 8.0881E+01, 2.0931E+02, &                         ! 13: OH    
       4.1469E+01, 1.1591E+02, &                                     ! 14: HF    
       1.6065E+02, 1.6089E+02, 4.6278E+02, 4.6413E+02, &             ! 15: HCl   
       2.0017E+02, 2.0023E+02, 5.8640E+02, 5.8676E+02, &             ! 16: HBr   
       3.8899E+02, 1.1471E+03, &                                     ! 17: HI    
       3.2918E+03, 3.3492E+03, &                                     ! 18: ClO   
       1.2207E+03, 1.2531E+03, 2.4835E+03, 4.9487E+03, 1.3134E+03, & ! 19: OCS   
       2.5465E+03, &                                                             
       2.8445E+03, 5.8368E+03, 2.9860E+03, &                         ! 20: H2CO  
       1.9272E+04, 1.9613E+04, &                                     ! 21: HOCl  
       4.6710E+02, 6.4410E+02, &                                     ! 22: N2    
       8.9220E+02, 1.8310E+03, 6.1528E+02, &                         ! 23: HCN   
       5.7915E+04, 5.8832E+04, &                                     ! 24: CH3Cl 
       9.8480E+03, &                                                 ! 25: H2O2  
       4.1245E+02, 1.6557E+03, 1.5937E+03, &                         ! 26: C2H2  
       7.0873E+04, 3.6183E+04, &                                     ! 27: C2H6  
       3.2494E+03, &                                                 ! 28: PH3   
       7.0028E+04, 1.4006E+05, &                                     ! 29: COF2  
       1.6110E+06, &                                                 ! 30: SF6   
       5.0579E+02, 5.0428E+02, 2.0147E+03, &                         ! 31: H2S   
       3.9124E+04, &                                                 ! 32: HCOOH 
       4.2998E+03, &                                                 ! 33: HO2   
       6.7212E+00, &                                                 ! 34: O     
       4.7864E+06, 4.9082E+06, &                                     ! 35: ClONO2
       3.1166E+02, &                                                 ! 36: NO+   
       2.8335E+04, 2.8233E+04, &                                     ! 37: HOBr  
       1.1042E+04, 4.5231E+04, &                                     ! 38: C2H4  
       7.0570E+04, &                                                 ! 39: CH3OH 
       8.3049E+04, 8.3392E+04, &                                     ! 40: CH3Br 
       8.8659E+04, &                                                 ! 41: CH3CN 
       1.2686E+05, &                                                 ! 42: CF4   
       9.8215E+03, &                                                 ! 43: C4H2  
       2.4711E+04, &                                                 ! 44: HC3N  
       7.6712E+00, 2.9874E+01, &                                     ! 45: H2    
       2.5318E+02, 2.5774E+02, 5.3745E+02, 1.0229E+03, &             ! 46: CS    
       7.7833E+03, &                                                 ! 47: SO3   
       1.5585E+04, &                                                 ! 48: C2N2  
       1.4800E+06, 3.0435E+06, &                                     ! 49: COCl2 
       8.4288E+02, 8.5973E+02, 9.1052E+02, &                         ! 50: SO    
       1.4707E+04, &                                                 ! 51: CH3F  
       1.6341E+03, 1.6340E+03, 1.6340E+03, 1.6341E+04, 1.6341E+03, & ! 52: GeH4  
       1.7187E+03, 2.7975E+03, 1.1009E+04, 3.5614E+03, &             ! 53: CS2   
       1.6427E+05, &                                                 ! 54: CH3I  
       3.4773E+05 /)                                                 ! 55: NF3   


  REAL(RealK), DIMENSION(1:number_temperatures,1:number_species) :: qcoeff
! Total internal partition sums for 1 <= T <= 5000 K range, read from parsum.dat file
! using internal subroutine read_parsum_dat.


  REAL(RealK), Parameter, DIMENSION(1:number_species) :: iso_mass = &
    (/  18.010565,  20.014811,  19.014780,  19.016740,  21.020985,  & !  1: H2O   
        20.020956,  20.022915,  &                                                 
        43.989830,  44.993185,  45.994076,  44.994045,  46.997431,  & !  2: CO2   
        45.997400,  47.998320,  46.998291,  45.998262,  49.001675,  &             
        48.001646,  47.001618,  &                                                 
        47.984745,  49.988991,  49.988991,  48.988960,  48.988960,  & !  3: O3    
        44.001062,  44.998096,  44.998096,  46.005308,  45.005278,  & !  4: N2O   
        27.994915,  28.998270,  29.999161,  28.999130,  31.002516,  & !  5: CO    
        30.002485,  &
        16.031300,  17.034655,  17.037475,  18.040830,  &             !  6: CH4   
        31.989830,  33.994076,  32.994045,  &                         !  7: O2    
        29.997989,  30.995023,  32.002234,  &                         !  8: NO    
        63.961901,  65.957695,  64.961286,  65.966146,  &             !  9: SO2   
        45.992904,  46.989938,  &                                     ! 10: NO2   
        17.026549,  18.023583,  &                                     ! 11: NH3   
        62.995644,  63.992678,  &                                     ! 12: HNO3  
        17.002740,  19.006986,  18.008915,  &                         ! 13: OH    
        20.006229,  21.012404,  &                                     ! 14: HF    
        35.976678,  37.973729,  36.982853,  38.979904,  &             ! 15: HCl   
        79.926160,  81.924115,  80.932336,  82.930289,  &             ! 16: HBr   
       127.912297, 128.918472,  &                                     ! 17: HI    
        50.963768,  52.960819,  &                                     ! 18: ClO   
        59.966986,  61.962780,  60.970341,  60.966371,  61.971231,  & ! 19: OCS   
        62.966137,  &                                                             
        30.010565,  31.013920,  32.014811,  &                         ! 20: H2CO  
        51.971593,  53.968644,  &                                     ! 21: HOCl  
        28.006148,  29.003182,  &                                     ! 22: N2    
        27.010899,  28.014254,  28.007933,  &                         ! 23: HCN   
        49.992328,  51.989379,  &                                     ! 24: CH3Cl 
        34.005480,  &                                                 ! 25: H2O2  
        26.015650,  27.019005,  27.021825,  &                         ! 26: C2H2  
        30.046950,  31.050305,  &                                     ! 27: C2H6  
        33.997241,  &                                                 ! 28: PH3   
        65.991722,  66.995078, &                                      ! 29: COF2  
       145.962494,  &                                                 ! 30: SF6   
        33.987721,  35.983515,  34.987105,  &                         ! 31: H2S   
        46.005480,  &                                                 ! 32: HCOOH 
        32.997655,  &                                                 ! 33: HO2   
        15.994915,  &                                                 ! 34: O     
        96.956672,  98.953723,  &                                     ! 35: ClONO2
        29.997989,  &                                                 ! 36: NO+   
        95.921076,  97.919030,  &                                     ! 37: HOBr  
        28.031300,  29.034655,  &                                     ! 38: C2H4  
        32.026215,  &                                                 ! 39: CH3OH 
        93.941811,  95.939764,  &                                     ! 40: CH3Br 
        41.026549,  &                                                 ! 41: CH3CN 
        87.993616,  &                                                 ! 42: CF4   
        50.015650,  &                                                 ! 43: C4H2  
        51.010899,  &                                                 ! 44: HC3N  
         2.015650,   3.021825,  &                                     ! 45: H2    
        43.972070,  45.967866,  44.975425,  44.971456,  &             ! 46: CS    
        79.956815,  &                                                 ! 47: SO3   
        52.006148,  &                                                 ! 48: C2N2  
        97.932620,  99.929672,  &                                     ! 49: COCl2 
        47.966986,  49.962782,  49.971231,  &                         ! 50: SO    
        34.021878,  &                                                 ! 51: CH3F  
        77.952479,  75.953380,  73.955550,  76.954764,  79.952703,  & ! 52: GeH4  
        75.944140,  77.939936,  76.943526,  76.947495,  &             ! 53: CS2   
       141.927947,  &                                                 ! 54: CH3I  
        70.998286 /)                                                  ! 55: NF3   


  REAL  (RealK), PARAMETER :: &  ! Physical constants
       speed_of_light     = 2.997925E8,   & ! m s-1
       boltzmann_constant = 1.380622E-23, & ! J K-1
       planck_constant    = 6.626196E-34, & ! J s
       avogadro_number    = 6.022169E23,  & ! mol-1
       atomic_mass_unit   = 1.660531E-27, & ! kg
       molar_gas_constant = 8.31434E0,    & ! J mol-1 K-1
       c1                 = 2.0*planck_constant*speed_of_light * &
                                speed_of_light, & ! W m2
       c2                 = planck_constant*speed_of_light / &
                            boltzmann_constant, & ! m K
       PI                 = 3.1415926   

CONTAINS

  SUBROUTINE read_parsum_dat

    IMPLICIT NONE

    INTEGER :: ierr, iu_parsum, i, ios
    REAL(RealK) :: temp
    CHARACTER (LEN=2917) :: line

    CALL get_free_unit(ierr, iu_parsum)
    CALL open_file_in(ierr, iu_parsum, 'Enter location of parsum.dat.')
    READ(iu_parsum, '(a)', iostat=ios) line
    DO i=1, number_temperatures
      READ(iu_parsum, '(f6.1,f20.6,999f27.6)', iostat=ios) temp, qcoeff(i,:)
    END DO
    CLOSE(iu_parsum)

  END SUBROUTINE read_parsum_dat

END MODULE hitran_cnst
