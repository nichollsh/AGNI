! *****************************COPYRIGHT*******************************
! (C) Crown copyright Met Office. All rights reserved.
! For further details please refer to the file COPYRIGHT.txt
! which you should have received as part of this distribution.
! *****************************COPYRIGHT*******************************
! Module to store Legendre polynomial terms and cosine half 
! viewing angles
!
!- -------------------------------------------------------------------- 
MODULE legendre_mod 
!
!
  USE realtype_rd, ONLY: RealK

IMPLICIT NONE
!
!
  INTEGER, PARAMETER :: nstream = 32 
!       Number of stream for legendre expansion
 REAL (RealK) :: cos_half_angle(1:20)=(/&
 &0.999990480720734,0.999961923064171,0.999914327574007,0.999847695156391,0.999762027079909,&
 &0.999657324975557,0.999533590836713,0.999390827019096,0.999229036240723,0.999048221581858,&
 &0.998848386484951,0.998629534754574,0.998391670557349,0.998134798421867,0.997858923238603,&
 &0.997564050259824,0.997250185099486,0.996917333733128,0.996565502497761,0.996194698091746/)
! 20 half angles ranged between 0.25 and 5 with increment of 0.25
! p_legendre holds 32 stream p_l for 20 scattering angles. 
! In circumsolar_fraction.F90, it
! changes to 2D array p_legendre_2d(32,20)
 REAL (RealK) :: p_legendre(1:640)=(/&
&9.999905E-01,9.999714E-01,9.999429E-01,9.999048E-01,9.998572E-01,9.998001E-01,9.997335E-01,9.996573E-01,&
&9.995717E-01,9.994765E-01,9.993718E-01,9.992576E-01,9.991339E-01,9.990007E-01,9.988580E-01,9.987058E-01,&
&9.985441E-01,9.983729E-01,9.981922E-01,9.980019E-01,9.978022E-01,9.975931E-01,9.973744E-01,9.971462E-01,&
&9.969086E-01,9.966615E-01,9.964049E-01,9.961389E-01,9.958634E-01,9.955784E-01,9.952840E-01,9.949801E-01,&
&9.999619E-01,9.998858E-01,9.997715E-01,9.996193E-01,9.994289E-01,9.992005E-01,9.989341E-01,9.986297E-01,&
&9.982873E-01,9.979068E-01,9.974885E-01,9.970322E-01,9.965380E-01,9.960059E-01,9.954359E-01,9.948282E-01,&
&9.941827E-01,9.934994E-01,9.927784E-01,9.920197E-01,9.912235E-01,9.903896E-01,9.895182E-01,9.886094E-01,&
&9.876631E-01,9.866795E-01,9.856585E-01,9.846003E-01,9.835048E-01,9.823723E-01,9.812026E-01,9.799960E-01,&
&9.999143E-01,9.997430E-01,9.994860E-01,9.991434E-01,9.987153E-01,9.982016E-01,9.976026E-01,9.969181E-01,&
&9.961484E-01,9.952935E-01,9.943535E-01,9.933286E-01,9.922188E-01,9.910244E-01,9.897455E-01,9.883822E-01,&
&9.869347E-01,9.854033E-01,9.837880E-01,9.820892E-01,9.803069E-01,9.784416E-01,9.764933E-01,9.744624E-01,&
&9.723491E-01,9.701537E-01,9.678764E-01,9.655176E-01,9.630775E-01,9.605565E-01,9.579549E-01,9.552730E-01,&
&9.998477E-01,9.995431E-01,9.990863E-01,9.984775E-01,9.977166E-01,9.968040E-01,9.957398E-01,9.945243E-01,&
&9.931578E-01,9.916404E-01,9.899727E-01,9.881550E-01,9.861877E-01,9.840712E-01,9.818061E-01,9.793928E-01,&
&9.768319E-01,9.741240E-01,9.712697E-01,9.682696E-01,9.651245E-01,9.618350E-01,9.584020E-01,9.548261E-01,&
&9.511083E-01,9.472492E-01,9.432500E-01,9.391113E-01,9.348343E-01,9.304197E-01,9.258688E-01,9.211824E-01,&
&9.997620E-01,9.992862E-01,9.985726E-01,9.976215E-01,9.964334E-01,9.950085E-01,9.933475E-01,9.914508E-01,&
&9.893192E-01,9.869535E-01,9.843544E-01,9.815230E-01,9.784601E-01,9.751670E-01,9.716448E-01,9.678947E-01,&
&9.639181E-01,9.597164E-01,9.552910E-01,9.506437E-01,9.457759E-01,9.406895E-01,9.353863E-01,9.298681E-01,&
&9.241370E-01,9.181949E-01,9.120439E-01,9.056863E-01,8.991243E-01,8.923602E-01,8.853965E-01,8.782355E-01,&
&9.996573E-01,9.989722E-01,9.979448E-01,9.965759E-01,9.948660E-01,9.928161E-01,9.904273E-01,9.877006E-01,&
&9.846377E-01,9.812399E-01,9.775091E-01,9.734472E-01,9.690562E-01,9.643385E-01,9.592963E-01,9.539325E-01,&
&9.482496E-01,9.422505E-01,9.359385E-01,9.293166E-01,9.223883E-01,9.151572E-01,9.076268E-01,8.998012E-01,&
&8.916842E-01,8.832801E-01,8.745931E-01,8.656276E-01,8.563883E-01,8.468798E-01,8.371069E-01,8.270747E-01,&
&9.995336E-01,9.986011E-01,9.972032E-01,9.953408E-01,9.930153E-01,9.902282E-01,9.869816E-01,9.832777E-01,&
&9.791190E-01,9.745086E-01,9.694495E-01,9.639455E-01,9.580001E-01,9.516178E-01,9.448028E-01,9.375600E-01,&
&9.298944E-01,9.218113E-01,9.133164E-01,9.044156E-01,8.951150E-01,8.854212E-01,8.753409E-01,8.648811E-01,&
&8.540490E-01,8.428522E-01,8.312984E-01,8.193957E-01,8.071522E-01,7.945765E-01,7.816772E-01,7.684632E-01,&
&9.993908E-01,9.981730E-01,9.963477E-01,9.939166E-01,9.908819E-01,9.872463E-01,9.830132E-01,9.781864E-01,&
&9.727704E-01,9.667701E-01,9.601909E-01,9.530389E-01,9.453206E-01,9.370429E-01,9.282136E-01,9.188405E-01,&
&9.089323E-01,8.984979E-01,8.875467E-01,8.760889E-01,8.641346E-01,8.516949E-01,8.387809E-01,8.254044E-01,&
&8.115774E-01,7.973125E-01,7.826225E-01,7.675206E-01,7.520205E-01,7.361361E-01,7.198818E-01,7.032720E-01,&
&9.992290E-01,9.976880E-01,9.953787E-01,9.923037E-01,9.884667E-01,9.838721E-01,9.785251E-01,9.724320E-01,&
&9.655998E-01,9.580364E-01,9.497504E-01,9.407516E-01,9.310502E-01,9.206574E-01,9.095852E-01,8.978463E-01,&
&8.854542E-01,8.724232E-01,8.587683E-01,8.445050E-01,8.296498E-01,8.142196E-01,7.982321E-01,7.817056E-01,&
&7.646589E-01,7.471115E-01,7.290834E-01,7.105950E-01,6.916673E-01,6.723218E-01,6.525804E-01,6.324654E-01,&
&9.990482E-01,9.971460E-01,9.942961E-01,9.905026E-01,9.857708E-01,9.801076E-01,9.735210E-01,9.660203E-01,&
&9.576164E-01,9.483211E-01,9.381477E-01,9.271107E-01,9.152258E-01,9.025098E-01,8.889808E-01,8.746581E-01,&
&8.595619E-01,8.437136E-01,8.271356E-01,8.098514E-01,7.918853E-01,7.732627E-01,7.540099E-01,7.341539E-01,&
&7.137225E-01,6.927445E-01,6.712492E-01,6.492667E-01,6.268275E-01,6.039630E-01,5.807050E-01,5.570856E-01,&
&9.988484E-01,9.965471E-01,9.931003E-01,9.885137E-01,9.827953E-01,9.759550E-01,9.680047E-01,9.589579E-01,&
&9.488303E-01,9.376394E-01,9.254045E-01,9.121464E-01,8.978882E-01,8.826542E-01,8.664707E-01,8.493653E-01,&
&8.313673E-01,8.125076E-01,7.928184E-01,7.723332E-01,7.510870E-01,7.291160E-01,7.064574E-01,6.831497E-01,&
&6.592323E-01,6.347456E-01,6.097310E-01,5.842304E-01,5.582868E-01,5.319436E-01,5.052447E-01,4.782346E-01,&
&9.986295E-01,9.958914E-01,9.917913E-01,9.863376E-01,9.795414E-01,9.714169E-01,9.619806E-01,9.512519E-01,&
&9.392528E-01,9.260080E-01,9.115444E-01,8.958918E-01,8.790821E-01,8.611496E-01,8.421310E-01,8.220649E-01,&
&8.009922E-01,7.789558E-01,7.560003E-01,7.321722E-01,7.075198E-01,6.820927E-01,6.559422E-01,6.291209E-01,&
&6.016826E-01,5.736821E-01,5.451754E-01,5.162191E-01,4.868709E-01,4.571886E-01,4.272310E-01,3.970568E-01,&
&9.983917E-01,9.951789E-01,9.903694E-01,9.839748E-01,9.760106E-01,9.664958E-01,9.554535E-01,9.429102E-01,&
&9.288960E-01,9.134448E-01,8.965935E-01,8.783826E-01,8.588558E-01,8.380597E-01,8.160442E-01,7.928617E-01,&
&7.685676E-01,7.432196E-01,7.168779E-01,6.896050E-01,6.614654E-01,6.325255E-01,6.028535E-01,5.725190E-01,&
&5.415932E-01,5.101482E-01,4.782572E-01,4.459943E-01,4.134340E-01,3.806514E-01,3.477216E-01,3.147198E-01,&
&9.981348E-01,9.944096E-01,9.888349E-01,9.814261E-01,9.722042E-01,9.611947E-01,9.484285E-01,9.339412E-01,&
&9.177731E-01,8.999694E-01,8.805795E-01,8.596574E-01,8.372612E-01,8.134530E-01,7.882986E-01,7.618675E-01,&
&7.342328E-01,7.054704E-01,6.756594E-01,6.448815E-01,6.132208E-01,5.807637E-01,5.475983E-01,5.138146E-01,&
&4.795039E-01,4.447585E-01,4.096715E-01,3.743367E-01,3.388480E-01,3.032993E-01,2.677841E-01,2.323955E-01,&
&9.978589E-01,9.935836E-01,9.871879E-01,9.786922E-01,9.681238E-01,9.555167E-01,9.409111E-01,9.243540E-01,&
&9.058982E-01,8.856027E-01,8.635324E-01,8.397576E-01,8.143539E-01,7.874021E-01,7.589878E-01,7.292008E-01,&
&6.981352E-01,6.658891E-01,6.325637E-01,5.982636E-01,5.630959E-01,5.271703E-01,4.905984E-01,4.534932E-01,&
&4.159691E-01,3.781413E-01,3.401253E-01,3.020365E-01,2.639900E-01,2.261002E-01,1.884800E-01,1.512410E-01,&
&9.975641E-01,9.927011E-01,9.854288E-01,9.757738E-01,9.637713E-01,9.494651E-01,9.329073E-01,9.141584E-01,&
&8.932863E-01,8.703671E-01,8.454838E-01,8.187267E-01,7.901925E-01,7.599841E-01,7.282106E-01,6.949859E-01,&
&6.604294E-01,6.246644E-01,5.878187E-01,5.500230E-01,5.114112E-01,4.721197E-01,4.322863E-01,3.920505E-01,&
&3.515522E-01,3.109319E-01,2.703292E-01,2.298830E-01,1.897310E-01,1.500084E-01,1.108481E-01,7.237997E-02,&
&9.972502E-01,9.917619E-01,9.835578E-01,9.726716E-01,9.591483E-01,9.430435E-01,9.244234E-01,9.033646E-01,&
&8.799536E-01,8.542861E-01,8.264674E-01,7.966110E-01,7.648387E-01,7.312798E-01,6.960704E-01,6.593531E-01,&
&6.212761E-01,5.819926E-01,5.416601E-01,5.004398E-01,4.584957E-01,4.159939E-01,3.731019E-01,3.299879E-01,&
&2.868199E-01,2.437652E-01,2.009893E-01,1.586555E-01,1.169240E-01,7.595116E-02,3.588910E-02,-3.115310E-03,&
&9.969173E-01,9.907663E-01,9.815752E-01,9.693866E-01,9.542569E-01,9.362557E-01,9.154661E-01,8.919838E-01,&
&8.659168E-01,8.373847E-01,8.065184E-01,7.734590E-01,7.383575E-01,7.013735E-01,6.626751E-01,6.224374E-01,&
&5.808419E-01,5.380757E-01,4.943303E-01,4.498006E-01,4.046842E-01,3.591802E-01,3.134884E-01,2.678079E-01,&
&2.223365E-01,1.772696E-01,1.327991E-01,8.911277E-02,4.639291E-02,4.815780E-03,-3.544936E-02,-7.424107E-02,&
&9.965655E-01,9.897142E-01,9.794814E-01,9.659197E-01,9.490990E-01,9.291056E-01,9.060423E-01,8.800273E-01,&
&8.511937E-01,8.196890E-01,7.856739E-01,7.493214E-01,7.108161E-01,6.703531E-01,6.281363E-01,5.843783E-01,&
&5.392983E-01,4.931212E-01,4.460763E-01,3.983962E-01,3.503152E-01,3.020680E-01,2.538887E-01,2.060093E-01,&
&1.586583E-01,1.120596E-01,6.643130E-02,2.198441E-02,-2.107823E-02,-6.256308E-02,-1.022869E-01,-1.400777E-01,&
&9.961947E-01,9.886058E-01,9.772767E-01,9.622718E-01,9.436768E-01,9.215976E-01,8.961595E-01,8.675072E-01,&
&8.358031E-01,8.012264E-01,7.639724E-01,7.242509E-01,6.822849E-01,6.383093E-01,5.925694E-01,5.453194E-01,&
&4.968207E-01,4.473403E-01,3.971491E-01,3.465205E-01,2.957284E-01,2.450455E-01,1.947418E-01,1.450829E-01,&
&9.632821E-02,4.872970E-02,2.530105E-03,-4.203842E-02,-8.475567E-02,-1.254147E-01,-1.638231E-01,-1.998039E-01/)
!
END MODULE legendre_mod
