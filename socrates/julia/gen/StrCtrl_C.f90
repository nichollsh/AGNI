! Autogenerated from Fortran file src/radiance_core/def_control.F90
! svn revision 1226

module StrCtrl_C

use, intrinsic :: iso_c_binding

use UTILITIES_CF
use def_control

implicit none

private

contains

    function create_StrCtrl() result(control_Cptr) & 
        bind(C, NAME='PS_create_StrCtrl')

        implicit none
        type(c_ptr) :: control_Cptr

        TYPE(StrCtrl), pointer :: control

        ALLOCATE(control)

        control_Cptr = c_loc(control)
    end function create_StrCtrl

    subroutine delete_StrCtrl(control_Cptr) &
        bind(C, NAME='PS_delete_StrCtrl')

        implicit none
        type(c_ptr), value, intent(in) :: control_Cptr

        TYPE(StrCtrl), pointer :: control

        call C_F_POINTER(control_Cptr, control)

        DEALLOCATE(control)

    end subroutine delete_StrCtrl

    function StrCtrl_get_logical(control_Cptr, field_Cstr, val) result(field_OK) &
        bind(C, NAME='PS_StrCtrl_get_logical')

        implicit none
        type(c_ptr), value, intent(in)          :: control_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        logical(c_bool), intent(out) :: val

        ! local variables
        TYPE(StrCtrl), pointer                  :: control
        character(len=:), allocatable           :: field

        ! convert types
        call C_F_POINTER(control_Cptr, control)
        field = c_to_f_string(field_Cstr)

        field_OK = .TRUE.
    
        if (field == 'l_microphysics') then
            val = control%l_microphysics
        else if (field == 'l_gas') then
            val = control%l_gas
        else if (field == 'l_rayleigh') then
            val = control%l_rayleigh
        else if (field == 'l_continuum') then
            val = control%l_continuum
        else if (field == 'l_cont_gen') then
            val = control%l_cont_gen
        else if (field == 'l_cloud') then
            val = control%l_cloud
        else if (field == 'l_drop') then
            val = control%l_drop
        else if (field == 'l_ice') then
            val = control%l_ice
        else if (field == 'l_aerosol') then
            val = control%l_aerosol
        else if (field == 'l_aerosol_mode') then
            val = control%l_aerosol_mode
        else if (field == 'l_aerosol_ccn') then
            val = control%l_aerosol_ccn
        else if (field == 'l_solar_tail_flux') then
            val = control%l_solar_tail_flux
        else if (field == 'l_orog') then
            val = control%l_orog
        else if (field == 'l_orog_fix') then
            val = control%l_orog_fix
        else if (field == 'l_solvar') then
            val = control%l_solvar
        else if (field == 'l_h2o') then
            val = control%l_h2o
        else if (field == 'l_o2') then
            val = control%l_o2
        else if (field == 'l_n2o') then
            val = control%l_n2o
        else if (field == 'l_ch4') then
            val = control%l_ch4
        else if (field == 'l_cfc11') then
            val = control%l_cfc11
        else if (field == 'l_cfc12') then
            val = control%l_cfc12
        else if (field == 'l_cfc113') then
            val = control%l_cfc113
        else if (field == 'l_cfc114') then
            val = control%l_cfc114
        else if (field == 'l_hcfc22') then
            val = control%l_hcfc22
        else if (field == 'l_hfc125') then
            val = control%l_hfc125
        else if (field == 'l_hfc134a') then
            val = control%l_hfc134a
        else if (field == 'l_co') then
            val = control%l_co
        else if (field == 'l_nh3') then
            val = control%l_nh3
        else if (field == 'l_tio') then
            val = control%l_tio
        else if (field == 'l_vo') then
            val = control%l_vo
        else if (field == 'l_h2') then
            val = control%l_h2
        else if (field == 'l_he') then
            val = control%l_he
        else if (field == 'l_na') then
            val = control%l_na
        else if (field == 'l_k') then
            val = control%l_k
        else if (field == 'l_co2') then
            val = control%l_co2
        else if (field == 'l_feh') then
            val = control%l_feh
        else if (field == 'l_crh') then
            val = control%l_crh
        else if (field == 'l_li') then
            val = control%l_li
        else if (field == 'l_rb') then
            val = control%l_rb
        else if (field == 'l_cs') then
            val = control%l_cs
        else if (field == 'l_ph3') then
            val = control%l_ph3
        else if (field == 'l_c2h2') then
            val = control%l_c2h2
        else if (field == 'l_hcn') then
            val = control%l_hcn
        else if (field == 'l_o3') then
            val = control%l_o3
        else if (field == 'l_so2') then
            val = control%l_so2
        else if (field == 'l_no2') then
            val = control%l_no2
        else if (field == 'l_n2') then
            val = control%l_n2
        else if (field == 'l_ar') then
            val = control%l_ar
        else if (field == 'l_o') then
            val = control%l_o
        else if (field == 'l_n') then
            val = control%l_n
        else if (field == 'l_hno3') then
            val = control%l_hno3
        else if (field == 'l_no') then
            val = control%l_no
        else if (field == 'l_no3') then
            val = control%l_no3
        else if (field == 'l_n2o5') then
            val = control%l_n2o5
        else if (field == 'l_hono') then
            val = control%l_hono
        else if (field == 'l_ho2no2') then
            val = control%l_ho2no2
        else if (field == 'l_h2o2') then
            val = control%l_h2o2
        else if (field == 'l_c2h6') then
            val = control%l_c2h6
        else if (field == 'l_ch3') then
            val = control%l_ch3
        else if (field == 'l_h2co') then
            val = control%l_h2co
        else if (field == 'l_ho2') then
            val = control%l_ho2
        else if (field == 'l_hdo') then
            val = control%l_hdo
        else if (field == 'l_hcl') then
            val = control%l_hcl
        else if (field == 'l_hf') then
            val = control%l_hf
        else if (field == 'l_cosso') then
            val = control%l_cosso
        else if (field == 'l_tosso') then
            val = control%l_tosso
        else if (field == 'l_yosos') then
            val = control%l_yosos
        else if (field == 'l_h2s') then
            val = control%l_h2s
        else if (field == 'l_cocs') then
            val = control%l_cocs
        else if (field == 'l_local_cnv_partition') then
            val = control%l_local_cnv_partition
        else if (field == 'l_global_cloud_top') then
            val = control%l_global_cloud_top
        else if (field == 'l_avg_phase_fnc') then
            val = control%l_avg_phase_fnc
        else if (field == 'l_ir_source_quad') then
            val = control%l_ir_source_quad
        else if (field == 'l_rescale') then
            val = control%l_rescale
        else if (field == 'l_spherical_solar') then
            val = control%l_spherical_solar
        else if (field == 'l_spherical_diffuse') then
            val = control%l_spherical_diffuse
        else if (field == 'l_henyey_greenstein_pf') then
            val = control%l_henyey_greenstein_pf
        else if (field == 'l_lanczos') then
            val = control%l_lanczos
        else if (field == 'l_euler_trnf') then
            val = control%l_euler_trnf
        else if (field == 'l_tile') then
            val = control%l_tile
        else if (field == 'l_tile_emissivity') then
            val = control%l_tile_emissivity
        else if (field == 'l_flux_ground') then
            val = control%l_flux_ground
        else if (field == 'l_extra_top') then
            val = control%l_extra_top
        else if (field == 'l_rad_deg') then
            val = control%l_rad_deg
        else if (field == 'l_subsample') then
            val = control%l_subsample
        else if (field == 'l_mixing_ratio') then
            val = control%l_mixing_ratio
        else if (field == 'l_map_sub_bands') then
            val = control%l_map_sub_bands
        else if (field == 'l_clear') then
            val = control%l_clear
        else if (field == 'l_flux_div') then
            val = control%l_flux_div
        else if (field == 'l_blue_flux_surf') then
            val = control%l_blue_flux_surf
        else if (field == 'l_cloud_absorptivity') then
            val = control%l_cloud_absorptivity
        else if (field == 'l_cloud_extinction') then
            val = control%l_cloud_extinction
        else if (field == 'l_ls_cloud_absorptivity') then
            val = control%l_ls_cloud_absorptivity
        else if (field == 'l_ls_cloud_extinction') then
            val = control%l_ls_cloud_extinction
        else if (field == 'l_cnv_cloud_absorptivity') then
            val = control%l_cnv_cloud_absorptivity
        else if (field == 'l_cnv_cloud_extinction') then
            val = control%l_cnv_cloud_extinction
        else if (field == 'l_flux_direct_band') then
            val = control%l_flux_direct_band
        else if (field == 'l_flux_direct_div_band') then
            val = control%l_flux_direct_div_band
        else if (field == 'l_flux_direct_sph_band') then
            val = control%l_flux_direct_sph_band
        else if (field == 'l_flux_down_band') then
            val = control%l_flux_down_band
        else if (field == 'l_flux_up_band') then
            val = control%l_flux_up_band
        else if (field == 'l_flux_div_band') then
            val = control%l_flux_div_band
        else if (field == 'l_flux_direct_clear_band') then
            val = control%l_flux_direct_clear_band
        else if (field == 'l_flux_direct_clear_div_band') then
            val = control%l_flux_direct_clear_div_band
        else if (field == 'l_flux_direct_clear_sph_band') then
            val = control%l_flux_direct_clear_sph_band
        else if (field == 'l_flux_down_clear_band') then
            val = control%l_flux_down_clear_band
        else if (field == 'l_flux_up_clear_band') then
            val = control%l_flux_up_clear_band
        else if (field == 'l_flux_div_clear_band') then
            val = control%l_flux_div_clear_band
        else if (field == 'l_actinic_flux') then
            val = control%l_actinic_flux
        else if (field == 'l_actinic_flux_clear') then
            val = control%l_actinic_flux_clear
        else if (field == 'l_actinic_flux_band') then
            val = control%l_actinic_flux_band
        else if (field == 'l_actinic_flux_clear_band') then
            val = control%l_actinic_flux_clear_band
        else if (field == 'l_photolysis_rate') then
            val = control%l_photolysis_rate
        else if (field == 'l_photolysis_rate_clear') then
            val = control%l_photolysis_rate_clear
        else if (field == 'l_photolysis_div') then
            val = control%l_photolysis_div
        else if (field == 'l_photolysis_div_clear') then
            val = control%l_photolysis_div_clear
        else if (field == 'l_aerosol_absorption_band') then
            val = control%l_aerosol_absorption_band
        else if (field == 'l_aerosol_scattering_band') then
            val = control%l_aerosol_scattering_band
        else if (field == 'l_aerosol_asymmetry_band') then
            val = control%l_aerosol_asymmetry_band
        else if (field == 'l_spherical_path_diag') then
            val = control%l_spherical_path_diag
        else if (field == 'l_contrib_func') then
            val = control%l_contrib_func
        else if (field == 'l_contrib_func_band') then
            val = control%l_contrib_func_band
        else if (field == 'l_geostationary') then
            val = control%l_geostationary
        else
            field_OK = .FALSE.
        end if

    end function StrCtrl_get_logical

    function StrCtrl_set_logical(control_Cptr, field_Cstr, val) result(field_OK) &
        bind(C, NAME='PS_StrCtrl_set_logical')

        implicit none
        type(c_ptr), value, intent(in)          :: control_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        logical(c_bool), value, intent(in) :: val

        ! local variables
        TYPE(StrCtrl), pointer                  :: control
        character(len=:), allocatable           :: field

        ! convert types
        call C_F_POINTER(control_Cptr, control)
        field = c_to_f_string(field_Cstr)

        field_OK = .TRUE.
    
        if (field == 'l_microphysics') then
            control%l_microphysics = val
        else if (field == 'l_gas') then
            control%l_gas = val
        else if (field == 'l_rayleigh') then
            control%l_rayleigh = val
        else if (field == 'l_continuum') then
            control%l_continuum = val
        else if (field == 'l_cont_gen') then
            control%l_cont_gen = val
        else if (field == 'l_cloud') then
            control%l_cloud = val
        else if (field == 'l_drop') then
            control%l_drop = val
        else if (field == 'l_ice') then
            control%l_ice = val
        else if (field == 'l_aerosol') then
            control%l_aerosol = val
        else if (field == 'l_aerosol_mode') then
            control%l_aerosol_mode = val
        else if (field == 'l_aerosol_ccn') then
            control%l_aerosol_ccn = val
        else if (field == 'l_solar_tail_flux') then
            control%l_solar_tail_flux = val
        else if (field == 'l_orog') then
            control%l_orog = val
        else if (field == 'l_orog_fix') then
            control%l_orog_fix = val
        else if (field == 'l_solvar') then
            control%l_solvar = val
        else if (field == 'l_h2o') then
            control%l_h2o = val
        else if (field == 'l_o2') then
            control%l_o2 = val
        else if (field == 'l_n2o') then
            control%l_n2o = val
        else if (field == 'l_ch4') then
            control%l_ch4 = val
        else if (field == 'l_cfc11') then
            control%l_cfc11 = val
        else if (field == 'l_cfc12') then
            control%l_cfc12 = val
        else if (field == 'l_cfc113') then
            control%l_cfc113 = val
        else if (field == 'l_cfc114') then
            control%l_cfc114 = val
        else if (field == 'l_hcfc22') then
            control%l_hcfc22 = val
        else if (field == 'l_hfc125') then
            control%l_hfc125 = val
        else if (field == 'l_hfc134a') then
            control%l_hfc134a = val
        else if (field == 'l_co') then
            control%l_co = val
        else if (field == 'l_nh3') then
            control%l_nh3 = val
        else if (field == 'l_tio') then
            control%l_tio = val
        else if (field == 'l_vo') then
            control%l_vo = val
        else if (field == 'l_h2') then
            control%l_h2 = val
        else if (field == 'l_he') then
            control%l_he = val
        else if (field == 'l_na') then
            control%l_na = val
        else if (field == 'l_k') then
            control%l_k = val
        else if (field == 'l_co2') then
            control%l_co2 = val
        else if (field == 'l_feh') then
            control%l_feh = val
        else if (field == 'l_crh') then
            control%l_crh = val
        else if (field == 'l_li') then
            control%l_li = val
        else if (field == 'l_rb') then
            control%l_rb = val
        else if (field == 'l_cs') then
            control%l_cs = val
        else if (field == 'l_ph3') then
            control%l_ph3 = val
        else if (field == 'l_c2h2') then
            control%l_c2h2 = val
        else if (field == 'l_hcn') then
            control%l_hcn = val
        else if (field == 'l_o3') then
            control%l_o3 = val
        else if (field == 'l_so2') then
            control%l_so2 = val
        else if (field == 'l_no2') then
            control%l_no2 = val
        else if (field == 'l_n2') then
            control%l_n2 = val
        else if (field == 'l_ar') then
            control%l_ar = val
        else if (field == 'l_o') then
            control%l_o = val
        else if (field == 'l_n') then
            control%l_n = val
        else if (field == 'l_hno3') then
            control%l_hno3 = val
        else if (field == 'l_no') then
            control%l_no = val
        else if (field == 'l_no3') then
            control%l_no3 = val
        else if (field == 'l_n2o5') then
            control%l_n2o5 = val
        else if (field == 'l_hono') then
            control%l_hono = val
        else if (field == 'l_ho2no2') then
            control%l_ho2no2 = val
        else if (field == 'l_h2o2') then
            control%l_h2o2 = val
        else if (field == 'l_c2h6') then
            control%l_c2h6 = val
        else if (field == 'l_ch3') then
            control%l_ch3 = val
        else if (field == 'l_h2co') then
            control%l_h2co = val
        else if (field == 'l_ho2') then
            control%l_ho2 = val
        else if (field == 'l_hdo') then
            control%l_hdo = val
        else if (field == 'l_hcl') then
            control%l_hcl = val
        else if (field == 'l_hf') then
            control%l_hf = val
        else if (field == 'l_cosso') then
            control%l_cosso = val
        else if (field == 'l_tosso') then
            control%l_tosso = val
        else if (field == 'l_yosos') then
            control%l_yosos = val
        else if (field == 'l_h2s') then
            control%l_h2s = val
        else if (field == 'l_cocs') then
            control%l_cocs = val
        else if (field == 'l_local_cnv_partition') then
            control%l_local_cnv_partition = val
        else if (field == 'l_global_cloud_top') then
            control%l_global_cloud_top = val
        else if (field == 'l_avg_phase_fnc') then
            control%l_avg_phase_fnc = val
        else if (field == 'l_ir_source_quad') then
            control%l_ir_source_quad = val
        else if (field == 'l_rescale') then
            control%l_rescale = val
        else if (field == 'l_spherical_solar') then
            control%l_spherical_solar = val
        else if (field == 'l_spherical_diffuse') then
            control%l_spherical_diffuse = val
        else if (field == 'l_henyey_greenstein_pf') then
            control%l_henyey_greenstein_pf = val
        else if (field == 'l_lanczos') then
            control%l_lanczos = val
        else if (field == 'l_euler_trnf') then
            control%l_euler_trnf = val
        else if (field == 'l_tile') then
            control%l_tile = val
        else if (field == 'l_tile_emissivity') then
            control%l_tile_emissivity = val
        else if (field == 'l_flux_ground') then
            control%l_flux_ground = val
        else if (field == 'l_extra_top') then
            control%l_extra_top = val
        else if (field == 'l_rad_deg') then
            control%l_rad_deg = val
        else if (field == 'l_subsample') then
            control%l_subsample = val
        else if (field == 'l_mixing_ratio') then
            control%l_mixing_ratio = val
        else if (field == 'l_map_sub_bands') then
            control%l_map_sub_bands = val
        else if (field == 'l_clear') then
            control%l_clear = val
        else if (field == 'l_flux_div') then
            control%l_flux_div = val
        else if (field == 'l_blue_flux_surf') then
            control%l_blue_flux_surf = val
        else if (field == 'l_cloud_absorptivity') then
            control%l_cloud_absorptivity = val
        else if (field == 'l_cloud_extinction') then
            control%l_cloud_extinction = val
        else if (field == 'l_ls_cloud_absorptivity') then
            control%l_ls_cloud_absorptivity = val
        else if (field == 'l_ls_cloud_extinction') then
            control%l_ls_cloud_extinction = val
        else if (field == 'l_cnv_cloud_absorptivity') then
            control%l_cnv_cloud_absorptivity = val
        else if (field == 'l_cnv_cloud_extinction') then
            control%l_cnv_cloud_extinction = val
        else if (field == 'l_flux_direct_band') then
            control%l_flux_direct_band = val
        else if (field == 'l_flux_direct_div_band') then
            control%l_flux_direct_div_band = val
        else if (field == 'l_flux_direct_sph_band') then
            control%l_flux_direct_sph_band = val
        else if (field == 'l_flux_down_band') then
            control%l_flux_down_band = val
        else if (field == 'l_flux_up_band') then
            control%l_flux_up_band = val
        else if (field == 'l_flux_div_band') then
            control%l_flux_div_band = val
        else if (field == 'l_flux_direct_clear_band') then
            control%l_flux_direct_clear_band = val
        else if (field == 'l_flux_direct_clear_div_band') then
            control%l_flux_direct_clear_div_band = val
        else if (field == 'l_flux_direct_clear_sph_band') then
            control%l_flux_direct_clear_sph_band = val
        else if (field == 'l_flux_down_clear_band') then
            control%l_flux_down_clear_band = val
        else if (field == 'l_flux_up_clear_band') then
            control%l_flux_up_clear_band = val
        else if (field == 'l_flux_div_clear_band') then
            control%l_flux_div_clear_band = val
        else if (field == 'l_actinic_flux') then
            control%l_actinic_flux = val
        else if (field == 'l_actinic_flux_clear') then
            control%l_actinic_flux_clear = val
        else if (field == 'l_actinic_flux_band') then
            control%l_actinic_flux_band = val
        else if (field == 'l_actinic_flux_clear_band') then
            control%l_actinic_flux_clear_band = val
        else if (field == 'l_photolysis_rate') then
            control%l_photolysis_rate = val
        else if (field == 'l_photolysis_rate_clear') then
            control%l_photolysis_rate_clear = val
        else if (field == 'l_photolysis_div') then
            control%l_photolysis_div = val
        else if (field == 'l_photolysis_div_clear') then
            control%l_photolysis_div_clear = val
        else if (field == 'l_aerosol_absorption_band') then
            control%l_aerosol_absorption_band = val
        else if (field == 'l_aerosol_scattering_band') then
            control%l_aerosol_scattering_band = val
        else if (field == 'l_aerosol_asymmetry_band') then
            control%l_aerosol_asymmetry_band = val
        else if (field == 'l_spherical_path_diag') then
            control%l_spherical_path_diag = val
        else if (field == 'l_contrib_func') then
            control%l_contrib_func = val
        else if (field == 'l_contrib_func_band') then
            control%l_contrib_func_band = val
        else if (field == 'l_geostationary') then
            control%l_geostationary = val
        else
            field_OK = .FALSE.
        end if

    end function StrCtrl_set_logical

    function StrCtrl_get_integer(control_Cptr, field_Cstr, val) result(field_OK) &
        bind(C, NAME='PS_StrCtrl_get_integer')

        implicit none
        type(c_ptr), value, intent(in)          :: control_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        integer(c_int), intent(out) :: val

        ! local variables
        TYPE(StrCtrl), pointer                  :: control
        character(len=:), allocatable           :: field

        ! convert types
        call C_F_POINTER(control_Cptr, control)
        field = c_to_f_string(field_Cstr)

        field_OK = .TRUE.
    
        if (field == 'isolir') then
            val = control%isolir
        else if (field == 'first_band') then
            val = control%first_band
        else if (field == 'last_band') then
            val = control%last_band
        else if (field == 'i_gas_overlap') then
            val = control%i_gas_overlap
        else if (field == 'n_esft_red') then
            val = control%n_esft_red
        else if (field == 'i_gas') then
            val = control%i_gas
        else if (field == 'i_cloud') then
            val = control%i_cloud
        else if (field == 'i_cloud_representation') then
            val = control%i_cloud_representation
        else if (field == 'i_st_water') then
            val = control%i_st_water
        else if (field == 'i_cnv_water') then
            val = control%i_cnv_water
        else if (field == 'i_st_ice') then
            val = control%i_st_ice
        else if (field == 'i_cnv_ice') then
            val = control%i_cnv_ice
        else if (field == 'i_inhom') then
            val = control%i_inhom
        else if (field == 'i_mcica_sampling') then
            val = control%i_mcica_sampling
        else if (field == 'i_overlap') then
            val = control%i_overlap
        else if (field == 'i_drop_re') then
            val = control%i_drop_re
        else if (field == 'n_channel') then
            val = control%n_channel
        else if (field == 'i_angular_integration') then
            val = control%i_angular_integration
        else if (field == 'i_2stream') then
            val = control%i_2stream
        else if (field == 'i_solver') then
            val = control%i_solver
        else if (field == 'i_solver_clear') then
            val = control%i_solver_clear
        else if (field == 'n_order_gauss') then
            val = control%n_order_gauss
        else if (field == 'i_truncation') then
            val = control%i_truncation
        else if (field == 'i_sph_algorithm') then
            val = control%i_sph_algorithm
        else if (field == 'n_order_phase_solar') then
            val = control%n_order_phase_solar
        else if (field == 'ls_global_trunc') then
            val = control%ls_global_trunc
        else if (field == 'ms_min') then
            val = control%ms_min
        else if (field == 'ms_max') then
            val = control%ms_max
        else if (field == 'ls_brdf_trunc') then
            val = control%ls_brdf_trunc
        else if (field == 'n_order_forward') then
            val = control%n_order_forward
        else if (field == 'i_sph_mode') then
            val = control%i_sph_mode
        else if (field == 'i_scatter_method') then
            val = control%i_scatter_method
        else if (field == 'i_solar_src') then
            val = control%i_solar_src
        else if (field == 'i_direct_tau') then
            val = control%i_direct_tau
        else
            field_OK = .FALSE.
        end if

    end function StrCtrl_get_integer

    function StrCtrl_set_integer(control_Cptr, field_Cstr, val) result(field_OK) &
        bind(C, NAME='PS_StrCtrl_set_integer')

        implicit none
        type(c_ptr), value, intent(in)          :: control_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        integer(c_int), value, intent(in) :: val

        ! local variables
        TYPE(StrCtrl), pointer                  :: control
        character(len=:), allocatable           :: field

        ! convert types
        call C_F_POINTER(control_Cptr, control)
        field = c_to_f_string(field_Cstr)

        field_OK = .TRUE.
    
        if (field == 'isolir') then
            control%isolir = val
        else if (field == 'first_band') then
            control%first_band = val
        else if (field == 'last_band') then
            control%last_band = val
        else if (field == 'i_gas_overlap') then
            control%i_gas_overlap = val
        else if (field == 'n_esft_red') then
            control%n_esft_red = val
        else if (field == 'i_gas') then
            control%i_gas = val
        else if (field == 'i_cloud') then
            control%i_cloud = val
        else if (field == 'i_cloud_representation') then
            control%i_cloud_representation = val
        else if (field == 'i_st_water') then
            control%i_st_water = val
        else if (field == 'i_cnv_water') then
            control%i_cnv_water = val
        else if (field == 'i_st_ice') then
            control%i_st_ice = val
        else if (field == 'i_cnv_ice') then
            control%i_cnv_ice = val
        else if (field == 'i_inhom') then
            control%i_inhom = val
        else if (field == 'i_mcica_sampling') then
            control%i_mcica_sampling = val
        else if (field == 'i_overlap') then
            control%i_overlap = val
        else if (field == 'i_drop_re') then
            control%i_drop_re = val
        else if (field == 'n_channel') then
            control%n_channel = val
        else if (field == 'i_angular_integration') then
            control%i_angular_integration = val
        else if (field == 'i_2stream') then
            control%i_2stream = val
        else if (field == 'i_solver') then
            control%i_solver = val
        else if (field == 'i_solver_clear') then
            control%i_solver_clear = val
        else if (field == 'n_order_gauss') then
            control%n_order_gauss = val
        else if (field == 'i_truncation') then
            control%i_truncation = val
        else if (field == 'i_sph_algorithm') then
            control%i_sph_algorithm = val
        else if (field == 'n_order_phase_solar') then
            control%n_order_phase_solar = val
        else if (field == 'ls_global_trunc') then
            control%ls_global_trunc = val
        else if (field == 'ms_min') then
            control%ms_min = val
        else if (field == 'ms_max') then
            control%ms_max = val
        else if (field == 'ls_brdf_trunc') then
            control%ls_brdf_trunc = val
        else if (field == 'n_order_forward') then
            control%n_order_forward = val
        else if (field == 'i_sph_mode') then
            control%i_sph_mode = val
        else if (field == 'i_scatter_method') then
            control%i_scatter_method = val
        else if (field == 'i_solar_src') then
            control%i_solar_src = val
        else if (field == 'i_direct_tau') then
            control%i_direct_tau = val
        else
            field_OK = .FALSE.
        end if

    end function StrCtrl_set_integer

    function StrCtrl_get_real(control_Cptr, field_Cstr, val) result(field_OK) &
        bind(C, NAME='PS_StrCtrl_get_real')

        implicit none
        type(c_ptr), value, intent(in)          :: control_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        real(c_double), intent(out) :: val

        ! local variables
        TYPE(StrCtrl), pointer                  :: control
        character(len=:), allocatable           :: field

        ! convert types
        call C_F_POINTER(control_Cptr, control)
        field = c_to_f_string(field_Cstr)

        field_OK = .TRUE.
    
        if (field == 'gpnt_split') then
            val = control%gpnt_split
        else if (field == 'accuracy_adaptive') then
            val = control%accuracy_adaptive
        else if (field == 'euler_factor') then
            val = control%euler_factor
        else if (field == 'half_angle') then
            val = control%half_angle
        else if (field == 'sat_hgt') then
            val = control%sat_hgt
        else if (field == 'sat_lon') then
            val = control%sat_lon
        else if (field == 'sat_lat') then
            val = control%sat_lat
        else if (field == 'max_view_lon') then
            val = control%max_view_lon
        else if (field == 'min_view_lon') then
            val = control%min_view_lon
        else if (field == 'max_view_lat') then
            val = control%max_view_lat
        else if (field == 'min_view_lat') then
            val = control%min_view_lat
        else
            field_OK = .FALSE.
        end if

    end function StrCtrl_get_real

    function StrCtrl_set_real(control_Cptr, field_Cstr, val) result(field_OK) &
        bind(C, NAME='PS_StrCtrl_set_real')

        implicit none
        type(c_ptr), value, intent(in)          :: control_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        real(c_double), value, intent(in) :: val

        ! local variables
        TYPE(StrCtrl), pointer                  :: control
        character(len=:), allocatable           :: field

        ! convert types
        call C_F_POINTER(control_Cptr, control)
        field = c_to_f_string(field_Cstr)

        field_OK = .TRUE.
    
        if (field == 'gpnt_split') then
            control%gpnt_split = val
        else if (field == 'accuracy_adaptive') then
            control%accuracy_adaptive = val
        else if (field == 'euler_factor') then
            control%euler_factor = val
        else if (field == 'half_angle') then
            control%half_angle = val
        else if (field == 'sat_hgt') then
            control%sat_hgt = val
        else if (field == 'sat_lon') then
            control%sat_lon = val
        else if (field == 'sat_lat') then
            control%sat_lat = val
        else if (field == 'max_view_lon') then
            control%max_view_lon = val
        else if (field == 'min_view_lon') then
            control%min_view_lon = val
        else if (field == 'max_view_lat') then
            control%max_view_lat = val
        else if (field == 'min_view_lat') then
            control%min_view_lat = val
        else
            field_OK = .FALSE.
        end if

    end function StrCtrl_set_real

    function StrCtrl_get_logical_array(control_Cptr, field_Cstr, loc, dims_C, ndim, lbounds_C) result(field_OK) &
        bind(C, NAME='PS_StrCtrl_get_logical_array')

        implicit none
        type(c_ptr), value, intent(in)          :: control_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        type(c_ptr), intent(out)                :: loc
        type(c_ptr), value, intent(in)          :: dims_C
        integer(c_int), intent(inout)           :: ndim
        type(c_ptr), value, intent(in)          :: lbounds_C

        ! local variables
        TYPE(StrCtrl), pointer             :: control
        character(len=:), allocatable           :: field
        integer(c_int), pointer, dimension(:)   :: dims, lbounds    

        ! convert types
        call C_F_POINTER(control_Cptr, control)
        field = c_to_f_string(field_Cstr)
        call C_F_POINTER(dims_C, dims, [ndim])
        call C_F_POINTER(lbounds_C, lbounds, [ndim])

        field_OK = .TRUE.
    
        if (field == 'l_flux_tile') then
            if (allocated(control%l_flux_tile)) then
                loc = C_LOC(control%l_flux_tile)
                ndim = size(shape(control%l_flux_tile))
                dims(1:ndim) = shape(control%l_flux_tile)
                lbounds(1:ndim) = lbound(control%l_flux_tile)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'l_clear_band') then
            if (allocated(control%l_clear_band)) then
                loc = C_LOC(control%l_clear_band)
                ndim = size(shape(control%l_clear_band))
                dims(1:ndim) = shape(control%l_clear_band)
                lbounds(1:ndim) = lbound(control%l_clear_band)
            else
                loc = C_NULL_PTR
            end if

        else
            field_OK = .FALSE.
        end if

    end function StrCtrl_get_logical_array

    function StrCtrl_get_integer_array(control_Cptr, field_Cstr, loc, dims_C, ndim, lbounds_C) result(field_OK) &
        bind(C, NAME='PS_StrCtrl_get_integer_array')

        implicit none
        type(c_ptr), value, intent(in)          :: control_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        type(c_ptr), intent(out)                :: loc
        type(c_ptr), value, intent(in)          :: dims_C
        integer(c_int), intent(inout)           :: ndim
        type(c_ptr), value, intent(in)          :: lbounds_C

        ! local variables
        TYPE(StrCtrl), pointer             :: control
        character(len=:), allocatable           :: field
        integer(c_int), pointer, dimension(:)   :: dims, lbounds    

        ! convert types
        call C_F_POINTER(control_Cptr, control)
        field = c_to_f_string(field_Cstr)
        call C_F_POINTER(dims_C, dims, [ndim])
        call C_F_POINTER(lbounds_C, lbounds, [ndim])

        field_OK = .TRUE.
    
        if (field == 'i_scatter_method_band') then
            if (allocated(control%i_scatter_method_band)) then
                loc = C_LOC(control%i_scatter_method_band)
                ndim = size(shape(control%i_scatter_method_band))
                dims(1:ndim) = shape(control%i_scatter_method_band)
                lbounds(1:ndim) = lbound(control%i_scatter_method_band)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'i_gas_overlap_band') then
            if (allocated(control%i_gas_overlap_band)) then
                loc = C_LOC(control%i_gas_overlap_band)
                ndim = size(shape(control%i_gas_overlap_band))
                dims(1:ndim) = shape(control%i_gas_overlap_band)
                lbounds(1:ndim) = lbound(control%i_gas_overlap_band)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'map_channel') then
            if (allocated(control%map_channel)) then
                loc = C_LOC(control%map_channel)
                ndim = size(shape(control%map_channel))
                dims(1:ndim) = shape(control%map_channel)
                lbounds(1:ndim) = lbound(control%map_channel)
            else
                loc = C_NULL_PTR
            end if

        else
            field_OK = .FALSE.
        end if

    end function StrCtrl_get_integer_array

    function StrCtrl_get_real_array(control_Cptr, field_Cstr, loc, dims_C, ndim, lbounds_C) result(field_OK) &
        bind(C, NAME='PS_StrCtrl_get_real_array')

        implicit none
        type(c_ptr), value, intent(in)          :: control_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        type(c_ptr), intent(out)                :: loc
        type(c_ptr), value, intent(in)          :: dims_C
        integer(c_int), intent(inout)           :: ndim
        type(c_ptr), value, intent(in)          :: lbounds_C

        ! local variables
        TYPE(StrCtrl), pointer             :: control
        character(len=:), allocatable           :: field
        integer(c_int), pointer, dimension(:)   :: dims, lbounds    

        ! convert types
        call C_F_POINTER(control_Cptr, control)
        field = c_to_f_string(field_Cstr)
        call C_F_POINTER(dims_C, dims, [ndim])
        call C_F_POINTER(lbounds_C, lbounds, [ndim])

        field_OK = .TRUE.
    
        if (field == 'weight_band') then
            if (allocated(control%weight_band)) then
                loc = C_LOC(control%weight_band)
                ndim = size(shape(control%weight_band))
                dims(1:ndim) = shape(control%weight_band)
                lbounds(1:ndim) = lbound(control%weight_band)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'weight_diag') then
            if (allocated(control%weight_diag)) then
                loc = C_LOC(control%weight_diag)
                ndim = size(shape(control%weight_diag))
                dims(1:ndim) = shape(control%weight_diag)
                lbounds(1:ndim) = lbound(control%weight_diag)
            else
                loc = C_NULL_PTR
            end if

        else
            field_OK = .FALSE.
        end if

    end function StrCtrl_get_real_array

    function StrCtrl_get_string(control_Cptr, field_Cstr, val, val_len) result(field_OK) &
        bind(C, NAME='PS_StrCtrl_get_string')

        implicit none
        type(c_ptr), value, intent(in)          :: control_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        type(c_ptr), value, intent(in)          :: val
        integer(c_size_t), value, intent(in)    :: val_len 

        ! local variables
        TYPE(StrCtrl), pointer             :: control
        character(len=:), allocatable           :: field
       
        ! convert types
        call C_F_POINTER(control_Cptr, control)
        field = c_to_f_string(field_Cstr)
                
        field_OK = .TRUE.
    
        if (field == 'spectral_file') then                    
            field_OK = copy_f_to_c_string(val, val_len, control%spectral_file)
        else if (field == 'sat_desc') then                    
            field_OK = copy_f_to_c_string(val, val_len, control%sat_desc)
        else
            field_OK = .FALSE.
        end if

    end function StrCtrl_get_string

    function StrCtrl_set_string(control_Cptr, field_Cstr, val) result(field_OK) &
        bind(C, NAME='PS_StrCtrl_set_string')

        implicit none
        type(c_ptr), value, intent(in)          :: control_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        type(c_ptr), value, intent(in)          :: val
       

        ! local variables
        TYPE(StrCtrl), pointer             :: control
        character(len=:), allocatable           :: field            

        ! convert types
        call C_F_POINTER(control_Cptr, control)
        field = c_to_f_string(field_Cstr)
                
        field_OK = .TRUE.
    
        if (field == 'spectral_file') then                    
            field_OK = copy_c_to_f_string(control%spectral_file, val)
        else if (field == 'sat_desc') then                    
            field_OK = copy_c_to_f_string(control%sat_desc, val)
        else
            field_OK = .FALSE.
        end if

    end function StrCtrl_set_string

end module StrCtrl_C
