! Autogenerated from Fortran file src/radiance_core/def_spectrum.F90
! svn revision 1226

module StrSpecDataGas_C

use, intrinsic :: iso_c_binding

use UTILITIES_CF
use def_spectrum

implicit none

private

contains

    function StrSpecDataGas_get_integer(spectrum_Cptr, field_Cstr, val) result(field_OK) &
        bind(C, NAME='PS_StrSpecDataGas_get_integer')

        implicit none
        type(c_ptr), value, intent(in)          :: spectrum_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        integer(c_int), intent(out) :: val

        ! local variables
        TYPE(StrSpecData), pointer                  :: spectrum
        character(len=:), allocatable           :: field

        ! convert types
        call C_F_POINTER(spectrum_Cptr, spectrum)
        field = c_to_f_string(field_Cstr)

        field_OK = .TRUE.
    
        if (field == 'n_absorb') then
            val = spectrum%Gas%n_absorb
        else if (field == 'n_absorb_sb') then
            val = spectrum%Gas%n_absorb_sb
        else if (field == 'n_gas_frac') then
            val = spectrum%Gas%n_gas_frac
        else
            field_OK = .FALSE.
        end if

    end function StrSpecDataGas_get_integer

    function StrSpecDataGas_set_integer(spectrum_Cptr, field_Cstr, val) result(field_OK) &
        bind(C, NAME='PS_StrSpecDataGas_set_integer')

        implicit none
        type(c_ptr), value, intent(in)          :: spectrum_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        integer(c_int), value, intent(in) :: val

        ! local variables
        TYPE(StrSpecData), pointer                  :: spectrum
        character(len=:), allocatable           :: field

        ! convert types
        call C_F_POINTER(spectrum_Cptr, spectrum)
        field = c_to_f_string(field_Cstr)

        field_OK = .TRUE.
    
        if (field == 'n_absorb') then
            spectrum%Gas%n_absorb = val
        else if (field == 'n_absorb_sb') then
            spectrum%Gas%n_absorb_sb = val
        else if (field == 'n_gas_frac') then
            spectrum%Gas%n_gas_frac = val
        else
            field_OK = .FALSE.
        end if

    end function StrSpecDataGas_set_integer

    function StrSpecDataGas_get_logical_array(spectrum_Cptr, field_Cstr, loc, dims_C, ndim, lbounds_C) result(field_OK) &
        bind(C, NAME='PS_StrSpecDataGas_get_logical_array')

        implicit none
        type(c_ptr), value, intent(in)          :: spectrum_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        type(c_ptr), intent(out)                :: loc
        type(c_ptr), value, intent(in)          :: dims_C
        integer(c_int), intent(inout)           :: ndim
        type(c_ptr), value, intent(in)          :: lbounds_C

        ! local variables
        TYPE(StrSpecData), pointer             :: spectrum
        character(len=:), allocatable           :: field
        integer(c_int), pointer, dimension(:)   :: dims, lbounds    

        ! convert types
        call C_F_POINTER(spectrum_Cptr, spectrum)
        field = c_to_f_string(field_Cstr)
        call C_F_POINTER(dims_C, dims, [ndim])
        call C_F_POINTER(lbounds_C, lbounds, [ndim])

        field_OK = .TRUE.
    
        if (field == 'l_self_broadening') then
            if (allocated(spectrum%Gas%l_self_broadening)) then
                loc = C_LOC(spectrum%Gas%l_self_broadening)
                ndim = size(shape(spectrum%Gas%l_self_broadening))
                dims(1:ndim) = shape(spectrum%Gas%l_self_broadening)
                lbounds(1:ndim) = lbound(spectrum%Gas%l_self_broadening)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'l_doppler') then
            if (allocated(spectrum%Gas%l_doppler)) then
                loc = C_LOC(spectrum%Gas%l_doppler)
                ndim = size(shape(spectrum%Gas%l_doppler))
                dims(1:ndim) = shape(spectrum%Gas%l_doppler)
                lbounds(1:ndim) = lbound(spectrum%Gas%l_doppler)
            else
                loc = C_NULL_PTR
            end if

        else
            field_OK = .FALSE.
        end if

    end function StrSpecDataGas_get_logical_array

    function StrSpecDataGas_get_integer_array(spectrum_Cptr, field_Cstr, loc, dims_C, ndim, lbounds_C) result(field_OK) &
        bind(C, NAME='PS_StrSpecDataGas_get_integer_array')

        implicit none
        type(c_ptr), value, intent(in)          :: spectrum_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        type(c_ptr), intent(out)                :: loc
        type(c_ptr), value, intent(in)          :: dims_C
        integer(c_int), intent(inout)           :: ndim
        type(c_ptr), value, intent(in)          :: lbounds_C

        ! local variables
        TYPE(StrSpecData), pointer             :: spectrum
        character(len=:), allocatable           :: field
        integer(c_int), pointer, dimension(:)   :: dims, lbounds    

        ! convert types
        call C_F_POINTER(spectrum_Cptr, spectrum)
        field = c_to_f_string(field_Cstr)
        call C_F_POINTER(dims_C, dims, [ndim])
        call C_F_POINTER(lbounds_C, lbounds, [ndim])

        field_OK = .TRUE.
    
        if (field == 'n_band_absorb') then
            if (allocated(spectrum%Gas%n_band_absorb)) then
                loc = C_LOC(spectrum%Gas%n_band_absorb)
                ndim = size(shape(spectrum%Gas%n_band_absorb))
                dims(1:ndim) = shape(spectrum%Gas%n_band_absorb)
                lbounds(1:ndim) = lbound(spectrum%Gas%n_band_absorb)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'index_absorb') then
            if (allocated(spectrum%Gas%index_absorb)) then
                loc = C_LOC(spectrum%Gas%index_absorb)
                ndim = size(shape(spectrum%Gas%index_absorb))
                dims(1:ndim) = shape(spectrum%Gas%index_absorb)
                lbounds(1:ndim) = lbound(spectrum%Gas%index_absorb)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'index_sb') then
            if (allocated(spectrum%Gas%index_sb)) then
                loc = C_LOC(spectrum%Gas%index_sb)
                ndim = size(shape(spectrum%Gas%index_sb))
                dims(1:ndim) = shape(spectrum%Gas%index_sb)
                lbounds(1:ndim) = lbound(spectrum%Gas%index_sb)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'type_absorb') then
            if (allocated(spectrum%Gas%type_absorb)) then
                loc = C_LOC(spectrum%Gas%type_absorb)
                ndim = size(shape(spectrum%Gas%type_absorb))
                dims(1:ndim) = shape(spectrum%Gas%type_absorb)
                lbounds(1:ndim) = lbound(spectrum%Gas%type_absorb)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'n_mix_gas') then
            if (allocated(spectrum%Gas%n_mix_gas)) then
                loc = C_LOC(spectrum%Gas%n_mix_gas)
                ndim = size(shape(spectrum%Gas%n_mix_gas))
                dims(1:ndim) = shape(spectrum%Gas%n_mix_gas)
                lbounds(1:ndim) = lbound(spectrum%Gas%n_mix_gas)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'index_mix_gas') then
            if (allocated(spectrum%Gas%index_mix_gas)) then
                loc = C_LOC(spectrum%Gas%index_mix_gas)
                ndim = size(shape(spectrum%Gas%index_mix_gas))
                dims(1:ndim) = shape(spectrum%Gas%index_mix_gas)
                lbounds(1:ndim) = lbound(spectrum%Gas%index_mix_gas)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'num_mix') then
            if (allocated(spectrum%Gas%num_mix)) then
                loc = C_LOC(spectrum%Gas%num_mix)
                ndim = size(shape(spectrum%Gas%num_mix))
                dims(1:ndim) = shape(spectrum%Gas%num_mix)
                lbounds(1:ndim) = lbound(spectrum%Gas%num_mix)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'mix_gas_band') then
            if (allocated(spectrum%Gas%mix_gas_band)) then
                loc = C_LOC(spectrum%Gas%mix_gas_band)
                ndim = size(shape(spectrum%Gas%mix_gas_band))
                dims(1:ndim) = shape(spectrum%Gas%mix_gas_band)
                lbounds(1:ndim) = lbound(spectrum%Gas%mix_gas_band)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'num_ref_p') then
            if (allocated(spectrum%Gas%num_ref_p)) then
                loc = C_LOC(spectrum%Gas%num_ref_p)
                ndim = size(shape(spectrum%Gas%num_ref_p))
                dims(1:ndim) = shape(spectrum%Gas%num_ref_p)
                lbounds(1:ndim) = lbound(spectrum%Gas%num_ref_p)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'num_ref_t') then
            if (allocated(spectrum%Gas%num_ref_t)) then
                loc = C_LOC(spectrum%Gas%num_ref_t)
                ndim = size(shape(spectrum%Gas%num_ref_t))
                dims(1:ndim) = shape(spectrum%Gas%num_ref_t)
                lbounds(1:ndim) = lbound(spectrum%Gas%num_ref_t)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'i_band_k') then
            if (allocated(spectrum%Gas%i_band_k)) then
                loc = C_LOC(spectrum%Gas%i_band_k)
                ndim = size(shape(spectrum%Gas%i_band_k))
                dims(1:ndim) = shape(spectrum%Gas%i_band_k)
                lbounds(1:ndim) = lbound(spectrum%Gas%i_band_k)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'i_band_k_ses') then
            if (allocated(spectrum%Gas%i_band_k_ses)) then
                loc = C_LOC(spectrum%Gas%i_band_k_ses)
                ndim = size(shape(spectrum%Gas%i_band_k_ses))
                dims(1:ndim) = shape(spectrum%Gas%i_band_k_ses)
                lbounds(1:ndim) = lbound(spectrum%Gas%i_band_k_ses)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'i_scale_k') then
            if (allocated(spectrum%Gas%i_scale_k)) then
                loc = C_LOC(spectrum%Gas%i_scale_k)
                ndim = size(shape(spectrum%Gas%i_scale_k))
                dims(1:ndim) = shape(spectrum%Gas%i_scale_k)
                lbounds(1:ndim) = lbound(spectrum%Gas%i_scale_k)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'i_scale_fnc') then
            if (allocated(spectrum%Gas%i_scale_fnc)) then
                loc = C_LOC(spectrum%Gas%i_scale_fnc)
                ndim = size(shape(spectrum%Gas%i_scale_fnc))
                dims(1:ndim) = shape(spectrum%Gas%i_scale_fnc)
                lbounds(1:ndim) = lbound(spectrum%Gas%i_scale_fnc)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'i_scat') then
            if (allocated(spectrum%Gas%i_scat)) then
                loc = C_LOC(spectrum%Gas%i_scat)
                ndim = size(shape(spectrum%Gas%i_scat))
                dims(1:ndim) = shape(spectrum%Gas%i_scat)
                lbounds(1:ndim) = lbound(spectrum%Gas%i_scat)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'i_overlap') then
            if (allocated(spectrum%Gas%i_overlap)) then
                loc = C_LOC(spectrum%Gas%i_overlap)
                ndim = size(shape(spectrum%Gas%i_overlap))
                dims(1:ndim) = shape(spectrum%Gas%i_overlap)
                lbounds(1:ndim) = lbound(spectrum%Gas%i_overlap)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'n_sub_band_gas') then
            if (allocated(spectrum%Gas%n_sub_band_gas)) then
                loc = C_LOC(spectrum%Gas%n_sub_band_gas)
                ndim = size(shape(spectrum%Gas%n_sub_band_gas))
                dims(1:ndim) = shape(spectrum%Gas%n_sub_band_gas)
                lbounds(1:ndim) = lbound(spectrum%Gas%n_sub_band_gas)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'sub_band_k') then
            if (allocated(spectrum%Gas%sub_band_k)) then
                loc = C_LOC(spectrum%Gas%sub_band_k)
                ndim = size(shape(spectrum%Gas%sub_band_k))
                dims(1:ndim) = shape(spectrum%Gas%sub_band_k)
                lbounds(1:ndim) = lbound(spectrum%Gas%sub_band_k)
            else
                loc = C_NULL_PTR
            end if

        else
            field_OK = .FALSE.
        end if

    end function StrSpecDataGas_get_integer_array

    function StrSpecDataGas_get_real_array(spectrum_Cptr, field_Cstr, loc, dims_C, ndim, lbounds_C) result(field_OK) &
        bind(C, NAME='PS_StrSpecDataGas_get_real_array')

        implicit none
        type(c_ptr), value, intent(in)          :: spectrum_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        type(c_ptr), intent(out)                :: loc
        type(c_ptr), value, intent(in)          :: dims_C
        integer(c_int), intent(inout)           :: ndim
        type(c_ptr), value, intent(in)          :: lbounds_C

        ! local variables
        TYPE(StrSpecData), pointer             :: spectrum
        character(len=:), allocatable           :: field
        integer(c_int), pointer, dimension(:)   :: dims, lbounds    

        ! convert types
        call C_F_POINTER(spectrum_Cptr, spectrum)
        field = c_to_f_string(field_Cstr)
        call C_F_POINTER(dims_C, dims, [ndim])
        call C_F_POINTER(lbounds_C, lbounds, [ndim])

        field_OK = .TRUE.
    
        if (field == 'k') then
            if (allocated(spectrum%Gas%k)) then
                loc = C_LOC(spectrum%Gas%k)
                ndim = size(shape(spectrum%Gas%k))
                dims(1:ndim) = shape(spectrum%Gas%k)
                lbounds(1:ndim) = lbound(spectrum%Gas%k)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'w') then
            if (allocated(spectrum%Gas%w)) then
                loc = C_LOC(spectrum%Gas%w)
                ndim = size(shape(spectrum%Gas%w))
                dims(1:ndim) = shape(spectrum%Gas%w)
                lbounds(1:ndim) = lbound(spectrum%Gas%w)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'scale') then
            if (allocated(spectrum%Gas%scale)) then
                loc = C_LOC(spectrum%Gas%scale)
                ndim = size(shape(spectrum%Gas%scale))
                dims(1:ndim) = shape(spectrum%Gas%scale)
                lbounds(1:ndim) = lbound(spectrum%Gas%scale)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'p_ref') then
            if (allocated(spectrum%Gas%p_ref)) then
                loc = C_LOC(spectrum%Gas%p_ref)
                ndim = size(shape(spectrum%Gas%p_ref))
                dims(1:ndim) = shape(spectrum%Gas%p_ref)
                lbounds(1:ndim) = lbound(spectrum%Gas%p_ref)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 't_ref') then
            if (allocated(spectrum%Gas%t_ref)) then
                loc = C_LOC(spectrum%Gas%t_ref)
                ndim = size(shape(spectrum%Gas%t_ref))
                dims(1:ndim) = shape(spectrum%Gas%t_ref)
                lbounds(1:ndim) = lbound(spectrum%Gas%t_ref)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'p_lookup') then
            if (allocated(spectrum%Gas%p_lookup)) then
                loc = C_LOC(spectrum%Gas%p_lookup)
                ndim = size(shape(spectrum%Gas%p_lookup))
                dims(1:ndim) = shape(spectrum%Gas%p_lookup)
                lbounds(1:ndim) = lbound(spectrum%Gas%p_lookup)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 't_lookup') then
            if (allocated(spectrum%Gas%t_lookup)) then
                loc = C_LOC(spectrum%Gas%t_lookup)
                ndim = size(shape(spectrum%Gas%t_lookup))
                dims(1:ndim) = shape(spectrum%Gas%t_lookup)
                lbounds(1:ndim) = lbound(spectrum%Gas%t_lookup)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'gf_lookup') then
            if (allocated(spectrum%Gas%gf_lookup)) then
                loc = C_LOC(spectrum%Gas%gf_lookup)
                ndim = size(shape(spectrum%Gas%gf_lookup))
                dims(1:ndim) = shape(spectrum%Gas%gf_lookup)
                lbounds(1:ndim) = lbound(spectrum%Gas%gf_lookup)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'k_lookup') then
            if (allocated(spectrum%Gas%k_lookup)) then
                loc = C_LOC(spectrum%Gas%k_lookup)
                ndim = size(shape(spectrum%Gas%k_lookup))
                dims(1:ndim) = shape(spectrum%Gas%k_lookup)
                lbounds(1:ndim) = lbound(spectrum%Gas%k_lookup)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'k_lookup_sb') then
            if (allocated(spectrum%Gas%k_lookup_sb)) then
                loc = C_LOC(spectrum%Gas%k_lookup_sb)
                ndim = size(shape(spectrum%Gas%k_lookup_sb))
                dims(1:ndim) = shape(spectrum%Gas%k_lookup_sb)
                lbounds(1:ndim) = lbound(spectrum%Gas%k_lookup_sb)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'w_ses') then
            if (allocated(spectrum%Gas%w_ses)) then
                loc = C_LOC(spectrum%Gas%w_ses)
                ndim = size(shape(spectrum%Gas%w_ses))
                dims(1:ndim) = shape(spectrum%Gas%w_ses)
                lbounds(1:ndim) = lbound(spectrum%Gas%w_ses)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'k_mix_gas') then
            if (allocated(spectrum%Gas%k_mix_gas)) then
                loc = C_LOC(spectrum%Gas%k_mix_gas)
                ndim = size(shape(spectrum%Gas%k_mix_gas))
                dims(1:ndim) = shape(spectrum%Gas%k_mix_gas)
                lbounds(1:ndim) = lbound(spectrum%Gas%k_mix_gas)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'f_mix') then
            if (allocated(spectrum%Gas%f_mix)) then
                loc = C_LOC(spectrum%Gas%f_mix)
                ndim = size(shape(spectrum%Gas%f_mix))
                dims(1:ndim) = shape(spectrum%Gas%f_mix)
                lbounds(1:ndim) = lbound(spectrum%Gas%f_mix)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'doppler_cor') then
            if (allocated(spectrum%Gas%doppler_cor)) then
                loc = C_LOC(spectrum%Gas%doppler_cor)
                ndim = size(shape(spectrum%Gas%doppler_cor))
                dims(1:ndim) = shape(spectrum%Gas%doppler_cor)
                lbounds(1:ndim) = lbound(spectrum%Gas%doppler_cor)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'sub_band_w') then
            if (allocated(spectrum%Gas%sub_band_w)) then
                loc = C_LOC(spectrum%Gas%sub_band_w)
                ndim = size(shape(spectrum%Gas%sub_band_w))
                dims(1:ndim) = shape(spectrum%Gas%sub_band_w)
                lbounds(1:ndim) = lbound(spectrum%Gas%sub_band_w)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'wavelength_sub_band') then
            if (allocated(spectrum%Gas%wavelength_sub_band)) then
                loc = C_LOC(spectrum%Gas%wavelength_sub_band)
                ndim = size(shape(spectrum%Gas%wavelength_sub_band))
                dims(1:ndim) = shape(spectrum%Gas%wavelength_sub_band)
                lbounds(1:ndim) = lbound(spectrum%Gas%wavelength_sub_band)
            else
                loc = C_NULL_PTR
            end if

        else
            field_OK = .FALSE.
        end if

    end function StrSpecDataGas_get_real_array

end module StrSpecDataGas_C
