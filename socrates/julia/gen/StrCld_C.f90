! Autogenerated from Fortran file src/radiance_core/def_cld.F90
! svn revision 1226

module StrCld_C

use, intrinsic :: iso_c_binding

use UTILITIES_CF
use def_cld

implicit none

private

contains

    function create_StrCld() result(cld_Cptr) & 
        bind(C, NAME='PS_create_StrCld')

        implicit none
        type(c_ptr) :: cld_Cptr

        TYPE(StrCld), pointer :: cld

        ALLOCATE(cld)

        cld_Cptr = c_loc(cld)
    end function create_StrCld

    subroutine delete_StrCld(cld_Cptr) &
        bind(C, NAME='PS_delete_StrCld')

        implicit none
        type(c_ptr), value, intent(in) :: cld_Cptr

        TYPE(StrCld), pointer :: cld

        call C_F_POINTER(cld_Cptr, cld)

        DEALLOCATE(cld)

    end subroutine delete_StrCld

    function StrCld_get_integer(cld_Cptr, field_Cstr, val) result(field_OK) &
        bind(C, NAME='PS_StrCld_get_integer')

        implicit none
        type(c_ptr), value, intent(in)          :: cld_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        integer(c_int), intent(out) :: val

        ! local variables
        TYPE(StrCld), pointer                  :: cld
        character(len=:), allocatable           :: field

        ! convert types
        call C_F_POINTER(cld_Cptr, cld)
        field = c_to_f_string(field_Cstr)

        field_OK = .TRUE.
    
        if (field == 'n_cloud_type') then
            val = cld%n_cloud_type
        else if (field == 'n_condensed') then
            val = cld%n_condensed
        else if (field == 'n_opt_level_drop_prsc') then
            val = cld%n_opt_level_drop_prsc
        else if (field == 'n_phase_term_drop_prsc') then
            val = cld%n_phase_term_drop_prsc
        else if (field == 'n_opt_level_ice_prsc') then
            val = cld%n_opt_level_ice_prsc
        else if (field == 'n_phase_term_ice_prsc') then
            val = cld%n_phase_term_ice_prsc
        else
            field_OK = .FALSE.
        end if

    end function StrCld_get_integer

    function StrCld_set_integer(cld_Cptr, field_Cstr, val) result(field_OK) &
        bind(C, NAME='PS_StrCld_set_integer')

        implicit none
        type(c_ptr), value, intent(in)          :: cld_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        integer(c_int), value, intent(in) :: val

        ! local variables
        TYPE(StrCld), pointer                  :: cld
        character(len=:), allocatable           :: field

        ! convert types
        call C_F_POINTER(cld_Cptr, cld)
        field = c_to_f_string(field_Cstr)

        field_OK = .TRUE.
    
        if (field == 'n_cloud_type') then
            cld%n_cloud_type = val
        else if (field == 'n_condensed') then
            cld%n_condensed = val
        else if (field == 'n_opt_level_drop_prsc') then
            cld%n_opt_level_drop_prsc = val
        else if (field == 'n_phase_term_drop_prsc') then
            cld%n_phase_term_drop_prsc = val
        else if (field == 'n_opt_level_ice_prsc') then
            cld%n_opt_level_ice_prsc = val
        else if (field == 'n_phase_term_ice_prsc') then
            cld%n_phase_term_ice_prsc = val
        else
            field_OK = .FALSE.
        end if

    end function StrCld_set_integer

    function StrCld_get_real(cld_Cptr, field_Cstr, val) result(field_OK) &
        bind(C, NAME='PS_StrCld_get_real')

        implicit none
        type(c_ptr), value, intent(in)          :: cld_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        real(c_double), intent(out) :: val

        ! local variables
        TYPE(StrCld), pointer                  :: cld
        character(len=:), allocatable           :: field

        ! convert types
        call C_F_POINTER(cld_Cptr, cld)
        field = c_to_f_string(field_Cstr)

        field_OK = .TRUE.
    
        if (field == 'dp_corr_strat') then
            val = cld%dp_corr_strat
        else if (field == 'dp_corr_conv') then
            val = cld%dp_corr_conv
        else
            field_OK = .FALSE.
        end if

    end function StrCld_get_real

    function StrCld_set_real(cld_Cptr, field_Cstr, val) result(field_OK) &
        bind(C, NAME='PS_StrCld_set_real')

        implicit none
        type(c_ptr), value, intent(in)          :: cld_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        real(c_double), value, intent(in) :: val

        ! local variables
        TYPE(StrCld), pointer                  :: cld
        character(len=:), allocatable           :: field

        ! convert types
        call C_F_POINTER(cld_Cptr, cld)
        field = c_to_f_string(field_Cstr)

        field_OK = .TRUE.
    
        if (field == 'dp_corr_strat') then
            cld%dp_corr_strat = val
        else if (field == 'dp_corr_conv') then
            cld%dp_corr_conv = val
        else
            field_OK = .FALSE.
        end if

    end function StrCld_set_real

    function StrCld_get_integer_array(cld_Cptr, field_Cstr, loc, dims_C, ndim, lbounds_C) result(field_OK) &
        bind(C, NAME='PS_StrCld_get_integer_array')

        implicit none
        type(c_ptr), value, intent(in)          :: cld_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        type(c_ptr), intent(out)                :: loc
        type(c_ptr), value, intent(in)          :: dims_C
        integer(c_int), intent(inout)           :: ndim
        type(c_ptr), value, intent(in)          :: lbounds_C

        ! local variables
        TYPE(StrCld), pointer             :: cld
        character(len=:), allocatable           :: field
        integer(c_int), pointer, dimension(:)   :: dims, lbounds    

        ! convert types
        call C_F_POINTER(cld_Cptr, cld)
        field = c_to_f_string(field_Cstr)
        call C_F_POINTER(dims_C, dims, [ndim])
        call C_F_POINTER(lbounds_C, lbounds, [ndim])

        field_OK = .TRUE.
    
        if (field == 'type_condensed') then
            if (allocated(cld%type_condensed)) then
                loc = C_LOC(cld%type_condensed)
                ndim = size(shape(cld%type_condensed))
                dims(1:ndim) = shape(cld%type_condensed)
                lbounds(1:ndim) = lbound(cld%type_condensed)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'i_cloud_type') then
            if (allocated(cld%i_cloud_type)) then
                loc = C_LOC(cld%i_cloud_type)
                ndim = size(shape(cld%i_cloud_type))
                dims(1:ndim) = shape(cld%i_cloud_type)
                lbounds(1:ndim) = lbound(cld%i_cloud_type)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'i_condensed_param') then
            if (allocated(cld%i_condensed_param)) then
                loc = C_LOC(cld%i_condensed_param)
                ndim = size(shape(cld%i_condensed_param))
                dims(1:ndim) = shape(cld%i_condensed_param)
                lbounds(1:ndim) = lbound(cld%i_condensed_param)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'condensed_n_phf') then
            if (allocated(cld%condensed_n_phf)) then
                loc = C_LOC(cld%condensed_n_phf)
                ndim = size(shape(cld%condensed_n_phf))
                dims(1:ndim) = shape(cld%condensed_n_phf)
                lbounds(1:ndim) = lbound(cld%condensed_n_phf)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'n_subcol_cld') then
            if (allocated(cld%n_subcol_cld)) then
                loc = C_LOC(cld%n_subcol_cld)
                ndim = size(shape(cld%n_subcol_cld))
                dims(1:ndim) = shape(cld%n_subcol_cld)
                lbounds(1:ndim) = lbound(cld%n_subcol_cld)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'subcol_k') then
            if (allocated(cld%subcol_k)) then
                loc = C_LOC(cld%subcol_k)
                ndim = size(shape(cld%subcol_k))
                dims(1:ndim) = shape(cld%subcol_k)
                lbounds(1:ndim) = lbound(cld%subcol_k)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'first_subcol_k') then
            if (allocated(cld%first_subcol_k)) then
                loc = C_LOC(cld%first_subcol_k)
                ndim = size(shape(cld%first_subcol_k))
                dims(1:ndim) = shape(cld%first_subcol_k)
                lbounds(1:ndim) = lbound(cld%first_subcol_k)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'subcol_reorder') then
            if (allocated(cld%subcol_reorder)) then
                loc = C_LOC(cld%subcol_reorder)
                ndim = size(shape(cld%subcol_reorder))
                dims(1:ndim) = shape(cld%subcol_reorder)
                lbounds(1:ndim) = lbound(cld%subcol_reorder)
            else
                loc = C_NULL_PTR
            end if

        else
            field_OK = .FALSE.
        end if

    end function StrCld_get_integer_array

    function StrCld_get_real_array(cld_Cptr, field_Cstr, loc, dims_C, ndim, lbounds_C) result(field_OK) &
        bind(C, NAME='PS_StrCld_get_real_array')

        implicit none
        type(c_ptr), value, intent(in)          :: cld_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        type(c_ptr), intent(out)                :: loc
        type(c_ptr), value, intent(in)          :: dims_C
        integer(c_int), intent(inout)           :: ndim
        type(c_ptr), value, intent(in)          :: lbounds_C

        ! local variables
        TYPE(StrCld), pointer             :: cld
        character(len=:), allocatable           :: field
        integer(c_int), pointer, dimension(:)   :: dims, lbounds    

        ! convert types
        call C_F_POINTER(cld_Cptr, cld)
        field = c_to_f_string(field_Cstr)
        call C_F_POINTER(dims_C, dims, [ndim])
        call C_F_POINTER(lbounds_C, lbounds, [ndim])

        field_OK = .TRUE.
    
        if (field == 'w_cloud') then
            if (allocated(cld%w_cloud)) then
                loc = C_LOC(cld%w_cloud)
                ndim = size(shape(cld%w_cloud))
                dims(1:ndim) = shape(cld%w_cloud)
                lbounds(1:ndim) = lbound(cld%w_cloud)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'frac_cloud') then
            if (allocated(cld%frac_cloud)) then
                loc = C_LOC(cld%frac_cloud)
                ndim = size(shape(cld%frac_cloud))
                dims(1:ndim) = shape(cld%frac_cloud)
                lbounds(1:ndim) = lbound(cld%frac_cloud)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'condensed_mix_ratio') then
            if (allocated(cld%condensed_mix_ratio)) then
                loc = C_LOC(cld%condensed_mix_ratio)
                ndim = size(shape(cld%condensed_mix_ratio))
                dims(1:ndim) = shape(cld%condensed_mix_ratio)
                lbounds(1:ndim) = lbound(cld%condensed_mix_ratio)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'condensed_dim_char') then
            if (allocated(cld%condensed_dim_char)) then
                loc = C_LOC(cld%condensed_dim_char)
                ndim = size(shape(cld%condensed_dim_char))
                dims(1:ndim) = shape(cld%condensed_dim_char)
                lbounds(1:ndim) = lbound(cld%condensed_dim_char)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'condensed_param_list') then
            if (allocated(cld%condensed_param_list)) then
                loc = C_LOC(cld%condensed_param_list)
                ndim = size(shape(cld%condensed_param_list))
                dims(1:ndim) = shape(cld%condensed_param_list)
                lbounds(1:ndim) = lbound(cld%condensed_param_list)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'c_cloud') then
            if (allocated(cld%c_cloud)) then
                loc = C_LOC(cld%c_cloud)
                ndim = size(shape(cld%c_cloud))
                dims(1:ndim) = shape(cld%c_cloud)
                lbounds(1:ndim) = lbound(cld%c_cloud)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'c_ratio') then
            if (allocated(cld%c_ratio)) then
                loc = C_LOC(cld%c_ratio)
                ndim = size(shape(cld%c_ratio))
                dims(1:ndim) = shape(cld%c_ratio)
                lbounds(1:ndim) = lbound(cld%c_ratio)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'condensed_rel_var_dens') then
            if (allocated(cld%condensed_rel_var_dens)) then
                loc = C_LOC(cld%condensed_rel_var_dens)
                ndim = size(shape(cld%condensed_rel_var_dens))
                dims(1:ndim) = shape(cld%condensed_rel_var_dens)
                lbounds(1:ndim) = lbound(cld%condensed_rel_var_dens)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'drop_pressure_prsc') then
            if (allocated(cld%drop_pressure_prsc)) then
                loc = C_LOC(cld%drop_pressure_prsc)
                ndim = size(shape(cld%drop_pressure_prsc))
                dims(1:ndim) = shape(cld%drop_pressure_prsc)
                lbounds(1:ndim) = lbound(cld%drop_pressure_prsc)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'drop_absorption_prsc') then
            if (allocated(cld%drop_absorption_prsc)) then
                loc = C_LOC(cld%drop_absorption_prsc)
                ndim = size(shape(cld%drop_absorption_prsc))
                dims(1:ndim) = shape(cld%drop_absorption_prsc)
                lbounds(1:ndim) = lbound(cld%drop_absorption_prsc)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'drop_scattering_prsc') then
            if (allocated(cld%drop_scattering_prsc)) then
                loc = C_LOC(cld%drop_scattering_prsc)
                ndim = size(shape(cld%drop_scattering_prsc))
                dims(1:ndim) = shape(cld%drop_scattering_prsc)
                lbounds(1:ndim) = lbound(cld%drop_scattering_prsc)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'drop_phase_fnc_prsc') then
            if (allocated(cld%drop_phase_fnc_prsc)) then
                loc = C_LOC(cld%drop_phase_fnc_prsc)
                ndim = size(shape(cld%drop_phase_fnc_prsc))
                dims(1:ndim) = shape(cld%drop_phase_fnc_prsc)
                lbounds(1:ndim) = lbound(cld%drop_phase_fnc_prsc)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'ice_pressure_prsc') then
            if (allocated(cld%ice_pressure_prsc)) then
                loc = C_LOC(cld%ice_pressure_prsc)
                ndim = size(shape(cld%ice_pressure_prsc))
                dims(1:ndim) = shape(cld%ice_pressure_prsc)
                lbounds(1:ndim) = lbound(cld%ice_pressure_prsc)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'ice_absorption_prsc') then
            if (allocated(cld%ice_absorption_prsc)) then
                loc = C_LOC(cld%ice_absorption_prsc)
                ndim = size(shape(cld%ice_absorption_prsc))
                dims(1:ndim) = shape(cld%ice_absorption_prsc)
                lbounds(1:ndim) = lbound(cld%ice_absorption_prsc)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'ice_scattering_prsc') then
            if (allocated(cld%ice_scattering_prsc)) then
                loc = C_LOC(cld%ice_scattering_prsc)
                ndim = size(shape(cld%ice_scattering_prsc))
                dims(1:ndim) = shape(cld%ice_scattering_prsc)
                lbounds(1:ndim) = lbound(cld%ice_scattering_prsc)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'ice_phase_fnc_prsc') then
            if (allocated(cld%ice_phase_fnc_prsc)) then
                loc = C_LOC(cld%ice_phase_fnc_prsc)
                ndim = size(shape(cld%ice_phase_fnc_prsc))
                dims(1:ndim) = shape(cld%ice_phase_fnc_prsc)
                lbounds(1:ndim) = lbound(cld%ice_phase_fnc_prsc)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'c_sub') then
            if (allocated(cld%c_sub)) then
                loc = C_LOC(cld%c_sub)
                ndim = size(shape(cld%c_sub))
                dims(1:ndim) = shape(cld%c_sub)
                lbounds(1:ndim) = lbound(cld%c_sub)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'frac_cloudy') then
            if (allocated(cld%frac_cloudy)) then
                loc = C_LOC(cld%frac_cloudy)
                ndim = size(shape(cld%frac_cloudy))
                dims(1:ndim) = shape(cld%frac_cloudy)
                lbounds(1:ndim) = lbound(cld%frac_cloudy)
            else
                loc = C_NULL_PTR
            end if

        else
            field_OK = .FALSE.
        end if

    end function StrCld_get_real_array

end module StrCld_C
