! Autogenerated from Fortran file src/radiance_core/def_spectrum.F90
! svn revision 1226

module StrSpecDataMap_C

use, intrinsic :: iso_c_binding

use UTILITIES_CF
use def_spectrum

implicit none

private

contains

    function StrSpecDataMap_get_integer_array(spectrum_Cptr, field_Cstr, loc, dims_C, ndim, lbounds_C) result(field_OK) &
        bind(C, NAME='PS_StrSpecDataMap_get_integer_array')

        implicit none
        type(c_ptr), value, intent(in)          :: spectrum_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        type(c_ptr), intent(out)                :: loc
        type(c_ptr), value, intent(in)          :: dims_C
        integer(c_int), intent(inout)           :: ndim
        type(c_ptr), value, intent(in)          :: lbounds_C

        ! local variables
        TYPE(StrSpecData), pointer             :: spectrum
        character(len=:), allocatable           :: field
        integer(c_int), pointer, dimension(:)   :: dims, lbounds    

        ! convert types
        call C_F_POINTER(spectrum_Cptr, spectrum)
        field = c_to_f_string(field_Cstr)
        call C_F_POINTER(dims_C, dims, [ndim])
        call C_F_POINTER(lbounds_C, lbounds, [ndim])

        field_OK = .TRUE.
    
        if (field == 'n_sub_band_k') then
            if (allocated(spectrum%Map%n_sub_band_k)) then
                loc = C_LOC(spectrum%Map%n_sub_band_k)
                ndim = size(shape(spectrum%Map%n_sub_band_k))
                dims(1:ndim) = shape(spectrum%Map%n_sub_band_k)
                lbounds(1:ndim) = lbound(spectrum%Map%n_sub_band_k)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'list_sub_band_k') then
            if (allocated(spectrum%Map%list_sub_band_k)) then
                loc = C_LOC(spectrum%Map%list_sub_band_k)
                ndim = size(shape(spectrum%Map%list_sub_band_k))
                dims(1:ndim) = shape(spectrum%Map%list_sub_band_k)
                lbounds(1:ndim) = lbound(spectrum%Map%list_sub_band_k)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'n_k_sub_band') then
            if (allocated(spectrum%Map%n_k_sub_band)) then
                loc = C_LOC(spectrum%Map%n_k_sub_band)
                ndim = size(shape(spectrum%Map%n_k_sub_band))
                dims(1:ndim) = shape(spectrum%Map%n_k_sub_band)
                lbounds(1:ndim) = lbound(spectrum%Map%n_k_sub_band)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'list_k_sub_band') then
            if (allocated(spectrum%Map%list_k_sub_band)) then
                loc = C_LOC(spectrum%Map%list_k_sub_band)
                ndim = size(shape(spectrum%Map%list_k_sub_band))
                dims(1:ndim) = shape(spectrum%Map%list_k_sub_band)
                lbounds(1:ndim) = lbound(spectrum%Map%list_k_sub_band)
            else
                loc = C_NULL_PTR
            end if

        else
            field_OK = .FALSE.
        end if

    end function StrSpecDataMap_get_integer_array

    function StrSpecDataMap_get_real_array(spectrum_Cptr, field_Cstr, loc, dims_C, ndim, lbounds_C) result(field_OK) &
        bind(C, NAME='PS_StrSpecDataMap_get_real_array')

        implicit none
        type(c_ptr), value, intent(in)          :: spectrum_Cptr
        type(c_ptr), value, intent(in)          :: field_Cstr
        logical(c_bool)                         :: field_OK
        type(c_ptr), intent(out)                :: loc
        type(c_ptr), value, intent(in)          :: dims_C
        integer(c_int), intent(inout)           :: ndim
        type(c_ptr), value, intent(in)          :: lbounds_C

        ! local variables
        TYPE(StrSpecData), pointer             :: spectrum
        character(len=:), allocatable           :: field
        integer(c_int), pointer, dimension(:)   :: dims, lbounds    

        ! convert types
        call C_F_POINTER(spectrum_Cptr, spectrum)
        field = c_to_f_string(field_Cstr)
        call C_F_POINTER(dims_C, dims, [ndim])
        call C_F_POINTER(lbounds_C, lbounds, [ndim])

        field_OK = .TRUE.
    
        if (field == 'weight_sub_band_k') then
            if (allocated(spectrum%Map%weight_sub_band_k)) then
                loc = C_LOC(spectrum%Map%weight_sub_band_k)
                ndim = size(shape(spectrum%Map%weight_sub_band_k))
                dims(1:ndim) = shape(spectrum%Map%weight_sub_band_k)
                lbounds(1:ndim) = lbound(spectrum%Map%weight_sub_band_k)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'weight_k_sub_band') then
            if (allocated(spectrum%Map%weight_k_sub_band)) then
                loc = C_LOC(spectrum%Map%weight_k_sub_band)
                ndim = size(shape(spectrum%Map%weight_k_sub_band))
                dims(1:ndim) = shape(spectrum%Map%weight_k_sub_band)
                lbounds(1:ndim) = lbound(spectrum%Map%weight_k_sub_band)
            else
                loc = C_NULL_PTR
            end if

        else if (field == 'weight_k_major') then
            if (allocated(spectrum%Map%weight_k_major)) then
                loc = C_LOC(spectrum%Map%weight_k_major)
                ndim = size(shape(spectrum%Map%weight_k_major))
                dims(1:ndim) = shape(spectrum%Map%weight_k_major)
                lbounds(1:ndim) = lbound(spectrum%Map%weight_k_major)
            else
                loc = C_NULL_PTR
            end if

        else
            field_OK = .FALSE.
        end if

    end function StrSpecDataMap_get_real_array

end module StrSpecDataMap_C
